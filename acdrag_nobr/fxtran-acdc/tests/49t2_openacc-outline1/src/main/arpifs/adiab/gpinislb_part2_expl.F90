SUBROUTINE GPINISLB_PART2_EXPL (YDDYN, YDDYNA, YDCPG_BNDS, YDCPG_OPTS, YDVARS)

!$ACDC outline1    


USE PARKIND1, ONLY : JPIM, JPRB
USE YOMHOOK,  ONLY : LHOOK, JPHOOK, DR_HOOK

USE YOMDYN , ONLY : TDYN
USE YOMDYNA, ONLY : TDYNA
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE

TYPE(TDYN)             ,INTENT(IN)    :: YDDYN
TYPE(TDYNA)            ,INTENT(IN)    :: YDDYNA
TYPE(CPG_BNDS_TYPE)    ,INTENT(IN)    :: YDCPG_BNDS
TYPE(CPG_OPTS_TYPE)    ,INTENT(IN)    :: YDCPG_OPTS
TYPE(FIELD_VARIABLES)  ,INTENT(INOUT) :: YDVARS

INTEGER (KIND=JPIM) :: JGFL, JROF, JLEV

REAL(KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK('GPINISLB_PART2_EXPL',0,ZHOOK_HANDLE)

IF (YDDYNA%LSLAG) THEN
  IF (YDDYNA%LTWOTL) THEN
    DO JGFL = 1, SIZE (YDVARS%GFL_PTR)
      IF(YDVARS%GFL_PTR (JGFL)%LADV) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        YDVARS%GFL_PTR (JGFL)%T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, :) = 0._JPRB

!$ACDC }

      ELSEIF(YDVARS%GFL_PTR (JGFL)%LT1) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        DO JLEV = 1, YDCPG_OPTS%KFLEVG
          DO JROF = YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            YDVARS%GFL_PTR (JGFL)%T1 (JROF, JLEV) = YDVARS%GFL_PTR (JGFL)%T0 (JROF, JLEV) * YDCPG_OPTS%ZTE
          ENDDO
        ENDDO

!$ACDC }

      ENDIF
    ENDDO
  ELSE
    DO JGFL = 1, SIZE (YDVARS%GFL_PTR)
      IF(YDVARS%GFL_PTR (JGFL)%LADV) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        YDVARS%GFL_PTR (JGFL)%T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, :) = 0._JPRB

!$ACDC }

      ELSEIF(YDVARS%GFL_PTR (JGFL)%LT1) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        DO JLEV = 1, YDCPG_OPTS%KFLEVG
          DO JROF = YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            YDVARS%GFL_PTR (JGFL)%T1 (JROF, JLEV) = YDVARS%GFL_PTR (JGFL)%T9 (JROF, JLEV) * YDCPG_OPTS%ZTE
          ENDDO
        ENDDO

!$ACDC }

      ENDIF
    ENDDO
  ENDIF
ELSE 
  IF (YDDYN%NCURRENT_ITER == 0) THEN
    DO JGFL = 1, SIZE (YDVARS%GFL_PTR)
      IF(YDVARS%GFL_PTR (JGFL)%LT1) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        DO JLEV = 1, YDCPG_OPTS%KFLEVG
          DO JROF = YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            YDVARS%GFL_PTR (JGFL)%T1 (JROF, JLEV) = YDVARS%GFL_PTR (JGFL)%T9 (JROF, JLEV) * YDCPG_OPTS%ZTE
          ENDDO
        ENDDO

!$ACDC }

      ENDIF
    ENDDO
  ELSE
    DO JGFL = 1, SIZE (YDVARS%GFL_PTR)
      IF(YDVARS%GFL_PTR (JGFL)%LT1) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

        YDVARS%GFL_PTR (JGFL)%T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, :) = 0._JPRB

!$ACDC }

      ENDIF
    ENDDO
  ENDIF
ENDIF

IF (LHOOK) CALL DR_HOOK('GPINISLB_PART2_EXPL',1,ZHOOK_HANDLE)

END SUBROUTINE GPINISLB_PART2_EXPL
