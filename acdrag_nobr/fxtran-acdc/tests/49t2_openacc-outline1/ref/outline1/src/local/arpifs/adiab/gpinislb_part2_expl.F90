SUBROUTINE GPINISLB_PART2_EXPL (YDDYN, YDDYNA, YDCPG_BNDS, YDCPG_OPTS, YDVARS)
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE


TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS


INTEGER (KIND=JPIM)::JGFL
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "gpinislb_part2_expl_outline_000.intfb.h"
#include "gpinislb_part2_expl_outline_005.intfb.h"
#include "gpinislb_part2_expl_outline_004.intfb.h"
#include "gpinislb_part2_expl_outline_003.intfb.h"
#include "gpinislb_part2_expl_outline_002.intfb.h"
#include "gpinislb_part2_expl_outline_001.intfb.h"
IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL', 0, ZHOOK_HANDLE)

IF (YDDYNA%LSLAG) THEN

  IF (YDDYNA%LTWOTL) THEN

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LADV) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_000 (JGFL, YDCPG_BNDS, YDVARS)
      ELSEIF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_001 (JGFL, YDCPG_BNDS, YDCPG_OPTS, YDVARS)
      ENDIF

    ENDDO

  ELSE

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LADV) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_002 (JGFL, YDCPG_BNDS, YDVARS)
      ELSEIF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_003 (JGFL, YDCPG_BNDS, YDCPG_OPTS, YDVARS)
      ENDIF

    ENDDO

  ENDIF

ELSE

  IF (YDDYN%NCURRENT_ITER==0) THEN

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_004 (JGFL, YDCPG_BNDS, YDCPG_OPTS, YDVARS)
      ENDIF

    ENDDO

  ELSE

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        CALL GPINISLB_PART2_EXPL_OUTLINE_005 (JGFL, YDCPG_BNDS, YDVARS)
      ENDIF

    ENDDO

  ENDIF

ENDIF

IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL', 1, ZHOOK_HANDLE)
ENDSUBROUTINE GPINISLB_PART2_EXPL
