SUBROUTINE CPG_GP_HYD_OUTLINE_001 (YDCPG_BNDS, YDCPG_DYN0, YDGEOMETRY&
&, YDMODEL, YDVARS, P_RDT_T0, P_RPREF_T0, P_RT_T0)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_TND_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN0
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
REAL (KIND=JPRB), INTENT (INOUT)::P_RDT_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_RPREF_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_RT_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
#include "gpcty_expl.intfb.h"
#include "gprt.intfb.h"
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::Z_DPHYCTY_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_OUTLINE_001', 0, ZHOOK_HANDLE)

IF (YDMODEL%YRML_GCONF%YGFL%YRSPEC%LGP) THEN
  CALL GPRT (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA,&
  & YDCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, YDCPG_DYN0&
  &%RCP%R, YDVARS%T%T0, YDVARS%T%DL, YDVARS%T%DM, YDVARS%Q%DL, YDVARS%Q%DM, P_RT_T0, YDCPG_DYN0&
  &%RTL, YDCPG_DYN0%RTM, PRL=YDVARS%RSPEC%DL, PRM=YDVARS%RSPEC%DM)
ELSEIF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
  CALL GPRT (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA&
  &, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, YDCPG_DYN0%RCP%R, YDVARS%T%T0, YDVARS&
  &%T%DL, YDVARS%T%DM, YDVARS%Q%DL, YDVARS%Q%DM, P_RT_T0, YDCPG_DYN0%RTL, YDCPG_DYN0%RTM)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      P_RDT_T0 (JROF, JLEV)=YDMODEL%YRCST%RD*YDVARS%T%T0 (JROF, JLEV)
    ENDDO

  ENDDO

ELSE
  P_RDT_T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=P_RT_T0&
  & (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)
ENDIF


IF (YDMODEL%YRML_GCONF%YGFL%YPHYCTY%LACTIVE) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      Z_DPHYCTY_T0 (JROF, JLEV)=YDVARS%PHYCTY%T0 (JROF, JLEV)
    ENDDO

  ENDDO

ELSE
  Z_DPHYCTY_T0 (:,:)=0.0_JPRB
ENDIF

CALL GPCTY_EXPL (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM&
&%NPROMA, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YRDYNA&
&%LRUBC, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDGEOMETRY%YRVERT_GEOM%YRVETA, YDVARS%U%T0, YDVARS%V%T0&
&, YDVARS%DIV%T0, YDVARS%EDOT%T0, PSPL=YDCPG_DYN0%PREL, PSPM=YDCPG_DYN0%PREM, PRPREF=P_RPREF_T0&
&, PDPHYCTY=Z_DPHYCTY_T0, PDELP=YDCPG_DYN0%XYB%DELP, PLNPR=YDCPG_DYN0%XYB%LNPR, PRDELP=YDCPG_DYN0&
&%XYB%RDELP, PALPH=YDCPG_DYN0%XYB%ALPH, PRTGR=YDCPG_DYN0%XYB%RTGR, PRPRE=YDCPG_DYN0%XYB%RPRE,&
& PRPP=YDCPG_DYN0%XYB%RPP, PEVEL=YDCPG_DYN0%CTY%EVEL, PVVEL=YDCPG_DYN0%CTY%VVEL, PPSDIV=YDCPG_DYN0&
&%CTY%PSDIV, PPSDVBC=YDCPG_DYN0%CTY%PSDVBC, PDIVDP=YDCPG_DYN0%CTY%DIVDP)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_OUTLINE_001', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
