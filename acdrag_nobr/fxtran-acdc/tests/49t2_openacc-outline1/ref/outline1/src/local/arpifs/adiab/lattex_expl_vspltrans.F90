SUBROUTINE LATTEX_EXPL_VSPLTRANS (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDML_DYN, YDCPG_SL1)
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:DR_HOOK, LHOOK, JPHOOK
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1B_TYPE

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (CPG_SL1B_TYPE), INTENT (INOUT)::YDCPG_SL1

#include "lattex_expl_vspltrans_outline_000.intfb.h"
#include "lattex_expl_vspltrans_outline_001.intfb.h"
LOGICAL::LLTDIABLIN


INTEGER (KIND=JPIM)::JGFL
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('LATTEX_EXPL_VSPLTRANS', 0, ZHOOK_HANDLE)

DO JGFL=1, SIZE (YDCPG_SL1%GFL)

  IF (YDCPG_SL1%GFL (JGFL)%YCOMP%LADV.AND.YDCPG_SL1%GFL (JGFL)%YCOMP%CSLINT=='LAITVSPCQM  ') THEN
    LLTDIABLIN=YDCPG_SL1%GFL (JGFL)%YCOMP%LTDIABLIN

    IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).OR.LLTDIABLIN) THEN
      CALL LATTEX_EXPL_VSPLTRANS_OUTLINE_000 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDML_DYN)
    ENDIF

    CALL LATTEX_EXPL_VSPLTRANS_OUTLINE_001 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDML_DYN)
  ENDIF

ENDDO

IF (LHOOK) CALL DR_HOOK ('LATTEX_EXPL_VSPLTRANS', 1, ZHOOK_HANDLE)
ENDSUBROUTINE LATTEX_EXPL_VSPLTRANS
