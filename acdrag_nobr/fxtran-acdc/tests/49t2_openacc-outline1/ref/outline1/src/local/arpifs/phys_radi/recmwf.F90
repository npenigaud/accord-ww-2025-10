
SUBROUTINE RECMWF (YDDIMV, YDMODEL, YDCPG_OPTS, YDCPG_BNDS, KOZOCL, KMACCAERO, KAERO, PALBD&
&, PALBP, PAPRS, PAPRSF, PNEB, PQO3, PQCO2, PQCH4, PQN2O, PQNO2, PQC11, PQC12, PQC22, PQCL4&
&, PAER, PAERO, PAEROCPL, PDELP, PEMIS, PMU0M, PQ, PQSAT, PQICE, PQLIQ, PS, PRR, PLSM, PT, PTS&
&, PEMTD, PEMTU, PTRSO, PLWFC, PLWFT, PSWFC, PSWFT, PSFSWDIR, PSFSWDIF, PFSDNN, PFSDNV, PCTRSO&
&, PCEMTR, PTRSOD, PTRSODIR, PTRSODIF, PPIZA_DST, PCGA_DST, PTAUREL_DST, PAERINDS, PGELAM, PGEMU&
&, PSWDIR, PSWDIF, PMU0LU, PALB, PVRMOON, PCLDROP, YSPP_RSWINHF, YSPP_RLWINHF)
USE TYPE_MODEL,ONLY:MODEL
USE YOMDIMV,ONLY:TDIMV
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE SPP_MOD_TYPE,ONLY:APPLY_SPP, TSPP_CONFIG_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE


TYPE (TDIMV), INTENT (IN)::YDDIMV
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KOZOCL
INTEGER (KIND=JPIM), INTENT (IN)::KMACCAERO
INTEGER (KIND=JPIM), INTENT (IN)::KAERO
REAL (KIND=JPRB), INTENT (IN)::PGELAM (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PGEMU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PALBD (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PALBP (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PAPRS (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PAPRSF (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PNEB (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQO3 (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCH4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQN2O (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQNO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC11 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC12 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC22 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCL4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PAER (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6)
REAL (KIND=JPRB), INTENT (IN)::PAERO (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, KAERO)
REAL (KIND=JPRB), INTENT (IN)::PAEROCPL (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD&
&%YRERAD%NTLW, MERGE (6, 0, YDMODEL%YRML_PHY_RAD%YREAERATM%LAERRADCPL))
REAL (KIND=JPRB), INTENT (IN)::PAERINDS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PDELP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PEMIS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PMU0M (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQSAT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQICE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQLIQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PLSM (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PPIZA_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PCGA_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PTAUREL_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PEMTD (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PEMTU (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PTRSO (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCTRSO (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PCEMTR (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PTRSOD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PLWFC (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PLWFT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
REAL (KIND=JPRB), INTENT (OUT)::PSWFC (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PSWFT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
REAL (KIND=JPRB), INTENT (OUT)::PSFSWDIR (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PSFSWDIF (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PFSDNN (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PFSDNV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PTRSODIR (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PTRSODIF (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PRR (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSWDIR (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (INOUT)::PSWDIF (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (IN)::PMU0LU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PALB (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PVRMOON (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PCLDROP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RLWINHF
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RSWINHF
REAL (KIND=JPRB)::ZTH (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRAER (YDCPG_OPTS%KLON, 6, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCLC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRMU0 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZQIWP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQLWP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZPQO3 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZCLDROP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZNTOP (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZNBAS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCCNO (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCCNL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFRSODC (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFRTEDC (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRNO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRN2O (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCH4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCL4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC22 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC12 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC11 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZPAERO (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, KAERO)
REAL (KIND=JPRB)::ZPCDIR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFDIF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFDIR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_PAR_CLEAR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_PAR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_UV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFRTED (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZLWDERIVATIVE (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZSWDIFFUSEBAND (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB)::ZSWDIRECTBAND (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB)::ZEMIT (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFCT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZFCS (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZSUDU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFRSOD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZTINCF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPARCF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZUVDF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPARF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRLWINHF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRSWINHF (YDCPG_OPTS%KLON)






REAL (KIND=JPRB)::ZEMIW (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCRAE
REAL (KIND=JPRB)::ZSPECTRALEMISS (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE

#include "recmwf_srtm.intfb.h"
#include "recmwf_finish.intfb.h"
#include "recmwf_ecrad_post.intfb.h"
#include "recmwf_ecrad_gpu.intfb.h"
#include "recmwf_ecrad_cpu.intfb.h"
#include "recmwf_rrtm.intfb.h"
#include "recmwf_outline_002.intfb.h"
#include "recmwf_outline_001.intfb.h"
#include "recmwf_prepare.intfb.h"




IF (LHOOK) CALL DR_HOOK ('RECMWF', 0, ZHOOK_HANDLE)



ZCRAE=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE*(YDMODEL%YRML_PHY_RAD%YRERDI%RRAE+2.0_JPRB)

IF (PRESENT (PCLDROP)) THEN
  
  ZCLDROP (:,:)=PCLDROP (:,:)
  
ENDIF

CALL RECMWF_PREPARE (KAERO, KOZOCL, YDCPG_BNDS, YDCPG_OPTS, YDMODEL, ZCRAE, PAER, PAERO, PAPRS, PAPRSF&
&, PDELP, PEMIS, PMU0M, PNEB, PQ, PQC11, PQC12, PQC22, PQCH4, PQCL4, PQCO2, PQICE, PQLIQ, PQN2O, PQNO2&
&, PQO3, PQSAT, PT, PTS, ZCCNL, ZCCNO, ZEMIW, ZNBAS, ZNTOP, ZPAERO, ZPQO3, ZQ, ZQIWP, ZQLWP, ZQS, ZRAER&
&, ZRC11, ZRC12, ZRC22, ZRCH4, ZRCL4, ZRCLC, ZRCO2, ZRMU0, ZRN2O, ZRNO2, ZSPECTRALEMISS, ZTH)

IF (PRESENT (YSPP_RSWINHF)) THEN
  

  IF (YSPP_RSWINHF%LPERT) THEN
    CALL APPLY_SPP (YSPP_RSWINHF, YDCPG_OPTS%KLON, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
    &%KFDIA, YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF, ZRSWINHF)
  ELSE
    ZRSWINHF (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF
  ENDIF

  
ELSE
  CALL RECMWF_OUTLINE_001 (YDCPG_BNDS, YDCPG_OPTS, YDMODEL, ZRSWINHF)
ENDIF


IF (PRESENT (YSPP_RLWINHF)) THEN
  

  IF (YSPP_RLWINHF%LPERT) THEN
    CALL APPLY_SPP (YSPP_RLWINHF, YDCPG_OPTS%KLON, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
    &%KFDIA, YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF, ZRLWINHF)
  ELSE
    ZRLWINHF (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF
  ENDIF

  
ELSE
  CALL RECMWF_OUTLINE_002 (YDCPG_BNDS, YDCPG_OPTS, YDMODEL, ZRLWINHF)
ENDIF


IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  CALL RECMWF_SRTM (KAERO, YDCPG_BNDS, YDCPG_OPTS, YDDIMV, YDMODEL, PALBD, PALBP, PAPRS, PAPRSF&
  &, PDELP, PEMIS, PGELAM, PGEMU, PLSM, PLWFT, PNEB, PRR, PS, PSWFT, PT, PTS, ZCCNL, ZCCNO, ZEMIT&
  &, ZEMIW, ZFCS, ZFCT, ZFRSOD, ZFRTED, ZLWDERIVATIVE, ZPAERO, ZPARCF, ZPARF, ZPCDIR, ZPFDIF, ZPFDIR&
  &, ZPFRSODC, ZPFRTEDC, ZPQO3, ZQ, ZQIWP, ZQLWP, ZRAER, ZRC11, ZRC12, ZRC22, ZRCH4, ZRCL4, ZRCO2&
  &, ZRMU0, ZRN2O, ZRNO2, ZSUDU, ZSWDIFFUSEBAND, ZSWDIRECTBAND, ZTH, ZTINCF, ZUVDF)
ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LRRTM.AND..NOT.YDMODEL%YRML_PHY_RAD&
  &%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  CALL RECMWF_RRTM (YDCPG_BNDS, YDCPG_OPTS, YDDIMV, YDMODEL, PAERINDS, PALBD, PALBP, PAPRS, PAPRSF, PCGA_DST&
  &, PDELP, PEMIS, PFSDNN, PFSDNV, PLSM, PLWFT, PPIZA_DST, PSFSWDIF, PSFSWDIR, PSWFT, PT, PTAUREL_DST,&
  & PTS, ZCCNL, ZCCNO, ZCLDROP, ZEMIT, ZEMIW, ZFCS, ZFCT, ZFRSOD, ZNBAS, ZNTOP, ZPARCF, ZPARF, ZPQO3, ZQ&
  &, ZQIWP, ZQLWP, ZQS, ZRAER, ZRCLC, ZRLWINHF, ZRMU0, ZRSWINHF, ZSUDU, ZTH, ZTINCF, ZUVDF)
ELSEIF (.NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='CPU') THEN
    CALL RECMWF_ECRAD_CPU (KAERO, YDCPG_BNDS, YDCPG_OPTS, YDMODEL, PAEROCPL, PALBD, PALBP, PAPRS, PAPRSF&
    &, PGELAM, PGEMU, PLSM, PLWFT, PRR, PS, PSWFT, PT, PTS, ZCCNL, ZCCNO, ZEMIT, ZFCS, ZFCT, ZFLUX_PAR&
    &, ZFLUX_PAR_CLEAR, ZFLUX_UV, ZFRSOD, ZFRTED, ZLWDERIVATIVE, ZPAERO, ZPCDIR, ZPFDIR, ZPFRSODC, ZPFRTEDC&
    &, ZPQO3, ZQ, ZQIWP, ZQLWP, ZRAER, ZRC11, ZRC12, ZRC22, ZRCH4, ZRCL4, ZRCLC, ZRCO2, ZRMU0, ZRN2O&
    &, ZRNO2, ZSPECTRALEMISS, ZSUDU, ZSWDIFFUSEBAND, ZSWDIRECTBAND, ZTH, ZTINCF)
  ENDIF


  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='GPU') THEN
    CALL RECMWF_ECRAD_GPU (KAERO, YDCPG_BNDS, YDCPG_OPTS, YDMODEL, PAEROCPL, PALBD, PALBP, PAPRS, PAPRSF&
    &, PGELAM, PGEMU, PLSM, PLWFT, PRR, PS, PSWFT, PT, PTS, ZCCNL, ZCCNO, ZEMIT, ZFCS, ZFCT, ZFLUX_PAR&
    &, ZFLUX_PAR_CLEAR, ZFLUX_UV, ZFRSOD, ZFRTED, ZLWDERIVATIVE, ZPAERO, ZPCDIR, ZPFDIR, ZPFRSODC, ZPFRTEDC&
    &, ZPQO3, ZQ, ZQIWP, ZQLWP, ZRAER, ZRC11, ZRC12, ZRC22, ZRCH4, ZRCL4, ZRCLC, ZRCO2, ZRMU0, ZRN2O&
    &, ZRNO2, ZSPECTRALEMISS, ZSUDU, ZSWDIFFUSEBAND, ZSWDIRECTBAND, ZTH, ZTINCF)
  ENDIF

  CALL RECMWF_ECRAD_POST (YDCPG_BNDS, YDCPG_OPTS, ZFRSOD, ZPFDIF, ZPFDIR)
ENDIF

CALL RECMWF_FINISH (YDCPG_BNDS, YDCPG_OPTS, YDMODEL, PAER, PALB, PALBD, PALBP, PAPRS, PAPRSF, PCEMTR&
&, PCTRSO, PDELP, PEMTD, PEMTU, PFSDNN, PFSDNV, PLWFC, PLWFT, PMU0LU, PMU0M, PNEB, PQ, PQICE, PQLIQ&
&, PQO3, PSFSWDIF, PSFSWDIR, PSWDIF, PSWDIR, PSWFC, PSWFT, PT, PTRSO, PTRSOD, PTRSODIF, PTRSODIR, PVRMOON&
&, ZFCS, ZFCT, ZFRSOD, ZPFDIF, ZPFDIR, ZRCO2, ZRMU0, ZSWDIFFUSEBAND, ZSWDIRECTBAND)



IF (LHOOK) CALL DR_HOOK ('RECMWF', 1, ZHOOK_HANDLE)
ENDSUBROUTINE RECMWF
