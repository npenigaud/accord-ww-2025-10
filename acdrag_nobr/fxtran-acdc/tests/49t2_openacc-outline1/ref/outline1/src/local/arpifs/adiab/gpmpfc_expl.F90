SUBROUTINE GPMPFC_EXPL (YDVARS, YDML_GCONF, YDDYN, YDDYNA, YDCPG_OPTS, YDCPG_BNDS, KFLAG, PGM)
USE MODEL_GENERAL_CONF_MOD,ONLY:MODEL_GENERAL_CONF_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE


TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL_GENERAL_CONF_TYPE), INTENT (IN)::YDML_GCONF
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KFLAG
REAL (KIND=JPRB), INTENT (IN), TARGET::PGM (YDCPG_OPTS%KLON)
#include "abor1.intfb.h"
#include "gpmpfc_expl_outline_001.intfb.h"
#include "gpmpfc_expl_outline_000.intfb.h"

#include "gpmpfc_expl_part2.intfb.h"
REAL (KIND=JPRB), CONTIGUOUS, POINTER::ZGM (:)
REAL (KIND=JPRB), TARGET::ZGM0 (YDCPG_OPTS%KLON)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL', 0, ZHOOK_HANDLE)

IF (KFLAG==0) THEN
  ZGM=>PGM
ELSEIF (KFLAG==1) THEN
  ZGM=>ZGM0
ELSE
  CALL ABOR1 ('GPMPFC_EXPL: ILLEGAL KFLAG')
ENDIF


IF (KFLAG==1) THEN
  CALL GPMPFC_EXPL_OUTLINE_000 (YDCPG_BNDS, YDCPG_OPTS, ZGM, PGM)
ENDIF

CALL GPMPFC_EXPL_OUTLINE_001 (YDCPG_BNDS, YDCPG_OPTS, YDDYN, YDDYNA, YDML_GCONF, YDVARS, ZGM)
CALL GPMPFC_EXPL_PART2 (YDVARS, YDCPG_OPTS, YDCPG_BNDS, ZGM)
IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL', 1, ZHOOK_HANDLE)
ENDSUBROUTINE GPMPFC_EXPL
