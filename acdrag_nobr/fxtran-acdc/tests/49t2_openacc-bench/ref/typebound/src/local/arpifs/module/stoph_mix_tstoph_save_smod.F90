SUBMODULE (STOPH_MIX) STOPH_MIX_TSTOPH_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TSTOPH (SELF, KLUN)

IMPLICIT NONE
CLASS (TSTOPH), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT
LRSTOPHCA = ALLOCATED (SELF%RSTOPHCA)
WRITE (KLUN) LRSTOPHCA
IF (LRSTOPHCA) THEN
  WRITE (KLUN) LBOUND (SELF%RSTOPHCA)
  WRITE (KLUN) UBOUND (SELF%RSTOPHCA)
  WRITE (KLUN) SELF%RSTOPHCA
ENDIF
LSQRTCORR = ALLOCATED (SELF%SQRTCORR)
WRITE (KLUN) LSQRTCORR
IF (LSQRTCORR) THEN
  WRITE (KLUN) LBOUND (SELF%SQRTCORR)
  WRITE (KLUN) UBOUND (SELF%SQRTCORR)
  WRITE (KLUN) SELF%SQRTCORR
ENDIF
LSPSTREAM = ALLOCATED (SELF%SPSTREAM)
WRITE (KLUN) LSPSTREAM
IF (LSPSTREAM) THEN
  WRITE (KLUN) LBOUND (SELF%SPSTREAM)
  WRITE (KLUN) UBOUND (SELF%SPSTREAM)
  WRITE (KLUN) SELF%SPSTREAM
ENDIF
LSPVELPOT = ALLOCATED (SELF%SPVELPOT)
WRITE (KLUN) LSPVELPOT
IF (LSPVELPOT) THEN
  WRITE (KLUN) LBOUND (SELF%SPVELPOT)
  WRITE (KLUN) UBOUND (SELF%SPVELPOT)
  WRITE (KLUN) SELF%SPVELPOT
ENDIF
LSPSTREAM_FORC = ALLOCATED (SELF%SPSTREAM_FORC)
WRITE (KLUN) LSPSTREAM_FORC
IF (LSPSTREAM_FORC) THEN
  WRITE (KLUN) LBOUND (SELF%SPSTREAM_FORC)
  WRITE (KLUN) UBOUND (SELF%SPSTREAM_FORC)
  WRITE (KLUN) SELF%SPSTREAM_FORC
ENDIF
LSPVELPOT_FORC = ALLOCATED (SELF%SPVELPOT_FORC)
WRITE (KLUN) LSPVELPOT_FORC
IF (LSPVELPOT_FORC) THEN
  WRITE (KLUN) LBOUND (SELF%SPVELPOT_FORC)
  WRITE (KLUN) UBOUND (SELF%SPVELPOT_FORC)
  WRITE (KLUN) SELF%SPVELPOT_FORC
ENDIF
LSPG_AMP = ALLOCATED (SELF%SPG_AMP)
WRITE (KLUN) LSPG_AMP
IF (LSPG_AMP) THEN
  WRITE (KLUN) LBOUND (SELF%SPG_AMP)
  WRITE (KLUN) UBOUND (SELF%SPG_AMP)
  WRITE (KLUN) SELF%SPG_AMP
ENDIF
LALPHA_STO = ALLOCATED (SELF%ALPHA_STO)
WRITE (KLUN) LALPHA_STO
IF (LALPHA_STO) THEN
  WRITE (KLUN) LBOUND (SELF%ALPHA_STO)
  WRITE (KLUN) UBOUND (SELF%ALPHA_STO)
  WRITE (KLUN) SELF%ALPHA_STO
ENDIF
LONEMINALPHA_NFRSPBS = ALLOCATED (SELF%ONEMINALPHA_NFRSPBS)
WRITE (KLUN) LONEMINALPHA_NFRSPBS
IF (LONEMINALPHA_NFRSPBS) THEN
  WRITE (KLUN) LBOUND (SELF%ONEMINALPHA_NFRSPBS)
  WRITE (KLUN) UBOUND (SELF%ONEMINALPHA_NFRSPBS)
  WRITE (KLUN) SELF%ONEMINALPHA_NFRSPBS
ENDIF
LRSMOOTH = ALLOCATED (SELF%RSMOOTH)
WRITE (KLUN) LRSMOOTH
IF (LRSMOOTH) THEN
  WRITE (KLUN) LBOUND (SELF%RSMOOTH)
  WRITE (KLUN) UBOUND (SELF%RSMOOTH)
  WRITE (KLUN) SELF%RSMOOTH
ENDIF
LGPSTREAM = ALLOCATED (SELF%GPSTREAM)
WRITE (KLUN) LGPSTREAM
IF (LGPSTREAM) THEN
  WRITE (KLUN) LBOUND (SELF%GPSTREAM)
  WRITE (KLUN) UBOUND (SELF%GPSTREAM)
  WRITE (KLUN) SELF%GPSTREAM
ENDIF
LGPVELPOT = ALLOCATED (SELF%GPVELPOT)
WRITE (KLUN) LGPVELPOT
IF (LGPVELPOT) THEN
  WRITE (KLUN) LBOUND (SELF%GPVELPOT)
  WRITE (KLUN) UBOUND (SELF%GPVELPOT)
  WRITE (KLUN) SELF%GPVELPOT
ENDIF
LGPTOTDISS = ALLOCATED (SELF%GPTOTDISS)
WRITE (KLUN) LGPTOTDISS
IF (LGPTOTDISS) THEN
  WRITE (KLUN) LBOUND (SELF%GPTOTDISS)
  WRITE (KLUN) UBOUND (SELF%GPTOTDISS)
  WRITE (KLUN) SELF%GPTOTDISS
ENDIF
LGPTOTDISS_SMOOTH = ALLOCATED (SELF%GPTOTDISS_SMOOTH)
WRITE (KLUN) LGPTOTDISS_SMOOTH
IF (LGPTOTDISS_SMOOTH) THEN
  WRITE (KLUN) LBOUND (SELF%GPTOTDISS_SMOOTH)
  WRITE (KLUN) UBOUND (SELF%GPTOTDISS_SMOOTH)
  WRITE (KLUN) SELF%GPTOTDISS_SMOOTH
ENDIF
LGPVORTGRAD = ALLOCATED (SELF%GPVORTGRAD)
WRITE (KLUN) LGPVORTGRAD
IF (LGPVORTGRAD) THEN
  WRITE (KLUN) LBOUND (SELF%GPVORTGRAD)
  WRITE (KLUN) UBOUND (SELF%GPVORTGRAD)
  WRITE (KLUN) SELF%GPVORTGRAD
ENDIF
LMCELL = ALLOCATED (SELF%MCELL)
WRITE (KLUN) LMCELL
IF (LMCELL) THEN
  WRITE (KLUN) LBOUND (SELF%MCELL)
  WRITE (KLUN) UBOUND (SELF%MCELL)
  WRITE (KLUN) SELF%MCELL
ENDIF
LRWGHT = ALLOCATED (SELF%RWGHT)
WRITE (KLUN) LRWGHT
IF (LRWGHT) THEN
  WRITE (KLUN) LBOUND (SELF%RWGHT)
  WRITE (KLUN) UBOUND (SELF%RWGHT)
  WRITE (KLUN) SELF%RWGHT
ENDIF
WRITE (KLUN) SELF%NFRSTOPH_SPBS
WRITE (KLUN) SELF%NFRSTOPH_SPBS_PAT
WRITE (KLUN) SELF%NFRSTOPH_VC
WRITE (KLUN) SELF%NFORCESTART
WRITE (KLUN) SELF%NFORCEEND
WRITE (KLUN) SELF%NSTOCHOPT
WRITE (KLUN) SELF%ALPHA_DEEP_CONV
WRITE (KLUN) SELF%ALPHA_SHAL_CONV
WRITE (KLUN) SELF%SLDISSFAC
WRITE (KLUN) SELF%RATIO_BACKSCAT
WRITE (KLUN) SELF%RSPBS_TAU
WRITE (KLUN) SELF%RATIO_BACKSCAT_CON2NUM
WRITE (KLUN) SELF%REXPONENT
WRITE (KLUN) SELF%VC_CON
WRITE (KLUN) SELF%RFLUX_DET_CLIP
WRITE (KLUN) SELF%BIHARM
WRITE (KLUN) SELF%RSMOOTHSCALE
WRITE (KLUN) SELF%RSIGMA2_EPS
WRITE (KLUN) SELF%INCUT
WRITE (KLUN) SELF%AMAGSTOPH_CASBS
WRITE (KLUN) SELF%ADLATSTOPH_CA
WRITE (KLUN) SELF%ADLONSTOPH_CA
WRITE (KLUN) SELF%LSTOPH_SPBS
WRITE (KLUN) SELF%LSTOPH_SPBS_FAST
WRITE (KLUN) SELF%LEXTRAFIELDS
WRITE (KLUN) SELF%LSTOPH_JBCOR
WRITE (KLUN) SELF%LSTOPH_UNCORR
WRITE (KLUN) SELF%LSTOPH_UNIFORM
WRITE (KLUN) SELF%LSTOPH_SPBS_VORT
WRITE (KLUN) SELF%LSTOPH_RVP
WRITE (KLUN) SELF%LSTOPH_RVPOLD
WRITE (KLUN) SELF%LSTOPH_TAPER
WRITE (KLUN) SELF%LSTOPH_INI
WRITE (KLUN) SELF%LSTOPH_CASBS
WRITE (KLUN) SELF%LVORTCON
WRITE (KLUN) SELF%LFORCENL
WRITE (KLUN) SELF%LSTOPH_VARALPHA
WRITE (KLUN) SELF%LSTOPH_GAUSS
WRITE (KLUN) SELF%LSPBS_DISSGW
WRITE (KLUN) SELF%LSPBS_DISSNUM
WRITE (KLUN) SELF%LSPBS_DISSCU
WRITE (KLUN) SELF%LSPBS_DISSNUM_CT
WRITE (KLUN) SELF%LSPBSNORM
WRITE (KLUN) SELF%LSPBSDISS
LSPDP = ALLOCATED (SELF%SPDP)
WRITE (KLUN) LSPDP
IF (LSPDP) THEN
  WRITE (KLUN) LBOUND (SELF%SPDP)
  WRITE (KLUN) UBOUND (SELF%SPDP)
  WRITE (KLUN) SELF%SPDP
ENDIF
LNIMRAN = ALLOCATED (SELF%NIMRAN)
WRITE (KLUN) LNIMRAN
IF (LNIMRAN) THEN
  WRITE (KLUN) LBOUND (SELF%NIMRAN)
  WRITE (KLUN) UBOUND (SELF%NIMRAN)
  WRITE (KLUN) SELF%NIMRAN
ENDIF
WRITE (KLUN) SELF%NSMAXSPBS
WRITE (KLUN) SELF%RVP_MULMIN
WRITE (KLUN) SELF%RVP_MULMAX
WRITE (KLUN) SELF%RVP_MULEXP
WRITE (KLUN) SELF%RVP_MULNSMAX
LRVP_MULFACT = ALLOCATED (SELF%RVP_MULFACT)
WRITE (KLUN) LRVP_MULFACT
IF (LRVP_MULFACT) THEN
  WRITE (KLUN) LBOUND (SELF%RVP_MULFACT)
  WRITE (KLUN) UBOUND (SELF%RVP_MULFACT)
  WRITE (KLUN) SELF%RVP_MULFACT
ENDIF
WRITE (KLUN) SELF%RVP_MUL_A
WRITE (KLUN) SELF%RVP_MUL_B
WRITE (KLUN) SELF%RVP_MUL_C
WRITE (KLUN) SELF%RVP_MUL_D
WRITE (KLUN) SELF%RVP_MUL_1
WRITE (KLUN) SELF%RVP_MUL_2
LRVP_MUL = ALLOCATED (SELF%RVP_MUL)
WRITE (KLUN) LRVP_MUL
IF (LRVP_MUL) THEN
  WRITE (KLUN) LBOUND (SELF%RVP_MUL)
  WRITE (KLUN) UBOUND (SELF%RVP_MUL)
  WRITE (KLUN) SELF%RVP_MUL
ENDIF
WRITE (KLUN) SELF%TAPER_SIGMATOP
WRITE (KLUN) SELF%TAPER_SIGMABOT
WRITE (KLUN) SELF%TAPER0
WRITE (KLUN) SELF%TAPER1
WRITE (KLUN) SELF%TAPER2
WRITE (KLUN) SELF%TAPER3
LTAPER_FACT = ALLOCATED (SELF%TAPER_FACT)
WRITE (KLUN) LTAPER_FACT
IF (LTAPER_FACT) THEN
  WRITE (KLUN) LBOUND (SELF%TAPER_FACT)
  WRITE (KLUN) UBOUND (SELF%TAPER_FACT)
  WRITE (KLUN) SELF%TAPER_FACT
ENDIF
WRITE (KLUN) SELF%LSTOPH_SPBS_T
WRITE (KLUN) SELF%REXPONENT_T
WRITE (KLUN) SELF%RATIO_APE2KE
LSPTEMP = ALLOCATED (SELF%SPTEMP)
WRITE (KLUN) LSPTEMP
IF (LSPTEMP) THEN
  WRITE (KLUN) LBOUND (SELF%SPTEMP)
  WRITE (KLUN) UBOUND (SELF%SPTEMP)
  WRITE (KLUN) SELF%SPTEMP
ENDIF
LSPTEMP_FORC = ALLOCATED (SELF%SPTEMP_FORC)
WRITE (KLUN) LSPTEMP_FORC
IF (LSPTEMP_FORC) THEN
  WRITE (KLUN) LBOUND (SELF%SPTEMP_FORC)
  WRITE (KLUN) UBOUND (SELF%SPTEMP_FORC)
  WRITE (KLUN) SELF%SPTEMP_FORC
ENDIF
LSPG_AMP_T = ALLOCATED (SELF%SPG_AMP_T)
WRITE (KLUN) LSPG_AMP_T
IF (LSPG_AMP_T) THEN
  WRITE (KLUN) LBOUND (SELF%SPG_AMP_T)
  WRITE (KLUN) UBOUND (SELF%SPG_AMP_T)
  WRITE (KLUN) SELF%SPG_AMP_T
ENDIF
LALPHA_STO_T = ALLOCATED (SELF%ALPHA_STO_T)
WRITE (KLUN) LALPHA_STO_T
IF (LALPHA_STO_T) THEN
  WRITE (KLUN) LBOUND (SELF%ALPHA_STO_T)
  WRITE (KLUN) UBOUND (SELF%ALPHA_STO_T)
  WRITE (KLUN) SELF%ALPHA_STO_T
ENDIF
LONEMINALPHA_NFRSPBS_T = ALLOCATED (SELF%ONEMINALPHA_NFRSPBS_T)
WRITE (KLUN) LONEMINALPHA_NFRSPBS_T
IF (LONEMINALPHA_NFRSPBS_T) THEN
  WRITE (KLUN) LBOUND (SELF%ONEMINALPHA_NFRSPBS_T)
  WRITE (KLUN) UBOUND (SELF%ONEMINALPHA_NFRSPBS_T)
  WRITE (KLUN) SELF%ONEMINALPHA_NFRSPBS_T
ENDIF
LGPTEMP = ALLOCATED (SELF%GPTEMP)
WRITE (KLUN) LGPTEMP
IF (LGPTEMP) THEN
  WRITE (KLUN) LBOUND (SELF%GPTEMP)
  WRITE (KLUN) UBOUND (SELF%GPTEMP)
  WRITE (KLUN) SELF%GPTEMP
ENDIF
WRITE (KLUN) SELF%RVP_MULMIN_T
WRITE (KLUN) SELF%RVP_MULMAX_T
WRITE (KLUN) SELF%RVP_MULEXP_T
WRITE (KLUN) SELF%RVP_MULNSMAX_T
LRVP_MULFACT_T = ALLOCATED (SELF%RVP_MULFACT_T)
WRITE (KLUN) LRVP_MULFACT_T
IF (LRVP_MULFACT_T) THEN
  WRITE (KLUN) LBOUND (SELF%RVP_MULFACT_T)
  WRITE (KLUN) UBOUND (SELF%RVP_MULFACT_T)
  WRITE (KLUN) SELF%RVP_MULFACT_T
ENDIF
WRITE (KLUN) SELF%RVP_MUL_A_T
WRITE (KLUN) SELF%RVP_MUL_B_T
WRITE (KLUN) SELF%RVP_MUL_C_T
WRITE (KLUN) SELF%RVP_MUL_D_T
WRITE (KLUN) SELF%RVP_MUL_1_T
WRITE (KLUN) SELF%RVP_MUL_2_T
LRVP_MUL_T = ALLOCATED (SELF%RVP_MUL_T)
WRITE (KLUN) LRVP_MUL_T
IF (LRVP_MUL_T) THEN
  WRITE (KLUN) LBOUND (SELF%RVP_MUL_T)
  WRITE (KLUN) UBOUND (SELF%RVP_MUL_T)
  WRITE (KLUN) SELF%RVP_MUL_T
ENDIF
END SUBROUTINE

END SUBMODULE
