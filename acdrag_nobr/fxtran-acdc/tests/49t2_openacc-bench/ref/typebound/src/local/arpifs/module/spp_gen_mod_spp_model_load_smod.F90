SUBMODULE (SPP_GEN_MOD) SPP_GEN_MOD_SPP_MODEL_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_SPP_MODEL (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (SPP_MODEL), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%VERSION
READ (KLUN) SELF%NMAX
READ (KLUN) SELF%DEFINED_PERTS
READ (KLUN) SELF%ACTIVE_PERTS
READ (KLUN) SELF%NDEF
READ (KLUN) SELF%NACT
READ (KLUN) SELF%NRFTOTAL
READ (KLUN) SELF%NRFTOTAL_RADGRID
READ (KLUN) SELF%NSEED_OFF
DO J1 = LBOUND (SELF%PNDEF, 1), UBOUND (SELF%PNDEF, 1)
  CALL SELF%PNDEF (J1)%ACDC_LOAD (KLUN)
ENDDO
DO J1 = LBOUND (SELF%PN, 1), UBOUND (SELF%PN, 1)
  CALL SELF%PN (J1)%ACDC_LOAD (KLUN)
ENDDO
READ (KLUN) ZTMP0
SELF%TAU = ZTMP0
READ (KLUN) ZTMP0
SELF%XLCOR = ZTMP0
READ (KLUN) ZTMP0
SELF%SDEV = ZTMP0
READ (KLUN) SELF%KSEED_OFF
END SUBROUTINE

END SUBMODULE
