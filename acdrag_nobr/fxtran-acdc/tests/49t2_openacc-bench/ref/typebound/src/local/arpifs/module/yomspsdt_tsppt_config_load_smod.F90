SUBMODULE (YOMSPSDT) YOMSPSDT_TSPPT_CONFIG_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TSPPT_CONFIG (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TSPPT_CONFIG), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) SELF%LSPSDT
READ (KLUN) SELF%LRADCLR_SDT
READ (KLUN) SELF%LSATADJ_SDT
READ (KLUN) SELF%LSPPT1
READ (KLUN) SELF%LSPPTGFIX
READ (KLUN) SELF%LCLIP_SPEC_SDT
READ (KLUN) SELF%LCLIP_GRID_SDT
READ (KLUN) SELF%LQPERTLIMIT2
READ (KLUN) SELF%LTAPER_BL0
READ (KLUN) SELF%LTAPER_BLI
READ (KLUN) SELF%LTAPER_ST0
READ (KLUN) SELF%LTAPER_STI
READ (KLUN) SELF%LUSESETRAN_SDT
READ (KLUN) SELF%LRESETSEED_SDT
READ (KLUN) SELF%LABSTIMSEED_SDT
READ (KLUN) SELF%LWRITE_ARP
READ (KLUN) SELF%LRDPATINIT_SDT
READ (KLUN) SELF%LWRPATTRUN_SDT
READ (KLUN) LLACTIVEQ_SDT
IF (LLACTIVEQ_SDT) THEN
  ALLOCATE (SELF%LACTIVEQ_SDT)
  READ (KLUN) SELF%LACTIVEQ_SDT
ELSE
  NULLIFY (SELF%LACTIVEQ_SDT)
ENDIF
READ (KLUN) LLACTIVEO_SDT
IF (LLACTIVEO_SDT) THEN
  ALLOCATE (SELF%LACTIVEO_SDT)
  READ (KLUN) SELF%LACTIVEO_SDT
ELSE
  NULLIFY (SELF%LACTIVEO_SDT)
ENDIF
READ (KLUN) SELF%NSCALES_SDT
READ (KLUN) SELF%NPATFR
READ (KLUN) SELF%RESETSEEDFRQ_SDT
READ (KLUN) SELF%NWRPATTRUN_SDT
READ (KLUN) SELF%NHOUR_PATTRUN
READ (KLUN) SELF%NSTEP_PATTRUN
READ (KLUN) SELF%NCLIP_KIND_SDT
READ (KLUN) SELF%NQSAT_SDT
READ (KLUN) SELF%NWN_TESTSPEC_SDT
READ (KLUN) SELF%NWAV_TESTSPEC_SDT
ALLOCATE (ZTMP2(LBOUND(SELF%SDEV_SDT,1):UBOUND(SELF%SDEV_SDT,1), LBOUND(SELF%SDEV_SDT,2):UBOUND(SELF%SDEV_SDT,2)))
READ (KLUN) ZTMP2
SELF%SDEV_SDT = ZTMP2
DEALLOCATE (ZTMP2)
ALLOCATE (ZTMP1(LBOUND(SELF%TAU_SDT,1):UBOUND(SELF%TAU_SDT,1)))
READ (KLUN) ZTMP1
SELF%TAU_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%XLCOR_SDT,1):UBOUND(SELF%XLCOR_SDT,1)))
READ (KLUN) ZTMP1
SELF%XLCOR_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%XWC_KAPPA_T,1):UBOUND(SELF%XWC_KAPPA_T,1)))
READ (KLUN) ZTMP1
SELF%XWC_KAPPA_T = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%XCLIPM_SDT,1):UBOUND(SELF%XCLIPM_SDT,1)))
READ (KLUN) ZTMP1
SELF%XCLIPM_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%XCLIP_RATIO_SDT,1):UBOUND(SELF%XCLIP_RATIO_SDT,1)))
READ (KLUN) ZTMP1
SELF%XCLIP_RATIO_SDT = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
SELF%XMEANRED_THICKNESS_SDT = ZTMP0
ALLOCATE (ZTMP1(LBOUND(SELF%SDEVTOT_SDT,1):UBOUND(SELF%SDEVTOT_SDT,1)))
READ (KLUN) ZTMP1
SELF%SDEVTOT_SDT = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
SELF%XSIGMATOP = ZTMP0
READ (KLUN) ZTMP0
SELF%XSIGMABOT = ZTMP0
READ (KLUN) ZTMP0
SELF%XPRESSTOP_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XPRESSBOT_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER3 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER2 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER1 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER3_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER2_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER1_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XTAPER0_ST0 = ZTMP0
READ (KLUN) ZTMP0
SELF%XSPPTGFIXRLX = ZTMP0
READ (KLUN) SELF%CSPEC_SHAPE_SDT
READ (KLUN) LCIPATINIT_SDT
IF (LCIPATINIT_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CIPATINIT_SDT (IL1(1):IU1(1)))
  READ (KLUN) SELF%CIPATINIT_SDT
ELSE
  NULLIFY (SELF%CIPATINIT_SDT)
ENDIF
READ (KLUN) LCOPATTRUN_SDT
IF (LCOPATTRUN_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%COPATTRUN_SDT (IL1(1):IU1(1)))
  READ (KLUN) SELF%COPATTRUN_SDT
ELSE
  NULLIFY (SELF%COPATTRUN_SDT)
ENDIF
READ (KLUN) LCOPATSP_SDT
IF (LCOPATSP_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%COPATSP_SDT (IL1(1):IU1(1)))
  READ (KLUN) SELF%COPATSP_SDT
ELSE
  NULLIFY (SELF%COPATSP_SDT)
ENDIF
READ (KLUN) LCOPATGP_SDT
IF (LCOPATGP_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%COPATGP_SDT (IL1(1):IU1(1)))
  READ (KLUN) SELF%COPATGP_SDT
ELSE
  NULLIFY (SELF%COPATGP_SDT)
ENDIF
END SUBROUTINE

END SUBMODULE
