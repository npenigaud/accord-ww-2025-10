SUBMODULE (YOMVERT) YOMVERT_TVETA_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TVETA (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TVETA), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LVDETA_RATIO, LVETAF, LVETAH, LVETA_H, LVETA_LAITRIQM3D, LVFE_ETAF, LVFE_ETAH, LVFE_RDETAH, LVRDETAH, LVWEI
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LVETAH
IF (LVETAH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VETAH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VETAH,1):UBOUND(SELF%VETAH,1)))
  READ (KLUN) ZTMP1
  SELF%VETAH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVFE_ETAH
IF (LVFE_ETAH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VFE_ETAH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VFE_ETAH,1):UBOUND(SELF%VFE_ETAH,1)))
  READ (KLUN) ZTMP1
  SELF%VFE_ETAH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVETAF
IF (LVETAF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VETAF (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VETAF,1):UBOUND(SELF%VETAF,1)))
  READ (KLUN) ZTMP1
  SELF%VETAF = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVFE_ETAF
IF (LVFE_ETAF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VFE_ETAF (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VFE_ETAF,1):UBOUND(SELF%VFE_ETAF,1)))
  READ (KLUN) ZTMP1
  SELF%VFE_ETAF = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVFE_RDETAH
IF (LVFE_RDETAH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VFE_RDETAH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VFE_RDETAH,1):UBOUND(SELF%VFE_RDETAH,1)))
  READ (KLUN) ZTMP1
  SELF%VFE_RDETAH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVDETA_RATIO
IF (LVDETA_RATIO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VDETA_RATIO (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VDETA_RATIO,1):UBOUND(SELF%VDETA_RATIO,1)))
  READ (KLUN) ZTMP1
  SELF%VDETA_RATIO = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVRDETAH
IF (LVRDETAH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VRDETAH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VRDETAH,1):UBOUND(SELF%VRDETAH,1)))
  READ (KLUN) ZTMP1
  SELF%VRDETAH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVWEI
IF (LVWEI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VWEI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VWEI,1):UBOUND(SELF%VWEI,1)))
  READ (KLUN) ZTMP1
  SELF%VWEI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVETA_H
IF (LVETA_H) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VETA_H (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VETA_H,1):UBOUND(SELF%VETA_H,1)))
  READ (KLUN) ZTMP1
  SELF%VETA_H = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LVETA_LAITRIQM3D
IF (LVETA_LAITRIQM3D) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VETA_LAITRIQM3D (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VETA_LAITRIQM3D,1):UBOUND(SELF%VETA_LAITRIQM3D,1)))
  READ (KLUN) ZTMP1
  SELF%VETA_LAITRIQM3D = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

END SUBMODULE
