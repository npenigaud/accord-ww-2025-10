SUBMODULE (YOMDIMF) YOMDIMF_TDIMF_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TDIMF (SELF, KLUN)

IMPLICIT NONE
CLASS (TDIMF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LNGRBSP2, LNGRBSP3
WRITE (KLUN) SELF%NFTHER
WRITE (KLUN) SELF%NF3D
WRITE (KLUN) SELF%NFD2D
WRITE (KLUN) SELF%NFC2D
WRITE (KLUN) SELF%NS3D
WRITE (KLUN) SELF%NS2D
WRITE (KLUN) SELF%NS1D
LNGRBSP3 = ALLOCATED (SELF%NGRBSP3)
WRITE (KLUN) LNGRBSP3
IF (LNGRBSP3) THEN
  WRITE (KLUN) LBOUND (SELF%NGRBSP3)
  WRITE (KLUN) UBOUND (SELF%NGRBSP3)
  WRITE (KLUN) SELF%NGRBSP3
ENDIF
LNGRBSP2 = ALLOCATED (SELF%NGRBSP2)
WRITE (KLUN) LNGRBSP2
IF (LNGRBSP2) THEN
  WRITE (KLUN) LBOUND (SELF%NGRBSP2)
  WRITE (KLUN) UBOUND (SELF%NGRBSP2)
  WRITE (KLUN) SELF%NGRBSP2
ENDIF
WRITE (KLUN) SELF%LVOR
WRITE (KLUN) SELF%LADER
WRITE (KLUN) SELF%LUVDER
WRITE (KLUN) SELF%LSPT
END SUBROUTINE

END SUBMODULE
