SUBMODULE (EINT_MOD) EINT_MOD_SL_STRUCT_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_SL_STRUCT (SELF, KLUN)

IMPLICIT NONE
CLASS (SL_STRUCT), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI
WRITE (KLUN) SELF%CVER
WRITE (KLUN) SELF%NSLGROUP
LNSLSTA = ALLOCATED (SELF%NSLSTA)
WRITE (KLUN) LNSLSTA
IF (LNSLSTA) THEN
  WRITE (KLUN) LBOUND (SELF%NSLSTA)
  WRITE (KLUN) UBOUND (SELF%NSLSTA)
  WRITE (KLUN) SELF%NSLSTA
ENDIF
LNSLONL = ALLOCATED (SELF%NSLONL)
WRITE (KLUN) LNSLONL
IF (LNSLONL) THEN
  WRITE (KLUN) LBOUND (SELF%NSLONL)
  WRITE (KLUN) UBOUND (SELF%NSLONL)
  WRITE (KLUN) SELF%NSLONL
ENDIF
LNSLOFF = ALLOCATED (SELF%NSLOFF)
WRITE (KLUN) LNSLOFF
IF (LNSLOFF) THEN
  WRITE (KLUN) LBOUND (SELF%NSLOFF)
  WRITE (KLUN) UBOUND (SELF%NSLOFF)
  WRITE (KLUN) SELF%NSLOFF
ENDIF
LNSLPTSWEST = ALLOCATED (SELF%NSLPTSWEST)
WRITE (KLUN) LNSLPTSWEST
IF (LNSLPTSWEST) THEN
  WRITE (KLUN) LBOUND (SELF%NSLPTSWEST)
  WRITE (KLUN) UBOUND (SELF%NSLPTSWEST)
  WRITE (KLUN) SELF%NSLPTSWEST
ENDIF
LNSLPTSEAST = ALLOCATED (SELF%NSLPTSEAST)
WRITE (KLUN) LNSLPTSEAST
IF (LNSLPTSEAST) THEN
  WRITE (KLUN) LBOUND (SELF%NSLPTSEAST)
  WRITE (KLUN) UBOUND (SELF%NSLPTSEAST)
  WRITE (KLUN) SELF%NSLPTSEAST
ENDIF
LNSLEXT = ALLOCATED (SELF%NSLEXT)
WRITE (KLUN) LNSLEXT
IF (LNSLEXT) THEN
  WRITE (KLUN) LBOUND (SELF%NSLEXT)
  WRITE (KLUN) UBOUND (SELF%NSLEXT)
  WRITE (KLUN) SELF%NSLEXT
ENDIF
LLCOMPLAT = ALLOCATED (SELF%LCOMPLAT)
WRITE (KLUN) LLCOMPLAT
IF (LLCOMPLAT) THEN
  WRITE (KLUN) LBOUND (SELF%LCOMPLAT)
  WRITE (KLUN) UBOUND (SELF%LCOMPLAT)
  WRITE (KLUN) SELF%LCOMPLAT
ENDIF
LNLATGLO = ALLOCATED (SELF%NLATGLO)
WRITE (KLUN) LNLATGLO
IF (LNLATGLO) THEN
  WRITE (KLUN) LBOUND (SELF%NLATGLO)
  WRITE (KLUN) UBOUND (SELF%NLATGLO)
  WRITE (KLUN) SELF%NLATGLO
ENDIF
LDIST1GP = ALLOCATED (SELF%DIST1GP)
WRITE (KLUN) LDIST1GP
IF (LDIST1GP) THEN
  WRITE (KLUN) LBOUND (SELF%DIST1GP)
  WRITE (KLUN) UBOUND (SELF%DIST1GP)
  WRITE (KLUN) SELF%DIST1GP
ENDIF
LNSLSENDPOS = ALLOCATED (SELF%NSLSENDPOS)
WRITE (KLUN) LNSLSENDPOS
IF (LNSLSENDPOS) THEN
  WRITE (KLUN) LBOUND (SELF%NSLSENDPOS)
  WRITE (KLUN) UBOUND (SELF%NSLSENDPOS)
  WRITE (KLUN) SELF%NSLSENDPOS
ENDIF
LNSLRECVPOS = ALLOCATED (SELF%NSLRECVPOS)
WRITE (KLUN) LNSLRECVPOS
IF (LNSLRECVPOS) THEN
  WRITE (KLUN) LBOUND (SELF%NSLRECVPOS)
  WRITE (KLUN) UBOUND (SELF%NSLRECVPOS)
  WRITE (KLUN) SELF%NSLRECVPOS
ENDIF
LNSLSENDPTR = ALLOCATED (SELF%NSLSENDPTR)
WRITE (KLUN) LNSLSENDPTR
IF (LNSLSENDPTR) THEN
  WRITE (KLUN) LBOUND (SELF%NSLSENDPTR)
  WRITE (KLUN) UBOUND (SELF%NSLSENDPTR)
  WRITE (KLUN) SELF%NSLSENDPTR
ENDIF
LNSLRECVPTR = ALLOCATED (SELF%NSLRECVPTR)
WRITE (KLUN) LNSLRECVPTR
IF (LNSLRECVPTR) THEN
  WRITE (KLUN) LBOUND (SELF%NSLRECVPTR)
  WRITE (KLUN) UBOUND (SELF%NSLRECVPTR)
  WRITE (KLUN) SELF%NSLRECVPTR
ENDIF
LNSLCOMM = ALLOCATED (SELF%NSLCOMM)
WRITE (KLUN) LNSLCOMM
IF (LNSLCOMM) THEN
  WRITE (KLUN) LBOUND (SELF%NSLCOMM)
  WRITE (KLUN) UBOUND (SELF%NSLCOMM)
  WRITE (KLUN) SELF%NSLCOMM
ENDIF
LLSLCOMM = ALLOCATED (SELF%LSLCOMM)
WRITE (KLUN) LLSLCOMM
IF (LLSLCOMM) THEN
  WRITE (KLUN) LBOUND (SELF%LSLCOMM)
  WRITE (KLUN) UBOUND (SELF%LSLCOMM)
  WRITE (KLUN) SELF%LSLCOMM
ENDIF
WRITE (KLUN) SELF%NASLB1
WRITE (KLUN) SELF%NASLMASK
WRITE (KLUN) SELF%NASLB1_TRUE
WRITE (KLUN) SELF%NSLPAD
WRITE (KLUN) SELF%LSLT_ARRAYS_INIT
WRITE (KLUN) SELF%LSLONDEM
WRITE (KLUN) SELF%LSLONDEM_ACTIVE
WRITE (KLUN) SELF%NUNUSEDHALO
WRITE (KLUN) SELF%DISTUNUSEDHALO
WRITE (KLUN) SELF%NSLPROCS
WRITE (KLUN) SELF%NSLRPT
WRITE (KLUN) SELF%NSLSPT
WRITE (KLUN) SELF%NSLWIDEN
WRITE (KLUN) SELF%NSLWIDES
WRITE (KLUN) SELF%NSLWIDEE
WRITE (KLUN) SELF%NSLWIDEW
WRITE (KLUN) SELF%NSLWIDE
LNSLMAP = ALLOCATED (SELF%NSLMAP)
WRITE (KLUN) LNSLMAP
IF (LNSLMAP) THEN
  WRITE (KLUN) LBOUND (SELF%NSLMAP)
  WRITE (KLUN) UBOUND (SELF%NSLMAP)
  WRITE (KLUN) SELF%NSLMAP
ENDIF
LNSLCORE = ALLOCATED (SELF%NSLCORE)
WRITE (KLUN) LNSLCORE
IF (LNSLCORE) THEN
  WRITE (KLUN) LBOUND (SELF%NSLCORE)
  WRITE (KLUN) UBOUND (SELF%NSLCORE)
  WRITE (KLUN) SELF%NSLCORE
ENDIF
LLSLCORE = ALLOCATED (SELF%LSLCORE)
WRITE (KLUN) LLSLCORE
IF (LLSLCORE) THEN
  WRITE (KLUN) LBOUND (SELF%LSLCORE)
  WRITE (KLUN) UBOUND (SELF%LSLCORE)
  WRITE (KLUN) SELF%LSLCORE
ENDIF
WRITE (KLUN) SELF%NDGLG
WRITE (KLUN) SELF%NDLON
WRITE (KLUN) SELF%NDGSAG
WRITE (KLUN) SELF%NDGENG
WRITE (KLUN) SELF%NDGSAL
WRITE (KLUN) SELF%NDGENL
WRITE (KLUN) SELF%NDGSAH
WRITE (KLUN) SELF%NDGENH
WRITE (KLUN) SELF%NGPTOT
WRITE (KLUN) SELF%NDGUXL
WRITE (KLUN) SELF%NDLUNG
WRITE (KLUN) SELF%NDLUXG
WRITE (KLUN) SELF%NDGUNG
WRITE (KLUN) SELF%NDGUXG
WRITE (KLUN) SELF%NDSUR1
WRITE (KLUN) SELF%NDLSUR
WRITE (KLUN) SELF%NDGSUR
WRITE (KLUN) SELF%NPTRFLOFF
WRITE (KLUN) SELF%NFRSTLOFF
WRITE (KLUN) SELF%MYFRSTACTLAT
WRITE (KLUN) SELF%MYLSTACTLAT
LNLOENG = ALLOCATED (SELF%NLOENG)
WRITE (KLUN) LNLOENG
IF (LNLOENG) THEN
  WRITE (KLUN) LBOUND (SELF%NLOENG)
  WRITE (KLUN) UBOUND (SELF%NLOENG)
  WRITE (KLUN) SELF%NLOENG
ENDIF
WRITE (KLUN) SELF%NPROC
LNSTALAT = ALLOCATED (SELF%NSTALAT)
WRITE (KLUN) LNSTALAT
IF (LNSTALAT) THEN
  WRITE (KLUN) LBOUND (SELF%NSTALAT)
  WRITE (KLUN) UBOUND (SELF%NSTALAT)
  WRITE (KLUN) SELF%NSTALAT
ENDIF
LNADDR = ALLOCATED (SELF%NADDR)
WRITE (KLUN) LNADDR
IF (LNADDR) THEN
  WRITE (KLUN) LBOUND (SELF%NADDR)
  WRITE (KLUN) UBOUND (SELF%NADDR)
  WRITE (KLUN) SELF%NADDR
ENDIF
LNOFFLEV = ALLOCATED (SELF%NOFFLEV)
WRITE (KLUN) LNOFFLEV
IF (LNOFFLEV) THEN
  WRITE (KLUN) LBOUND (SELF%NOFFLEV)
  WRITE (KLUN) UBOUND (SELF%NOFFLEV)
  WRITE (KLUN) SELF%NOFFLEV
ENDIF
LRLSDEPI = ALLOCATED (SELF%RLSDEPI)
WRITE (KLUN) LRLSDEPI
IF (LRLSDEPI) THEN
  WRITE (KLUN) LBOUND (SELF%RLSDEPI)
  WRITE (KLUN) UBOUND (SELF%RLSDEPI)
  WRITE (KLUN) SELF%RLSDEPI
ENDIF
LNSLEXTPOLFISTA = ALLOCATED (SELF%NSLEXTPOLFISTA)
WRITE (KLUN) LNSLEXTPOLFISTA
IF (LNSLEXTPOLFISTA) THEN
  WRITE (KLUN) LBOUND (SELF%NSLEXTPOLFISTA)
  WRITE (KLUN) UBOUND (SELF%NSLEXTPOLFISTA)
  WRITE (KLUN) SELF%NSLEXTPOLFISTA
ENDIF
LNSLEXTPOLIJPTA = ALLOCATED (SELF%NSLEXTPOLIJPTA)
WRITE (KLUN) LNSLEXTPOLIJPTA
IF (LNSLEXTPOLIJPTA) THEN
  WRITE (KLUN) LBOUND (SELF%NSLEXTPOLIJPTA)
  WRITE (KLUN) UBOUND (SELF%NSLEXTPOLIJPTA)
  WRITE (KLUN) SELF%NSLEXTPOLIJPTA
ENDIF
LNSLEXTPOLIPTA = ALLOCATED (SELF%NSLEXTPOLIPTA)
WRITE (KLUN) LNSLEXTPOLIPTA
IF (LNSLEXTPOLIPTA) THEN
  WRITE (KLUN) LBOUND (SELF%NSLEXTPOLIPTA)
  WRITE (KLUN) UBOUND (SELF%NSLEXTPOLIPTA)
  WRITE (KLUN) SELF%NSLEXTPOLIPTA
ENDIF
END SUBROUTINE

END SUBMODULE
