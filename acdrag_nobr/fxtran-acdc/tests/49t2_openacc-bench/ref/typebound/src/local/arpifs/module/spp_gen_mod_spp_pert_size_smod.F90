SUBMODULE (SPP_GEN_MOD) SPP_GEN_MOD_SPP_PERT_SIZE_SMOD

IMPLICIT NONE

CONTAINS

MODULE FUNCTION ACDC_SIZE_SPP_PERT (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (SPP_PERT),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LABEL) * LEN (SELF%LABEL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LABEL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IDISTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IDISTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XMAG) * SIZE (SELF%XMAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%MU) * SIZE (SELF%MU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XCLIPMIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCLIPMIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XCLIPMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCLIPMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XUNIFORM_OFFSET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XUNIFORM_OFFSET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LN1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LN1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSEED_OFF) * SIZE (SELF%NSEED_OFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSEED_OFF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NOFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOFF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRF_RADGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRF_RADGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RADGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RADGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RF_PERT_LABEL) * LEN (SELF%RF_PERT_LABEL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RF_PERT_LABEL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%MP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%MP_RADGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MP_RADGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%TAU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SDEV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SDEV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XLCOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XLCOR'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END SUBMODULE
