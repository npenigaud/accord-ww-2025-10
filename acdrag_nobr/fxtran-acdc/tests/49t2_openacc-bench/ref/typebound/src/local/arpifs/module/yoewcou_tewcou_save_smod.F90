SUBMODULE (YOEWCOU) YOEWCOU_TEWCOU_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TEWCOU (SELF, KLUN)

IMPLICIT NONE
CLASS (TEWCOU), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
WRITE (KLUN) SELF%NATMFLX
WRITE (KLUN) SELF%NGAUSSW
WRITE (KLUN) SELF%NLONW
WRITE (KLUN) SELF%NLATW
WRITE (KLUN) SELF%NLON1W
WRITE (KLUN) SELF%NLAT1W
WRITE (KLUN) SELF%NNORXW
WRITE (KLUN) SELF%NSTPW
WRITE (KLUN) SELF%NGRIB_HANDLE_FOR_WAM
WRITE (KLUN) SELF%RSOUTW
WRITE (KLUN) SELF%RNORTW
WRITE (KLUN) SELF%RDEGREW
WRITE (KLUN) SELF%RMISSW
WRITE (KLUN) SELF%LWCOU
WRITE (KLUN) SELF%LWCOU2W
WRITE (KLUN) SELF%LWCOUNORMS
WRITE (KLUN) SELF%LWCUR
WRITE (KLUN) SELF%LWCOURNW
WRITE (KLUN) SELF%LWCOUHMF
WRITE (KLUN) SELF%LWSTOKES
WRITE (KLUN) SELF%LWFLUX
WRITE (KLUN) SELF%CBEGDAT
LMASK_WAVE_IN = ALLOCATED (SELF%MASK_WAVE_IN)
WRITE (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  WRITE (KLUN) LBOUND (SELF%MASK_WAVE_IN)
  WRITE (KLUN) UBOUND (SELF%MASK_WAVE_IN)
  WRITE (KLUN) SELF%MASK_WAVE_IN
ENDIF
LMASK_WAVE_OUT = ALLOCATED (SELF%MASK_WAVE_OUT)
WRITE (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  WRITE (KLUN) LBOUND (SELF%MASK_WAVE_OUT)
  WRITE (KLUN) UBOUND (SELF%MASK_WAVE_OUT)
  WRITE (KLUN) SELF%MASK_WAVE_OUT
ENDIF
WRITE (KLUN) SELF%LWVIN_MASK_NOT_SET
WRITE (KLUN) SELF%LWVOUT_MASK_NOT_SET
WRITE (KLUN) SELF%LWVIN_UNINITIALISED
WRITE (KLUN) SELF%MWVIN_SENDTOT
WRITE (KLUN) SELF%MWVIN_RECVTOT
LMWVIN_SENDCNT = ALLOCATED (SELF%MWVIN_SENDCNT)
WRITE (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDCNT)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDCNT)
  WRITE (KLUN) SELF%MWVIN_SENDCNT
ENDIF
LMWVIN_RECVCNT = ALLOCATED (SELF%MWVIN_RECVCNT)
WRITE (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVCNT)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVCNT)
  WRITE (KLUN) SELF%MWVIN_RECVCNT
ENDIF
LMWVIN_SENDOFF = ALLOCATED (SELF%MWVIN_SENDOFF)
WRITE (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDOFF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDOFF)
  WRITE (KLUN) SELF%MWVIN_SENDOFF
ENDIF
LMWVIN_RECVOFF = ALLOCATED (SELF%MWVIN_RECVOFF)
WRITE (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVOFF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVOFF)
  WRITE (KLUN) SELF%MWVIN_RECVOFF
ENDIF
LMWVIN_SENDBUF = ALLOCATED (SELF%MWVIN_SENDBUF)
WRITE (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDBUF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDBUF)
  WRITE (KLUN) SELF%MWVIN_SENDBUF
ENDIF
LMWVIN_RECVBUF = ALLOCATED (SELF%MWVIN_RECVBUF)
WRITE (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVBUF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVBUF)
  WRITE (KLUN) SELF%MWVIN_RECVBUF
ENDIF
LMWVIN_SENDIND = ALLOCATED (SELF%MWVIN_SENDIND)
WRITE (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDIND)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDIND)
  WRITE (KLUN) SELF%MWVIN_SENDIND
ENDIF
WRITE (KLUN) SELF%LWFRSTIME
WRITE (KLUN) SELF%LWINIT
WRITE (KLUN) SELF%NADV_WAVE
WRITE (KLUN) SELF%NWV_W2IWGHT
LIWV_LON = ALLOCATED (SELF%IWV_LON)
WRITE (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  WRITE (KLUN) LBOUND (SELF%IWV_LON)
  WRITE (KLUN) UBOUND (SELF%IWV_LON)
  WRITE (KLUN) SELF%IWV_LON
ENDIF
LIWV_LAT = ALLOCATED (SELF%IWV_LAT)
WRITE (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  WRITE (KLUN) LBOUND (SELF%IWV_LAT)
  WRITE (KLUN) UBOUND (SELF%IWV_LAT)
  WRITE (KLUN) SELF%IWV_LAT
ENDIF
LWV_W2IWGHT = ALLOCATED (SELF%WV_W2IWGHT)
WRITE (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  WRITE (KLUN) LBOUND (SELF%WV_W2IWGHT)
  WRITE (KLUN) UBOUND (SELF%WV_W2IWGHT)
  WRITE (KLUN) SELF%WV_W2IWGHT
ENDIF
END SUBROUTINE

END SUBMODULE
