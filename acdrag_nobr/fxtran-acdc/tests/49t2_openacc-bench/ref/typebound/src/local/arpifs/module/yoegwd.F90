MODULE YOEGWD

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     -----------------------------------------------------------------
!*    ** *YOEGWD* - PARAMETERS FOR GRAVITY WAVE DRAG CALCULATIONS
!     -----------------------------------------------------------------

TYPE :: TEGWD
INTEGER(KIND=JPIM) :: NKTOPG
INTEGER(KIND=JPIM) :: NGWDLIM
INTEGER(KIND=JPIM) :: NGWDTOP
INTEGER(KIND=JPIM) :: NDIFF_STRATO
REAL(KIND=JPRB) :: GFRCRIT
REAL(KIND=JPRB) :: GRCRIT
REAL(KIND=JPRB) :: GKDRAG
REAL(KIND=JPRB) :: GKWAKE
REAL(KIND=JPRB) :: GSSEC
REAL(KIND=JPRB) :: GTSEC
REAL(KIND=JPRB) :: GVSEC
REAL(KIND=JPRB) :: GTENLIM
REAL(KIND=JPRB) :: GRFPLM
LOGICAL         :: LRDIFF_STRATO
LOGICAL         :: LDIAG_STRATO
!---------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TEGWD
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TEGWD
PROCEDURE :: ACDC_HOST => ACDC_HOST_TEGWD
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TEGWD
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TEGWD
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TEGWD
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TEGWD
END TYPE TEGWD
!=====================================================================

!!TYPE(TEGWD), POINTER :: YREGWD => NULL()

!        * E.C.M.W.F. PHYSICS PACKAGE *

!     M. J. MILLER          E.C.M.W.F.      89/12/14

!  NAME     TYPE     PURPOSE
!  ----  :  ----   : ---------------------------------------------------

! GFRCRIT: CRITICAL FROUDE NUMBER
! GRCRIT : CRITICAL RICHARDSON NUMBER FOR ONSET OF WAVE TURBULENCE.
! GKDRAG : DRAG CONSTANT (PROPORTIONAL TO WAVENUMBER)
! GKWAKE : DRAG COEFFICIENT FOR LOWLEVEL WAKE DRAG
! NKTOPG : NUMBER OF TOPMOST LAYER USED TO DEFINE LOW-LEVEL FLOW
! NGWDLIM: VERTICAL LEVEL ABOVE WHICH THE WIND TENDENCIES WILL BE LIMITED 
!          TO GTENLIM
! GTENLIM: LIMITER FOR WIND TENDENCIES IN THE STRATOSPHERE AND MESOSPHERE
! GRFPLM : PRESUURE LIMIT FOR RAYLEIGH FRICTION
! NGWDTOP: INDEX FOR GRFPLM
! LRDIFF_STRATO: IF TRUE REDUCED VERTICAL DIFFUSION IN STRATOSPHERE
! NDIFF_STRATO: TYPE OF REDUCED VERTICAL DIFFUSION IN STRATOSPHERE
! LDIAG_STRATO:  IF TRUE STORE GRAVITY-WAVE MOMENTUM FLUXES


!*    SECURITY PARAMETERS.
!     --------------------

! GSSEC  : TO SECURE STABILITY.
! GTSEC  : TO SECURE THE STRESS CALCULATION.
! GVSEC  : TO SECURE THE PROJECTION CALCULATION.
!     -----------------------------------------------------------------
 
!---------------------------------------------------------------------

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TEGWD (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEGWD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TEGWD (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TEGWD), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TEGWD (SELF)

IMPLICIT NONE
CLASS (TEGWD), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TEGWD (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TEGWD), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TEGWD (SELF, KLUN)

IMPLICIT NONE
CLASS (TEGWD), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TEGWD (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TEGWD),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TEGWD (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEGWD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS 
  
SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TEGWD), INTENT(IN) :: SELF
INTEGER     , INTENT(IN) :: KDEPTH
INTEGER     , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH)    // 'model%yrml_phy_ec%yregwd : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NKTOPG = ', SELF%NKTOPG
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NGWDLIM = ', SELF%NGWDLIM
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NGWDTOP = ', SELF%NGWDTOP
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NDIFF_STRATO = ', SELF%NDIFF_STRATO
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GFRCRIT = ', SELF%GFRCRIT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GRCRIT = ', SELF%GRCRIT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GKDRAG = ', SELF%GKDRAG
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GKWAKE = ', SELF%GKWAKE
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GSSEC = ', SELF%GSSEC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GTSEC = ', SELF%GTSEC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GVSEC = ', SELF%GVSEC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GTENLIM = ', SELF%GTENLIM
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'GRFPLM = ', SELF%GRFPLM
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LRDIFF_STRATO = ', SELF%LRDIFF_STRATO
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LDIAG_STRATO = ', SELF%LDIAG_STRATO

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOEGWD
