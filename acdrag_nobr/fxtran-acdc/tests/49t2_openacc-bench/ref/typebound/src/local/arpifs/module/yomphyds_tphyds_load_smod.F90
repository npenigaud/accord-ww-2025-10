SUBMODULE (YOMPHYDS) YOMPHYDS_TPHYDS_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TPHYDS (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TPHYDS), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) SELF%JPVXP
READ (KLUN) SELF%JPVXP2
READ (KLUN) SELF%JPCXP
READ (KLUN) SELF%JPVEXTR
READ (KLUN) SELF%JPVEXTRDI
READ (KLUN) SELF%JPVXTR2
READ (KLUN) SELF%JPVPRECIP
READ (KLUN) SELF%JPVPRECIP2
READ (KLUN) SELF%CEXTRP
READ (KLUN) SELF%CXTRP2
READ (KLUN) SELF%CVEXTRA
READ (KLUN) SELF%CVEXRAD
READ (KLUN) SELF%CVEXTRDI
READ (KLUN) SELF%CVEXTR2
READ (KLUN) SELF%CVPRECIP
READ (KLUN) SELF%CVPRECIP2
READ (KLUN) SELF%NEXTRPGB
READ (KLUN) SELF%NXTRP2GB
READ (KLUN) SELF%NVEXTRAGB
READ (KLUN) SELF%NVEXRADGB
READ (KLUN) SELF%NVEXTR2GB
READ (KLUN) SELF%NVEXTRDIGB
READ (KLUN) SELF%NVPRECIPGB
READ (KLUN) SELF%NVPRECIPGB2
READ (KLUN) SELF%NSFLUX
READ (KLUN) SELF%NSFORC
READ (KLUN) SELF%NPPVCLIX
ALLOCATE (ZTMP2(LBOUND(SELF%EXTRPDF,1):UBOUND(SELF%EXTRPDF,1), LBOUND(SELF%EXTRPDF,2):UBOUND(SELF%EXTRPDF,2)))
READ (KLUN) ZTMP2
SELF%EXTRPDF = ZTMP2
DEALLOCATE (ZTMP2)
ALLOCATE (ZTMP1(LBOUND(SELF%XTRP2DF,1):UBOUND(SELF%XTRP2DF,1)))
READ (KLUN) ZTMP1
SELF%XTRP2DF = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VEXTRADF,1):UBOUND(SELF%VEXTRADF,1)))
READ (KLUN) ZTMP1
SELF%VEXTRADF = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VEXRADDF,1):UBOUND(SELF%VEXRADDF,1)))
READ (KLUN) ZTMP1
SELF%VEXRADDF = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VEXTR2DF,1):UBOUND(SELF%VEXTR2DF,1)))
READ (KLUN) ZTMP1
SELF%VEXTR2DF = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VEXTRDI,1):UBOUND(SELF%VEXTRDI,1)))
READ (KLUN) ZTMP1
SELF%VEXTRDI = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VPRECIP,1):UBOUND(SELF%VPRECIP,1)))
READ (KLUN) ZTMP1
SELF%VPRECIP = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VPRECIP2,1):UBOUND(SELF%VPRECIP2,1)))
READ (KLUN) ZTMP1
SELF%VPRECIP2 = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) SELF%LREQIN_VEXTRDI
READ (KLUN) SELF%LREQOUT_VEXTRDI
END SUBROUTINE

END SUBMODULE
