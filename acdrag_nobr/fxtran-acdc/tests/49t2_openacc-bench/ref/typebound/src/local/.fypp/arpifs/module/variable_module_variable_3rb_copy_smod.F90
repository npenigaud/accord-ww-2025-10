SUBMODULE (VARIABLE_MODULE) VARIABLE_MODULE_VARIABLE_3RB_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_VARIABLE_3RB (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (VARIABLE_3RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
YLSUPER => SELF
CALL YLSUPER%ACDC_COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FT0)
  !$ACC ENTER DATA ATTACH (SELF%FT0)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FT1)
  !$ACC ENTER DATA ATTACH (SELF%FT1)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FT9)
  !$ACC ENTER DATA ATTACH (SELF%FT9)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FPH9)
  !$ACC ENTER DATA ATTACH (SELF%FPH9)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FDL)
  !$ACC ENTER DATA ATTACH (SELF%FDL)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FDM)
  !$ACC ENTER DATA ATTACH (SELF%FDM)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FDL9)
  !$ACC ENTER DATA ATTACH (SELF%FDL9)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FDM9)
  !$ACC ENTER DATA ATTACH (SELF%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%FPC_PH)
  !$ACC ENTER DATA ATTACH (SELF%FPC_PH)
ENDIF

END SUBROUTINE

END SUBMODULE
