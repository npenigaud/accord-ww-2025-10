SUBMODULE (TYPE_ECV) TYPE_ECV_TECV_CONFIG_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TECV_CONFIG (SELF, KLUN)

IMPLICIT NONE
CLASS (TECV_CONFIG), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
LOGICAL :: LYRCONFIG
WRITE (KLUN) SELF%NECV
LYRCONFIG = ALLOCATED (SELF%YRCONFIG)
WRITE (KLUN) LYRCONFIG
IF (LYRCONFIG) THEN
  WRITE (KLUN) LBOUND (SELF%YRCONFIG)
  WRITE (KLUN) UBOUND (SELF%YRCONFIG)
  DO J1 = LBOUND (SELF%YRCONFIG, 1), UBOUND (SELF%YRCONFIG, 1)
    CALL SELF%YRCONFIG (J1)%ACDC_SAVE (KLUN)
  ENDDO
ENDIF
END SUBROUTINE

END SUBMODULE
