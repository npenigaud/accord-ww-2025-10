SUBMODULE (EINT_MOD) EINT_MOD_SL_STRUCT_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_SL_STRUCT (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (SL_STRUCT), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) SELF%CVER
READ (KLUN) SELF%NSLGROUP
READ (KLUN) LNSLSTA
IF (LNSLSTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLSTA (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLSTA
ENDIF
READ (KLUN) LNSLONL
IF (LNSLONL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLONL (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLONL
ENDIF
READ (KLUN) LNSLOFF
IF (LNSLOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLOFF (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLOFF
ENDIF
READ (KLUN) LNSLPTSWEST
IF (LNSLPTSWEST) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLPTSWEST (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLPTSWEST
ENDIF
READ (KLUN) LNSLPTSEAST
IF (LNSLPTSEAST) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLPTSEAST (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLPTSEAST
ENDIF
READ (KLUN) LNSLEXT
IF (LNSLEXT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NSLEXT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NSLEXT
ENDIF
READ (KLUN) LLCOMPLAT
IF (LLCOMPLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%LCOMPLAT (IL1(1):IU1(1)))
  READ (KLUN) SELF%LCOMPLAT
ENDIF
READ (KLUN) LNLATGLO
IF (LNLATGLO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NLATGLO (IL1(1):IU1(1)))
  READ (KLUN) SELF%NLATGLO
ENDIF
READ (KLUN) LDIST1GP
IF (LDIST1GP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%DIST1GP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%DIST1GP,1):UBOUND(SELF%DIST1GP,1)))
  READ (KLUN) ZTMP1
  SELF%DIST1GP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LNSLSENDPOS
IF (LNSLSENDPOS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLSENDPOS (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLSENDPOS
ENDIF
READ (KLUN) LNSLRECVPOS
IF (LNSLRECVPOS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLRECVPOS (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLRECVPOS
ENDIF
READ (KLUN) LNSLSENDPTR
IF (LNSLSENDPTR) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLSENDPTR (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLSENDPTR
ENDIF
READ (KLUN) LNSLRECVPTR
IF (LNSLRECVPTR) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLRECVPTR (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLRECVPTR
ENDIF
READ (KLUN) LNSLCOMM
IF (LNSLCOMM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLCOMM (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLCOMM
ENDIF
READ (KLUN) LLSLCOMM
IF (LLSLCOMM) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%LSLCOMM (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%LSLCOMM
ENDIF
READ (KLUN) SELF%NASLB1
READ (KLUN) SELF%NASLMASK
READ (KLUN) SELF%NASLB1_TRUE
READ (KLUN) SELF%NSLPAD
READ (KLUN) SELF%LSLT_ARRAYS_INIT
READ (KLUN) SELF%LSLONDEM
READ (KLUN) SELF%LSLONDEM_ACTIVE
READ (KLUN) SELF%NUNUSEDHALO
READ (KLUN) ZTMP0
SELF%DISTUNUSEDHALO = ZTMP0
READ (KLUN) SELF%NSLPROCS
READ (KLUN) SELF%NSLRPT
READ (KLUN) SELF%NSLSPT
READ (KLUN) SELF%NSLWIDEN
READ (KLUN) SELF%NSLWIDES
READ (KLUN) SELF%NSLWIDEE
READ (KLUN) SELF%NSLWIDEW
READ (KLUN) SELF%NSLWIDE
READ (KLUN) LNSLMAP
IF (LNSLMAP) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NSLMAP (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NSLMAP
ENDIF
READ (KLUN) LNSLCORE
IF (LNSLCORE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLCORE (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLCORE
ENDIF
READ (KLUN) LLSLCORE
IF (LLSLCORE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%LSLCORE (IL1(1):IU1(1)))
  READ (KLUN) SELF%LSLCORE
ENDIF
READ (KLUN) SELF%NDGLG
READ (KLUN) SELF%NDLON
READ (KLUN) SELF%NDGSAG
READ (KLUN) SELF%NDGENG
READ (KLUN) SELF%NDGSAL
READ (KLUN) SELF%NDGENL
READ (KLUN) SELF%NDGSAH
READ (KLUN) SELF%NDGENH
READ (KLUN) SELF%NGPTOT
READ (KLUN) SELF%NDGUXL
READ (KLUN) SELF%NDLUNG
READ (KLUN) SELF%NDLUXG
READ (KLUN) SELF%NDGUNG
READ (KLUN) SELF%NDGUXG
READ (KLUN) SELF%NDSUR1
READ (KLUN) SELF%NDLSUR
READ (KLUN) SELF%NDGSUR
READ (KLUN) SELF%NPTRFLOFF
READ (KLUN) SELF%NFRSTLOFF
READ (KLUN) SELF%MYFRSTACTLAT
READ (KLUN) SELF%MYLSTACTLAT
READ (KLUN) LNLOENG
IF (LNLOENG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NLOENG (IL1(1):IU1(1)))
  READ (KLUN) SELF%NLOENG
ENDIF
READ (KLUN) SELF%NPROC
READ (KLUN) LNSTALAT
IF (LNSTALAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSTALAT (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSTALAT
ENDIF
READ (KLUN) LNADDR
IF (LNADDR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NADDR (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NADDR
ENDIF
READ (KLUN) LNOFFLEV
IF (LNOFFLEV) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%NOFFLEV (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  READ (KLUN) SELF%NOFFLEV
ENDIF
READ (KLUN) LRLSDEPI
IF (LRLSDEPI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RLSDEPI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RLSDEPI,1):UBOUND(SELF%RLSDEPI,1)))
  READ (KLUN) ZTMP1
  SELF%RLSDEPI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LNSLEXTPOLFISTA
IF (LNSLEXTPOLFISTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLEXTPOLFISTA (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLEXTPOLFISTA
ENDIF
READ (KLUN) LNSLEXTPOLIJPTA
IF (LNSLEXTPOLIJPTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLEXTPOLIJPTA (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLEXTPOLIJPTA
ENDIF
READ (KLUN) LNSLEXTPOLIPTA
IF (LNSLEXTPOLIPTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NSLEXTPOLIPTA (IL1(1):IU1(1)))
  READ (KLUN) SELF%NSLEXTPOLIPTA
ENDIF
END SUBROUTINE

END SUBMODULE
