MODULE YOMSDDH

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!     LOGIQUE DIAGNOSTIQUES DOMAINES HORIZONTAUX.
!     LES LOGIQUES LHDxxx CI-DESSOUS NE SERONT TESTES QUE
!     SI L'UN DES LOGIQUES PRINCIPAUX LHDHKS, LHDMCI ET LHDENT
!     SONT VRAIS. CE SONT DES SOUS-LOGIQUES DONT LE ROLE
!     EST DE PERMETTRE UNE ECONOMIE DE TAILLE MEMOIRE
!     DANS LE CAS OU LA SOUS-OPTION CORRESPONDANTE N'EST PAS ACTIVEE.

!     LHDQLN = DIAGNOSTIC DE L'EAU LIQUIDE ET NEIGEUSE.
!              CE LOGIQUE N'EST TESTE QUE SI LHDHKS EST VRAI.
!     NHDQLNVA = NOMBRE DE VARIABLES EN SUS SI LHDQLN VRAI
!     NHDQLNTD = NOMBRE DE TENDANCES DYNAMIQUES EN SUS SI LHDQLN VRAI
!     NHDQLNFD = NOMBRE DE FLUX DYNAMIQUES EN SUS SI LHDQLN VRAI
!     NHDQLNFP = NOMBRE DE FLUX PHYSIQUES EN SUS SI LHDQLN VRAI
!     NHDQLNTP = NOMBRE DE TENDANCES PHYSIQUES EN SUS SI LHDQLN VRAI

!     LHDPAS = DIAGNOSTIC DES VARIABLES PASSIVES.
!              CE LOGIQUE N'EST TESTE QUE SI LHDHKS EST VRAI.
!     NHDPASVA = NOMBRE DE VARIABLES EN SUS SI LHDPAS VRAI
!     NHDPASTD = NOMBRE DE TENDANCES DYNAMIQUES EN SUS SI LHDPAS VRAI
!     NHDPASFD = NOMBRE DE FLUX DYNAMIQUES EN SUS SI LHDPAS VRAI
!     NHDPASFP = NOMBRE DE FLUX PHYSIQUES EN SUS SI LHDPAS VRAI
!     NHDPASTP = NOMBRE DE TENDANCES PHYSIQUES EN SUS SI LHDPAS VRAI

TYPE :: TSDDH
INTEGER(KIND=JPIM) :: NHDQLNVA
INTEGER(KIND=JPIM) :: NHDQLNTD
INTEGER(KIND=JPIM) :: NHDQLNFD
INTEGER(KIND=JPIM) :: NHDQLNFP
INTEGER(KIND=JPIM) :: NHDQLNTP
INTEGER(KIND=JPIM) :: NHDPASVA
INTEGER(KIND=JPIM) :: NHDPASTD
INTEGER(KIND=JPIM) :: NHDPASFD
INTEGER(KIND=JPIM) :: NHDPASFP
INTEGER(KIND=JPIM) :: NHDPASTP
LOGICAL :: LHDQLN
LOGICAL :: LHDPAS
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_TSDDH
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TSDDH
PROCEDURE :: ACDC_HOST => ACDC_HOST_TSDDH
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TSDDH
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TSDDH
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TSDDH
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TSDDH
END TYPE TSDDH

!!TYPE(TSDDH), POINTER :: YRSDDH => NULL()

!     ------------------------------------------------------------------
INTERFACE

MODULE SUBROUTINE ACDC_COPY_TSDDH (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TSDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TSDDH (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TSDDH), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TSDDH (SELF)

IMPLICIT NONE
CLASS (TSDDH), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TSDDH (SELF, KLUN)

IMPLICIT NONE
CLASS (TSDDH), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TSDDH (SELF, KLUN)

IMPLICIT NONE
CLASS (TSDDH), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TSDDH (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TSDDH),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TSDDH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TSDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

END MODULE YOMSDDH
