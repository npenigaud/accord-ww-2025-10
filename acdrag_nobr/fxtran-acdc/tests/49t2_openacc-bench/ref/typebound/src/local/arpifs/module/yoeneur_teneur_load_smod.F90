SUBMODULE (YOENEUR) YOENEUR_TENEUR_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TENEUR (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TENEUR), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL4(4), IU4(4)
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) SELF%NCOU
READ (KLUN) SELF%NBR
READ (KLUN) SELF%NBNEURMAX
READ (KLUN) SELF%KLEV_NN
READ (KLUN) LNBNEUR
IF (LNBNEUR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NBNEUR (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NBNEUR
ENDIF
READ (KLUN) LWNELN
IF (LWNELN) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%WNELN (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%WNELN,1):UBOUND(SELF%WNELN,1), LBOUND(SELF%WNELN,2):UBOUND(SELF%WNELN,2), LBOUND(SELF%WNELN,3):UBOUND(SELF%WNELN,3), LBOUND(SELF%WNELN,4):UBOUND(SELF%WNELN,4)))
  READ (KLUN) ZTMP4
  SELF%WNELN = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LENTREEMOY
IF (LENTREEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%ENTREEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%ENTREEMOY,1):UBOUND(SELF%ENTREEMOY,1), LBOUND(SELF%ENTREEMOY,2):UBOUND(SELF%ENTREEMOY,2)))
  READ (KLUN) ZTMP2
  SELF%ENTREEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPIN
IF (LRAPIN) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RAPIN (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RAPIN,1):UBOUND(SELF%RAPIN,1), LBOUND(SELF%RAPIN,2):UBOUND(SELF%RAPIN,2)))
  READ (KLUN) ZTMP2
  SELF%RAPIN = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSORTIEMOY
IF (LSORTIEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SORTIEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SORTIEMOY,1):UBOUND(SELF%SORTIEMOY,1), LBOUND(SELF%SORTIEMOY,2):UBOUND(SELF%SORTIEMOY,2)))
  READ (KLUN) ZTMP2
  SELF%SORTIEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPOUT
IF (LRAPOUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RAPOUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RAPOUT,1):UBOUND(SELF%RAPOUT,1), LBOUND(SELF%RAPOUT,2):UBOUND(SELF%RAPOUT,2)))
  READ (KLUN) ZTMP2
  SELF%RAPOUT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LPDFSDX
IF (LPDFSDX) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%PDFSDX (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%PDFSDX,1):UBOUND(SELF%PDFSDX,1), LBOUND(SELF%PDFSDX,2):UBOUND(SELF%PDFSDX,2), LBOUND(SELF%PDFSDX,3):UBOUND(SELF%PDFSDX,3), LBOUND(SELF%PDFSDX,4):UBOUND(SELF%PDFSDX,4)))
  READ (KLUN) ZTMP4
  SELF%PDFSDX = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LAAM_NN
IF (LAAM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%AAM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%AAM_NN,1):UBOUND(SELF%AAM_NN,1)))
  READ (KLUN) ZTMP1
  SELF%AAM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LBBM_NN
IF (LBBM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%BBM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%BBM_NN,1):UBOUND(SELF%BBM_NN,1)))
  READ (KLUN) ZTMP1
  SELF%BBM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

END SUBMODULE
