MODULE YOENEUR

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

TYPE :: TENEUR
INTEGER(KIND=JPIM) :: NCOU, NBR, NBNEURMAX
INTEGER(KIND=JPIM) :: KLEV_NN

INTEGER(KIND=JPIM), ALLOCATABLE :: NBNEUR(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: WNELN(:,:,:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: ENTREEMOY(:,:), RAPIN(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: SORTIEMOY(:,:), RAPOUT(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: PDFSDX(:,:,:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: AAM_NN(:), BBM_NN(:)
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TENEUR
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TENEUR
PROCEDURE :: ACDC_HOST => ACDC_HOST_TENEUR
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TENEUR
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TENEUR
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TENEUR
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TENEUR
END TYPE TENEUR
!============================================================================

!!TYPE(TENEUR), POINTER :: YRENEUR => NULL()


INTERFACE

MODULE SUBROUTINE ACDC_COPY_TENEUR (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TENEUR), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TENEUR (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TENEUR), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TENEUR (SELF)

IMPLICIT NONE
CLASS (TENEUR), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TENEUR (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TENEUR), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TENEUR (SELF, KLUN)

IMPLICIT NONE
CLASS (TENEUR), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TENEUR (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TENEUR),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TENEUR (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TENEUR), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TENEUR), INTENT(IN) :: SELF
INTEGER      , INTENT(IN) :: KDEPTH
INTEGER      , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_rad%yreneur : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NCOU = ', SELF%NCOU
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBR = ', SELF%NBR
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBNEURMAX = ', SELF%NBNEURMAX
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'KLEV_NN = ', SELF%KLEV_NN
IF (ALLOCATED(SELF%NBNEUR)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBNEUR ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%NBNEUR), ' SUM ',SUM(SELF%NBNEUR)
IF (ALLOCATED(SELF%WNELN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'WNELN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%WNELN), ' SUM ',SUM(SELF%WNELN)
IF (ALLOCATED(SELF%ENTREEMOY)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTREEMOY ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%ENTREEMOY), ' SUM ',SUM(SELF%ENTREEMOY)
IF (ALLOCATED(SELF%RAPIN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAPIN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%RAPIN), ' SUM ',SUM(SELF%RAPIN)
IF (ALLOCATED(SELF%SORTIEMOY)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'SORTIEMOY ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%SORTIEMOY), ' SUM ',SUM(SELF%SORTIEMOY)
IF (ALLOCATED(SELF%RAPOUT)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAPOUT ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%RAPOUT), ' SUM ',SUM(SELF%RAPOUT)
IF (ALLOCATED(SELF%PDFSDX)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'PDFSDX ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%PDFSDX), ' SUM ',SUM(SELF%PDFSDX)
IF (ALLOCATED(SELF%AAM_NN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'AAM_NN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%AAM_NN), ' SUM ',SUM(SELF%AAM_NN)
IF (ALLOCATED(SELF%BBM_NN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'BBM_NN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%BBM_NN), ' SUM ',SUM(SELF%BBM_NN)

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOENEUR
