MODULE UTIL_TERDI_MOD

USE YOERDI, ONLY : TERDI

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TERDI
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TERDI
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TERDI
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TERDI
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TERDI
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TERDI
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TERDI
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TERDI (SELF, KLUN)

IMPLICIT NONE
TYPE (TERDI), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%RRAE
WRITE (KLUN) SELF%RSUNDUR
WRITE (KLUN) SELF%RCARDI
WRITE (KLUN) SELF%RCH4
WRITE (KLUN) SELF%RN2O
WRITE (KLUN) SELF%RNO2
WRITE (KLUN) SELF%RO3
WRITE (KLUN) SELF%RCCL4
WRITE (KLUN) SELF%RCFC11
WRITE (KLUN) SELF%RCFC12
WRITE (KLUN) SELF%RCFC22
WRITE (KLUN) SELF%REPCLC
WRITE (KLUN) SELF%REPH2O
WRITE (KLUN) SELF%RCCO2
WRITE (KLUN) SELF%RCCH4
WRITE (KLUN) SELF%RCN2O
WRITE (KLUN) SELF%RCNO2
WRITE (KLUN) SELF%RCCFC11
WRITE (KLUN) SELF%RCCFC12
WRITE (KLUN) SELF%RCCFC22
WRITE (KLUN) SELF%RCCCL4
WRITE (KLUN) SELF%RSOLINC
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TERDI (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TERDI), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) ZTMP0
SELF%RRAE = ZTMP0
READ (KLUN) ZTMP0
SELF%RSUNDUR = ZTMP0
READ (KLUN) ZTMP0
SELF%RCARDI = ZTMP0
READ (KLUN) ZTMP0
SELF%RCH4 = ZTMP0
READ (KLUN) ZTMP0
SELF%RN2O = ZTMP0
READ (KLUN) ZTMP0
SELF%RNO2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RO3 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCL4 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCFC11 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCFC12 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCFC22 = ZTMP0
READ (KLUN) ZTMP0
SELF%REPCLC = ZTMP0
READ (KLUN) ZTMP0
SELF%REPH2O = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCO2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCH4 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCN2O = ZTMP0
READ (KLUN) ZTMP0
SELF%RCNO2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCFC11 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCFC12 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCFC22 = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCCL4 = ZTMP0
READ (KLUN) ZTMP0
SELF%RSOLINC = ZTMP0
END SUBROUTINE

SUBROUTINE ACDC_COPY_TERDI (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TERDI), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TERDI (SELF)

IMPLICIT NONE
TYPE (TERDI), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TERDI (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TERDI), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RRAE), CDPATH//'%RRAE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSUNDUR), CDPATH//'%RSUNDUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCARDI), CDPATH//'%RCARDI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCH4), CDPATH//'%RCH4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RN2O), CDPATH//'%RN2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RNO2), CDPATH//'%RNO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RO3), CDPATH//'%RO3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCL4), CDPATH//'%RCCL4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCFC11), CDPATH//'%RCFC11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCFC12), CDPATH//'%RCFC12'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCFC22), CDPATH//'%RCFC22'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%REPCLC), CDPATH//'%REPCLC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%REPH2O), CDPATH//'%REPH2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCO2), CDPATH//'%RCCO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCH4), CDPATH//'%RCCH4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCN2O), CDPATH//'%RCN2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCNO2), CDPATH//'%RCNO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCFC11), CDPATH//'%RCCFC11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCFC12), CDPATH//'%RCCFC12'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCFC22), CDPATH//'%RCCFC22'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCCL4), CDPATH//'%RCCCL4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSOLINC), CDPATH//'%RSOLINC'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TERDI (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TERDI), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TERDI (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TERDI),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%RRAE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRAE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSUNDUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSUNDUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCARDI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCARDI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCH4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RN2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RN2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RNO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RO3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RO3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCL4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCL4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCFC11)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC11'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCFC12)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC12'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCFC22)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC22'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%REPCLC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REPCLC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%REPH2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REPH2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCH4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCN2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCN2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCNO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCNO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCFC11)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC11'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCFC12)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC12'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCFC22)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC22'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCCL4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCCL4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSOLINC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSOLINC'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
