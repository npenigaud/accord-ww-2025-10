MODULE UTIL_TYPE_AERO_DESC_MOD

USE YOEAERATM, ONLY : TYPE_AERO_DESC

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TYPE_AERO_DESC
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TYPE_AERO_DESC
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TYPE_AERO_DESC
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TYPE_AERO_DESC
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TYPE_AERO_DESC
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TYPE_AERO_DESC
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TYPE_AERO_DESC
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TYPE_AERO_DESC (SELF, KLUN)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%CNAME
WRITE (KLUN) SELF%IGRBCODE
WRITE (KLUN) SELF%NTYP
WRITE (KLUN) SELF%NBIN
WRITE (KLUN) SELF%IGRIBDIAG
WRITE (KLUN) SELF%RDDEPVSEA
WRITE (KLUN) SELF%RDDEPVLIC
WRITE (KLUN) SELF%RSEDIMV
WRITE (KLUN) SELF%RSCAVIN
WRITE (KLUN) SELF%RSCAVBCR
WRITE (KLUN) SELF%RSCAVBCS
WRITE (KLUN) SELF%COPTCLASS
WRITE (KLUN) SELF%CHYGCLASS
WRITE (KLUN) SELF%IAEROCV
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TYPE_AERO_DESC (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%CNAME
READ (KLUN) SELF%IGRBCODE
READ (KLUN) SELF%NTYP
READ (KLUN) SELF%NBIN
READ (KLUN) SELF%IGRIBDIAG
READ (KLUN) ZTMP0
SELF%RDDEPVSEA = ZTMP0
READ (KLUN) ZTMP0
SELF%RDDEPVLIC = ZTMP0
READ (KLUN) ZTMP0
SELF%RSEDIMV = ZTMP0
READ (KLUN) ZTMP0
SELF%RSCAVIN = ZTMP0
READ (KLUN) ZTMP0
SELF%RSCAVBCR = ZTMP0
READ (KLUN) ZTMP0
SELF%RSCAVBCS = ZTMP0
READ (KLUN) SELF%COPTCLASS
READ (KLUN) SELF%CHYGCLASS
READ (KLUN) SELF%IAEROCV
END SUBROUTINE

SUBROUTINE ACDC_COPY_TYPE_AERO_DESC (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TYPE_AERO_DESC (SELF)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TYPE_AERO_DESC (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TYPE_AERO_DESC), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CNAME), CDPATH//'%CNAME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IGRBCODE), CDPATH//'%IGRBCODE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTYP), CDPATH//'%NTYP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBIN), CDPATH//'%NBIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IGRIBDIAG), CDPATH//'%IGRIBDIAG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDDEPVSEA), CDPATH//'%RDDEPVSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDDEPVLIC), CDPATH//'%RDDEPVLIC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSEDIMV), CDPATH//'%RSEDIMV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSCAVIN), CDPATH//'%RSCAVIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSCAVBCR), CDPATH//'%RSCAVBCR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSCAVBCS), CDPATH//'%RSCAVBCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%COPTCLASS), CDPATH//'%COPTCLASS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CHYGCLASS), CDPATH//'%CHYGCLASS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IAEROCV), CDPATH//'%IAEROCV'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TYPE_AERO_DESC (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TYPE_AERO_DESC (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%CNAME) * LEN (SELF%CNAME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CNAME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IGRBCODE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IGRBCODE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTYP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTYP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NBIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IGRIBDIAG) * SIZE (SELF%IGRIBDIAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IGRIBDIAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDDEPVSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDDEPVSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDDEPVLIC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDDEPVLIC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSEDIMV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSEDIMV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSCAVIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSCAVBCR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVBCR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSCAVBCS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVBCS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%COPTCLASS) * LEN (SELF%COPTCLASS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%COPTCLASS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CHYGCLASS) * LEN (SELF%CHYGCLASS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHYGCLASS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IAEROCV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IAEROCV'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
