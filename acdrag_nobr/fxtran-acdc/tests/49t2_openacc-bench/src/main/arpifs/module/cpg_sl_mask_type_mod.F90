MODULE CPG_SL_MASK_TYPE_MOD

!$ACDC methods --methods-list=host,wipe,copy --skip-components cpg --field-api --field-api-class cpg


USE PARKIND1, ONLY : JPIM
USE FIELD_MODULE, ONLY : FIELD_1IM

IMPLICIT NONE

TYPE CPG_SL_MASK_TYPE
  CLASS (FIELD_1IM), POINTER :: F_P => NULL ()
  INTEGER (KIND=JPIM), POINTER :: P (:) => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_SL_MASK_TYPE_INIT
  PROCEDURE :: FINAL => CPG_SL_MASK_TYPE_FINAL
END TYPE CPG_SL_MASK_TYPE

CONTAINS

SUBROUTINE CPG_SL_MASK_TYPE_INIT (SELF, YDSL, KMASK_SL)

USE FIELD_FACTORY_MODULE
USE EINT_MOD, ONLY : SL_STRUCT

CLASS (CPG_SL_MASK_TYPE) :: SELF
TYPE (SL_STRUCT), INTENT (IN) :: YDSL
INTEGER (KIND=JPIM), TARGET, INTENT (IN) :: KMASK_SL (:)

SELF%P => KMASK_SL

CALL FIELD_NEW (SELF%F_P, DATA=SELF%P, PERSISTENT=.TRUE.)

END SUBROUTINE CPG_SL_MASK_TYPE_INIT

SUBROUTINE CPG_SL_MASK_TYPE_FINAL (SELF)

USE FIELD_FACTORY_MODULE

CLASS (CPG_SL_MASK_TYPE) :: SELF

CALL FIELD_DELETE (SELF%F_P)
NULLIFY (SELF%P)

END SUBROUTINE CPG_SL_MASK_TYPE_FINAL

END MODULE CPG_SL_MASK_TYPE_MOD

