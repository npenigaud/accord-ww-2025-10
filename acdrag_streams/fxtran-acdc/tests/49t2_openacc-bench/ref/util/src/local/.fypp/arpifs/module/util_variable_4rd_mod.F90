MODULE UTIL_VARIABLE_4RD_MOD

USE VARIABLE_MODULE, ONLY : VARIABLE_4RD



INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_VARIABLE_4RD
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_VARIABLE_4RD
END INTERFACE

INTERFACE ACDC_LEGACY
MODULE PROCEDURE ACDC_LEGACY_VARIABLE_4RD
END INTERFACE

INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_VARIABLE_4RD
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_VARIABLE_4RD
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_VARIABLE_4RD
END INTERFACE

CONTAINS





SUBROUTINE ACDC_COPY_VARIABLE_4RD (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_copy_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
YLSUPER => SELF
CALL ACDC_COPY_VARIABLE_BASE (YLSUPER, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FT0)
  !$ACC ENTER DATA ATTACH (SELF%FT0)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FT1)
  !$ACC ENTER DATA ATTACH (SELF%FT1)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FT9)
  !$ACC ENTER DATA ATTACH (SELF%FT9)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FPH9)
  !$ACC ENTER DATA ATTACH (SELF%FPH9)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FDL)
  !$ACC ENTER DATA ATTACH (SELF%FDL)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FDM)
  !$ACC ENTER DATA ATTACH (SELF%FDM)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FDL9)
  !$ACC ENTER DATA ATTACH (SELF%FDL9)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FDM9)
  !$ACC ENTER DATA ATTACH (SELF%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (SELF%FPC_PH)
  !$ACC ENTER DATA ATTACH (SELF%FPC_PH)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_VARIABLE_4RD (SELF)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_host_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: SELF
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => SELF
CALL ACDC_HOST_VARIABLE_BASE (YLSUPER)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0) THEN
  CALL HOST_FIELD_4RD (SELF%FT0)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1) THEN
  CALL HOST_FIELD_4RD (SELF%FT1)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9) THEN
  CALL HOST_FIELD_4RD (SELF%FT9)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9) THEN
  CALL HOST_FIELD_4RD (SELF%FPH9)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL) THEN
  CALL HOST_FIELD_4RD (SELF%FDL)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM) THEN
  CALL HOST_FIELD_4RD (SELF%FDM)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9) THEN
  CALL HOST_FIELD_4RD (SELF%FDL9)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9) THEN
  CALL HOST_FIELD_4RD (SELF%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH) THEN
  CALL HOST_FIELD_4RD (SELF%FPC_PH)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_LEGACY_VARIABLE_4RD (SELF, KADDRL, KADDRU, KDIR)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_legacy_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: SELF
INTEGER*8, INTENT (IN) :: KADDRL
INTEGER*8, INTENT (IN) :: KADDRU
INTEGER, INTENT (IN) :: KDIR
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => SELF
CALL ACDC_LEGACY_VARIABLE_BASE (YLSUPER, KADDRL, KADDRU, KDIR=KDIR)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0) THEN
  CALL LEGACY_FIELD_4RD (SELF%FT0, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1) THEN
  CALL LEGACY_FIELD_4RD (SELF%FT1, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9) THEN
  CALL LEGACY_FIELD_4RD (SELF%FT9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9) THEN
  CALL LEGACY_FIELD_4RD (SELF%FPH9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL) THEN
  CALL LEGACY_FIELD_4RD (SELF%FDL, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM) THEN
  CALL LEGACY_FIELD_4RD (SELF%FDM, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9) THEN
  CALL LEGACY_FIELD_4RD (SELF%FDL9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9) THEN
  CALL LEGACY_FIELD_4RD (SELF%FDM9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH) THEN
  CALL LEGACY_FIELD_4RD (SELF%FPC_PH, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_CRC64_VARIABLE_4RD (SELF, KLUN, CDPATH)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_crc64_VARIABLE_BASE
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => SELF
CALL ACDC_CRC64_VARIABLE_BASE (YLSUPER, KLUN, CDPATH)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FT0%CRC64 (), CDPATH//'%FT0'//TRIM(CLIND)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FT1%CRC64 (), CDPATH//'%FT1'//TRIM(CLIND)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FT9%CRC64 (), CDPATH//'%FT9'//TRIM(CLIND)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FPH9%CRC64 (), CDPATH//'%FPH9'//TRIM(CLIND)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FDL%CRC64 (), CDPATH//'%FDL'//TRIM(CLIND)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FDM%CRC64 (), CDPATH//'%FDM'//TRIM(CLIND)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FDL9%CRC64 (), CDPATH//'%FDL9'//TRIM(CLIND)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FDM9%CRC64 (), CDPATH//'%FDM9'//TRIM(CLIND)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') SELF%FPC_PH%CRC64 (), CDPATH//'%FPC_PH'//TRIM(CLIND)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_WIPE_VARIABLE_4RD (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_wipe_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
YLSUPER => SELF
CALL ACDC_WIPE_VARIABLE_BASE (YLSUPER, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FT0)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FT1)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FT9)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FPH9)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FDL)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FDM)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FDL9)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (SELF%FPC_PH)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_VARIABLE_4RD (SELF, CDPATH, LDPRINT) RESULT (KSIZE)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, ACDC_size_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
YLSUPER => SELF
KSIZE = KSIZE + ACDC_SIZE_VARIABLE_BASE (YLSUPER, CLPATH, LLPRINT)
END FUNCTION

END MODULE
