MODULE UTIL_TSPP_CONFIG_MOD

USE SPP_MOD, ONLY : TSPP_CONFIG

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TSPP_CONFIG
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TSPP_CONFIG
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TSPP_CONFIG
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TSPP_CONFIG
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TSPP_CONFIG
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TSPP_CONFIG
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TSPP_CONFIG
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TSPP_CONFIG (SELF, KLUN)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
IMPLICIT NONE
TYPE (TSPP_CONFIG), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%LSPP
WRITE (KLUN) SELF%CSPP_MODEL_NAME
CALL ACDC_SAVE_SPP_MODEL (SELF%SM, KLUN)
CALL ACDC_SAVE_SPP_PERT_POINTER (SELF%PPTR, KLUN)
WRITE (KLUN) SELF%LRAMIDLIMIT1
WRITE (KLUN) SELF%LUSE_SETRAN
WRITE (KLUN) SELF%LNSEED_OFFS0
WRITE (KLUN) SELF%LRDPATINIT
WRITE (KLUN) SELF%LWRPATTRUN
WRITE (KLUN) SELF%NWRPATTRUN
WRITE (KLUN) SELF%NHOUR_PATTRUN
WRITE (KLUN) SELF%NSTEP_PATTRUN
WRITE (KLUN) SELF%LRESETSEED
WRITE (KLUN) SELF%LABSTIMSEED
WRITE (KLUN) SELF%RESETSEEDFRQ
WRITE (KLUN) SELF%SHIFTSEED
WRITE (KLUN) SELF%SPP_RDPATINIT
WRITE (KLUN) SELF%SPP_WRPATTRUN
WRITE (KLUN) SELF%ISEEDFAC
WRITE (KLUN) SELF%IEZDIAG_POS
WRITE (KLUN) SELF%NPATFR
WRITE (KLUN) SELF%XPRESS_PHR_ST
WRITE (KLUN) SELF%LSPG_SPP
WRITE (KLUN) SELF%SPGMU
WRITE (KLUN) SELF%SPGLAMBDA
WRITE (KLUN) SELF%SPGSIGMA
WRITE (KLUN) SELF%SPGQ
WRITE (KLUN) SELF%SPGADTMIN
WRITE (KLUN) SELF%SPGADTMAX
WRITE (KLUN) SELF%SPGTDT
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TSPP_CONFIG (SELF, KLUN)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TSPP_CONFIG), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%LSPP
READ (KLUN) SELF%CSPP_MODEL_NAME
CALL ACDC_LOAD_SPP_MODEL (SELF%SM, KLUN)
CALL ACDC_LOAD_SPP_PERT_POINTER (SELF%PPTR, KLUN)
READ (KLUN) SELF%LRAMIDLIMIT1
READ (KLUN) SELF%LUSE_SETRAN
READ (KLUN) SELF%LNSEED_OFFS0
READ (KLUN) SELF%LRDPATINIT
READ (KLUN) SELF%LWRPATTRUN
READ (KLUN) SELF%NWRPATTRUN
READ (KLUN) SELF%NHOUR_PATTRUN
READ (KLUN) SELF%NSTEP_PATTRUN
READ (KLUN) SELF%LRESETSEED
READ (KLUN) SELF%LABSTIMSEED
READ (KLUN) SELF%RESETSEEDFRQ
READ (KLUN) SELF%SHIFTSEED
READ (KLUN) SELF%SPP_RDPATINIT
READ (KLUN) SELF%SPP_WRPATTRUN
READ (KLUN) SELF%ISEEDFAC
READ (KLUN) SELF%IEZDIAG_POS
READ (KLUN) SELF%NPATFR
READ (KLUN) ZTMP0
SELF%XPRESS_PHR_ST = ZTMP0
READ (KLUN) SELF%LSPG_SPP
READ (KLUN) ZTMP0
SELF%SPGMU = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGLAMBDA = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGSIGMA = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGQ = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGADTMIN = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGADTMAX = ZTMP0
READ (KLUN) ZTMP0
SELF%SPGTDT = ZTMP0
END SUBROUTINE

SUBROUTINE ACDC_COPY_TSPP_CONFIG (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
IMPLICIT NONE
TYPE (TSPP_CONFIG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

CALL ACDC_COPY_SPP_MODEL (SELF%SM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_SPP_PERT_POINTER (SELF%PPTR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

END SUBROUTINE

SUBROUTINE ACDC_HOST_TSPP_CONFIG (SELF)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
IMPLICIT NONE
TYPE (TSPP_CONFIG), TARGET :: SELF


CALL ACDC_HOST_SPP_MODEL (SELF%SM)

CALL ACDC_HOST_SPP_PERT_POINTER (SELF%PPTR)

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TSPP_CONFIG (SELF, KLUN, CDPATH)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TSPP_CONFIG), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSPP), CDPATH//'%LSPP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CSPP_MODEL_NAME), CDPATH//'%CSPP_MODEL_NAME'

CLIND = ''
CALL ACDC_CRC64_SPP_MODEL (SELF%SM, KLUN, CDPATH//'%SM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_SPP_PERT_POINTER (SELF%PPTR, KLUN, CDPATH//'%PPTR'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRAMIDLIMIT1), CDPATH//'%LRAMIDLIMIT1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LUSE_SETRAN), CDPATH//'%LUSE_SETRAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LNSEED_OFFS0), CDPATH//'%LNSEED_OFFS0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRDPATINIT), CDPATH//'%LRDPATINIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWRPATTRUN), CDPATH//'%LWRPATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NWRPATTRUN), CDPATH//'%NWRPATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NHOUR_PATTRUN), CDPATH//'%NHOUR_PATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSTEP_PATTRUN), CDPATH//'%NSTEP_PATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRESETSEED), CDPATH//'%LRESETSEED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LABSTIMSEED), CDPATH//'%LABSTIMSEED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RESETSEEDFRQ), CDPATH//'%RESETSEEDFRQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SHIFTSEED), CDPATH//'%SHIFTSEED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPP_RDPATINIT), CDPATH//'%SPP_RDPATINIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPP_WRPATTRUN), CDPATH//'%SPP_WRPATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ISEEDFAC), CDPATH//'%ISEEDFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IEZDIAG_POS), CDPATH//'%IEZDIAG_POS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NPATFR), CDPATH//'%NPATFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XPRESS_PHR_ST), CDPATH//'%XPRESS_PHR_ST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSPG_SPP), CDPATH//'%LSPG_SPP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGMU), CDPATH//'%SPGMU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGLAMBDA), CDPATH//'%SPGLAMBDA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGSIGMA), CDPATH//'%SPGSIGMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGQ), CDPATH//'%SPGQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGADTMIN), CDPATH//'%SPGADTMIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGADTMAX), CDPATH//'%SPGADTMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPGTDT), CDPATH//'%SPGTDT'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TSPP_CONFIG (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
IMPLICIT NONE
TYPE (TSPP_CONFIG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

CALL ACDC_WIPE_SPP_MODEL (SELF%SM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_SPP_PERT_POINTER (SELF%PPTR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TSPP_CONFIG (SELF, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_SPP_MODEL_MOD
USE UTIL_SPP_PERT_POINTER_MOD
IMPLICIT NONE
TYPE (TSPP_CONFIG),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LSPP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CSPP_MODEL_NAME) * LEN (SELF%CSPP_MODEL_NAME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSPP_MODEL_NAME'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = ACDC_SIZE_SPP_MODEL (SELF%SM, CLPATH//'%SM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%SM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_SPP_PERT_POINTER (SELF%PPTR, CLPATH//'%PPTR', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%PPTR'
ENDIF
ISIZE = KIND (SELF%LRAMIDLIMIT1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAMIDLIMIT1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LUSE_SETRAN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LUSE_SETRAN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LNSEED_OFFS0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNSEED_OFFS0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRDPATINIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDPATINIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWRPATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWRPATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NWRPATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWRPATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NHOUR_PATTRUN) * SIZE (SELF%NHOUR_PATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NHOUR_PATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSTEP_PATTRUN) * SIZE (SELF%NSTEP_PATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTEP_PATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRESETSEED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRESETSEED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LABSTIMSEED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LABSTIMSEED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RESETSEEDFRQ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RESETSEEDFRQ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SHIFTSEED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SHIFTSEED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPP_RDPATINIT) * LEN (SELF%SPP_RDPATINIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPP_RDPATINIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPP_WRPATTRUN) * LEN (SELF%SPP_WRPATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPP_WRPATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ISEEDFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ISEEDFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IEZDIAG_POS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IEZDIAG_POS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NPATFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPATFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XPRESS_PHR_ST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XPRESS_PHR_ST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LSPG_SPP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPG_SPP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGMU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGMU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGLAMBDA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGLAMBDA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGSIGMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGSIGMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGQ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGQ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGADTMIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGADTMIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGADTMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGADTMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SPGTDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SPGTDT'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
