MODULE CPG_DDH_TND_TYPE_MOD

!$ACDC methods --methods-list=host,wipe,copy --skip-components cpg --field-api --field-api-class cpg


USE YOMMDDH,  ONLY : TMDDH
USE YOMGPDDH, ONLY : TGPDDH
USE FIELD_MODULE
USE VARIABLE_MODULE
USE FIELD_FACTORY_MODULE

IMPLICIT NONE


ABSTRACT INTERFACE 
  LOGICAL FUNCTION FUN_GREP (YDCOMP)
    USE YOM_YGFL, ONLY : TYPE_GFL_COMP
    TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
  END FUNCTION
END INTERFACE

PRIVATE :: FUN_GREP, GREPVARS

TYPE CPG_TNDSI_DDH_TYPE
  REAL (KIND=JPRB), POINTER :: ZDATA_GMV (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW_GMV (:,:,:) => NULL ()

  TYPE (VARIABLE_3RB) :: U
  TYPE (VARIABLE_3RB) :: V
  TYPE (VARIABLE_3RB) :: T
  TYPE (VARIABLE_3RB) :: PD
  TYPE (VARIABLE_3RB) :: VD
CONTAINS
  PROCEDURE :: INIT => CPG_TNDSI_DDH_TYPE_INIT
  PROCEDURE :: FINAL => CPG_TNDSI_DDH_TYPE_FINAL
  PROCEDURE :: UPDATE_VIEW => CPG_TNDSI_DDH_TYPE_UPDATE_VIEW
END TYPE CPG_TNDSI_DDH_TYPE


TYPE CPG_TNDHD_DDH_TYPE
  REAL (KIND=JPRB), POINTER :: ZDATA_GMV (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW_GMV (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER :: ZDATA_GFL (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW_GFL (:,:,:) => NULL ()

  CLASS (FIELD_3RB), POINTER :: F_U => NULL ()
  REAL (KIND=JPRB), POINTER :: U (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_V => NULL ()
  REAL (KIND=JPRB), POINTER :: V (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_T => NULL ()
  REAL (KIND=JPRB), POINTER :: T (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_PD => NULL ()
  REAL (KIND=JPRB), POINTER :: PD (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VD => NULL ()
  REAL (KIND=JPRB), POINTER :: VD (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_NHX => NULL ()
  REAL (KIND=JPRB), POINTER :: NHX (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_Q => NULL ()
  REAL (KIND=JPRB), POINTER :: Q (:,:) => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_TNDHD_DDH_TYPE_INIT
  PROCEDURE :: FINAL => CPG_TNDHD_DDH_TYPE_FINAL
  PROCEDURE :: UPDATE_VIEW => CPG_TNDHD_DDH_TYPE_UPDATE_VIEW
END TYPE CPG_TNDHD_DDH_TYPE



TYPE CPG_TNDSL_DDH_3D_TYPE
  CLASS (FIELD_3RB), POINTER :: F_P => NULL ()
  REAL (KIND=JPRB), POINTER :: P (:,:) => NULL ()
END TYPE CPG_TNDSL_DDH_3D_TYPE

TYPE CPG_TNDSL_DDH_TYPE
  REAL (KIND=JPRB), POINTER :: ZDATA_GMV (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW_GMV (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER :: ZDATA_GFL (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW_GFL (:,:,:) => NULL ()

  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: U 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: V 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: T 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: PD 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: VD 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: NHX 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: Q 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: I 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: L 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: IMF 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: LMF 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: LCONV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: ICONV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: RCONV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: SCONV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: IRAD 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: LRAD 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: S 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: R 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: G 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: H 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: TKE 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: TTE 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: EFB1 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: EFB2 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: EFB3 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: A 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: AMF 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: O3 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: SRC 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: MXL 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: SHTUR 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: FQTUR 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: FSTUR 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: CPF 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: SPF 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: CVGQ 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: QVA 
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: GHG (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: CHEM (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: AERO (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: LRCH4 
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: FORC (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: EZDIAG (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: ERA40 (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: NOGW (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: EMIS3D (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: EDRP (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: SLDIA (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: AERAOT (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: AERLISI (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: AEROUT (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: AEROCLIM (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: UVP (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: PHYCTY 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: RSPEC 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: SDSAT 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: CVV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: RKTH 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: RKTQV 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: RKTQC 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: UOM 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: UAL 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: DOM 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: DAL 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: UEN 
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: UNEBH 
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: LIMA (:)
  TYPE (CPG_TNDSL_DDH_3D_TYPE) :: FSD 
  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: EXT (:)

  TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: GFL (:)

CONTAINS
  PROCEDURE :: INIT => CPG_TNDSL_DDH_TYPE_INIT
  PROCEDURE :: FINAL => CPG_TNDSL_DDH_TYPE_FINAL
  PROCEDURE :: UPDATE_VIEW => CPG_TNDSL_DDH_TYPE_UPDATE_VIEW
END TYPE CPG_TNDSL_DDH_TYPE

TYPE CPG_DDH_TND_TYPE
  TYPE (CPG_TNDSI_DDH_TYPE) :: YSI
  TYPE (CPG_TNDHD_DDH_TYPE) :: YHD
  TYPE (CPG_TNDSL_DDH_TYPE) :: YSL
CONTAINS
  PROCEDURE :: INIT => CPG_DDH_TND_TYPE_INIT
  PROCEDURE :: FINAL => CPG_DDH_TND_TYPE_FINAL
  PROCEDURE :: UPDATE_VIEW => CPG_DDH_TND_TYPE_UPDATE_VIEW
END TYPE CPG_DDH_TND_TYPE

CONTAINS

SUBROUTINE GREPVARS (YDCPG_TNDSL_DDH, COND, YGFL, YDVARS_LIST)
USE YOM_YGFL, ONLY: TYPE_GFLD
TYPE(CPG_TNDSL_DDH_TYPE), INTENT(INOUT) :: YDCPG_TNDSL_DDH
TYPE(TYPE_GFLD), INTENT(IN) :: YGFL
PROCEDURE (FUN_GREP) :: COND
TYPE (CPG_TNDSL_DDH_3D_TYPE), ALLOCATABLE :: YDVARS_LIST (:)

INTEGER (KIND=JPIM) :: ISIZE, JFLD, IPNTR

ISIZE = 0

IF (COND (YGFL%YQ)) ISIZE = ISIZE + 1
IF (COND (YGFL%YI)) ISIZE = ISIZE + 1
IF (COND (YGFL%YL)) ISIZE = ISIZE + 1
IF (COND (YGFL%YIMF)) ISIZE = ISIZE + 1
IF (COND (YGFL%YLMF)) ISIZE = ISIZE + 1
IF (COND (YGFL%YLCONV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YICONV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YRCONV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YSCONV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YIRAD)) ISIZE = ISIZE + 1
IF (COND (YGFL%YLRAD)) ISIZE = ISIZE + 1
IF (COND (YGFL%YS)) ISIZE = ISIZE + 1
IF (COND (YGFL%YR)) ISIZE = ISIZE + 1
IF (COND (YGFL%YG)) ISIZE = ISIZE + 1
IF (COND (YGFL%YH)) ISIZE = ISIZE + 1
IF (COND (YGFL%YTKE)) ISIZE = ISIZE + 1
IF (COND (YGFL%YTTE)) ISIZE = ISIZE + 1
IF (COND (YGFL%YEFB1)) ISIZE = ISIZE + 1
IF (COND (YGFL%YEFB2)) ISIZE = ISIZE + 1
IF (COND (YGFL%YEFB3)) ISIZE = ISIZE + 1
IF (COND (YGFL%YA)) ISIZE = ISIZE + 1
IF (COND (YGFL%YAMF)) ISIZE = ISIZE + 1
IF (COND (YGFL%YO3)) ISIZE = ISIZE + 1
IF (COND (YGFL%YSRC)) ISIZE = ISIZE + 1
IF (COND (YGFL%YMXL)) ISIZE = ISIZE + 1
IF (COND (YGFL%YSHTUR)) ISIZE = ISIZE + 1
IF (COND (YGFL%YFQTUR)) ISIZE = ISIZE + 1
IF (COND (YGFL%YFSTUR)) ISIZE = ISIZE + 1
IF (COND (YGFL%YCPF)) ISIZE = ISIZE + 1
IF (COND (YGFL%YSPF)) ISIZE = ISIZE + 1
IF (COND (YGFL%YCVGQ)) ISIZE = ISIZE + 1
IF (COND (YGFL%YQVA)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_TNDSL_DDH%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%GHG)
    IF (COND (YGFL%YGHG(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%CHEM)
    IF (COND (YGFL%YCHEM(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERO)
    IF (COND (YGFL%YAERO(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YGFL%YLRCH4)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_TNDSL_DDH%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%FORC)
    IF (COND (YGFL%YFORC(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EZDIAG)
    IF (COND (YGFL%YEZDIAG(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%ERA40)
    IF (COND (YGFL%YERA40(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%NOGW)
    IF (COND (YGFL%YNOGW(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EMIS3D)
    IF (COND (YGFL%YEMIS3D(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EDRP)
    IF (COND (YGFL%YEDRP(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%SLDIA)
    IF (COND (YGFL%YSLDIA(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERAOT)
    IF (COND (YGFL%YAERAOT(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERLISI)
    IF (COND (YGFL%YAERLISI(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AEROUT)
    IF (COND (YGFL%YAEROUT(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AEROCLIM)
    IF (COND (YGFL%YAEROCLIM(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%UVP)
    IF (COND (YGFL%YUVP(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YGFL%YPHYCTY)) ISIZE = ISIZE + 1
IF (COND (YGFL%YRSPEC)) ISIZE = ISIZE + 1
IF (COND (YGFL%YSDSAT)) ISIZE = ISIZE + 1
IF (COND (YGFL%YCVV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YRKTH)) ISIZE = ISIZE + 1
IF (COND (YGFL%YRKTQV)) ISIZE = ISIZE + 1
IF (COND (YGFL%YRKTQC)) ISIZE = ISIZE + 1
IF (COND (YGFL%YUOM)) ISIZE = ISIZE + 1
IF (COND (YGFL%YUAL)) ISIZE = ISIZE + 1
IF (COND (YGFL%YDOM)) ISIZE = ISIZE + 1
IF (COND (YGFL%YDAL)) ISIZE = ISIZE + 1
IF (COND (YGFL%YUEN)) ISIZE = ISIZE + 1
IF (COND (YGFL%YUNEBH)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_TNDSL_DDH%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%LIMA)
    IF (COND (YGFL%YLIMA(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YGFL%YFSD)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_TNDSL_DDH%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EXT)
    IF (COND (YGFL%YEXT(JFLD))) ISIZE = ISIZE + 1
  ENDDO
ENDIF

ALLOCATE (YDVARS_LIST (ISIZE))

IPNTR = 1

IF (COND (YGFL%YQ)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%Q
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YI)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%I
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%L
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YIMF)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%IMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YLMF)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%LMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YLCONV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%LCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YICONV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%ICONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YRCONV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%RCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YSCONV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YIRAD)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%IRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YLRAD)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%LRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YS)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%S
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YR)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%R
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YG)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%G
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YH)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%H
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YTKE)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%TKE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YTTE)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%TTE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YEFB1)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EFB1
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YEFB2)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EFB2
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YEFB3)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EFB3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YA)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%A
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YAMF)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YO3)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%O3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YSRC)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SRC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YMXL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%MXL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YSHTUR)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SHTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YFQTUR)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%FQTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YFSTUR)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%FSTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YCPF)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%CPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YSPF)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YCVGQ)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%CVGQ
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YQVA)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%QVA
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%GHG)
    IF (COND (YGFL%YGHG(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%GHG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%CHEM)
    IF (COND (YGFL%YCHEM(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%CHEM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERO)
    IF (COND (YGFL%YAERO(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AERO(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YGFL%YLRCH4)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%LRCH4
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%FORC)
    IF (COND (YGFL%YFORC(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%FORC(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EZDIAG)
    IF (COND (YGFL%YEZDIAG(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EZDIAG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%ERA40)
    IF (COND (YGFL%YERA40(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%ERA40(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%NOGW)
    IF (COND (YGFL%YNOGW(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%NOGW(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EMIS3D)
    IF (COND (YGFL%YEMIS3D(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EMIS3D(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EDRP)
    IF (COND (YGFL%YEDRP(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EDRP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%SLDIA)
    IF (COND (YGFL%YSLDIA(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SLDIA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERAOT)
    IF (COND (YGFL%YAERAOT(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AERAOT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AERLISI)
    IF (COND (YGFL%YAERLISI(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AERLISI(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AEROUT)
    IF (COND (YGFL%YAEROUT(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AEROUT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%AEROCLIM)
    IF (COND (YGFL%YAEROCLIM(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%AEROCLIM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%UVP)
    IF (COND (YGFL%YUVP(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%UVP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YGFL%YPHYCTY)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%PHYCTY
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YRSPEC)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%RSPEC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YSDSAT)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%SDSAT
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YCVV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%CVV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YRKTH)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%RKTH
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YRKTQV)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%RKTQV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YRKTQC)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%RKTQC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YUOM)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%UOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YUAL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%UAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YDOM)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%DOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YDAL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%DAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YUEN)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%UEN
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YGFL%YUNEBH)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%UNEBH
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%LIMA)
    IF (COND (YGFL%YLIMA(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%LIMA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YGFL%YFSD)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%FSD
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_TNDSL_DDH%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_TNDSL_DDH%EXT)
    IF (COND (YGFL%YEXT(JFLD))) THEN
      YDVARS_LIST (IPNTR) = YDCPG_TNDSL_DDH%EXT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
    
END SUBROUTINE

SUBROUTINE CPG_TNDSI_DDH_TYPE_INIT (SELF, YDMDDH, YDGPDDH)

CLASS (CPG_TNDSI_DDH_TYPE) :: SELF
TYPE (TMDDH),     INTENT (IN)         :: YDMDDH
TYPE (TGPDDH),    INTENT (IN), TARGET :: YDGPDDH

LOGICAL :: LLT0, LLT1, LLT9

IF (ALLOCATED (YDGPDDH%GMVTNDSI_DDH)) THEN

  SELF%ZDATA_GMV => YDGPDDH%GMVTNDSI_DDH

  LLT0 = YDMDDH%MSIDDH_U0 > 0
  LLT1 = YDMDDH%MSIDDH_U1 > 0
  LLT9 = YDMDDH%MSIDDH_U9 > 0
  SELF%U = VARIABLE_3RB ("U", LACTIVE=.TRUE., LT1=LLT1, LT9=LLT9)
  IF (LLT0) THEN
    CALL FIELD_NEW (SELF%U%FT0, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_U0,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%U%FT0 => NULL ()
  ENDIF
  IF (LLT1) THEN
    CALL FIELD_NEW (SELF%U%FT1, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_U1,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%U%FT1 => NULL ()
  ENDIF
  IF (LLT9) THEN
    CALL FIELD_NEW (SELF%U%FT9, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_U9,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%U%FT9 => NULL ()
  ENDIF
  LLT0 = YDMDDH%MSIDDH_V0 > 0
  LLT1 = YDMDDH%MSIDDH_V1 > 0
  LLT9 = YDMDDH%MSIDDH_V9 > 0
  SELF%V = VARIABLE_3RB ("V", LACTIVE=.TRUE., LT1=LLT1, LT9=LLT9)
  IF (LLT0) THEN
    CALL FIELD_NEW (SELF%V%FT0, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_V0,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%V%FT0 => NULL ()
  ENDIF
  IF (LLT1) THEN
    CALL FIELD_NEW (SELF%V%FT1, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_V1,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%V%FT1 => NULL ()
  ENDIF
  IF (LLT9) THEN
    CALL FIELD_NEW (SELF%V%FT9, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_V9,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%V%FT9 => NULL ()
  ENDIF
  LLT0 = YDMDDH%MSIDDH_T0 > 0
  LLT1 = YDMDDH%MSIDDH_T1 > 0
  LLT9 = YDMDDH%MSIDDH_T9 > 0
  SELF%T = VARIABLE_3RB ("T", LACTIVE=.TRUE., LT1=LLT1, LT9=LLT9)
  IF (LLT0) THEN
    CALL FIELD_NEW (SELF%T%FT0, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_T0,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%T%FT0 => NULL ()
  ENDIF
  IF (LLT1) THEN
    CALL FIELD_NEW (SELF%T%FT1, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_T1,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%T%FT1 => NULL ()
  ENDIF
  IF (LLT9) THEN
    CALL FIELD_NEW (SELF%T%FT9, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_T9,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%T%FT9 => NULL ()
  ENDIF
  LLT0 = YDMDDH%MSIDDH_PD0 > 0
  LLT1 = YDMDDH%MSIDDH_PD1 > 0
  LLT9 = YDMDDH%MSIDDH_PD9 > 0
  SELF%PD = VARIABLE_3RB ("PD", LACTIVE=.TRUE., LT1=LLT1, LT9=LLT9)
  IF (LLT0) THEN
    CALL FIELD_NEW (SELF%PD%FT0, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_PD0,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%PD%FT0 => NULL ()
  ENDIF
  IF (LLT1) THEN
    CALL FIELD_NEW (SELF%PD%FT1, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_PD1,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%PD%FT1 => NULL ()
  ENDIF
  IF (LLT9) THEN
    CALL FIELD_NEW (SELF%PD%FT9, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_PD9,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%PD%FT9 => NULL ()
  ENDIF
  LLT0 = YDMDDH%MSIDDH_VD0 > 0
  LLT1 = YDMDDH%MSIDDH_VD1 > 0
  LLT9 = YDMDDH%MSIDDH_VD9 > 0
  SELF%VD = VARIABLE_3RB ("VD", LACTIVE=.TRUE., LT1=LLT1, LT9=LLT9)
  IF (LLT0) THEN
    CALL FIELD_NEW (SELF%VD%FT0, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_VD0,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%VD%FT0 => NULL ()
  ENDIF
  IF (LLT1) THEN
    CALL FIELD_NEW (SELF%VD%FT1, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_VD1,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%VD%FT1 => NULL ()
  ENDIF
  IF (LLT9) THEN
    CALL FIELD_NEW (SELF%VD%FT9, DATA=YDGPDDH%GMVTNDSI_DDH (:,:,YDMDDH%MSIDDH_VD9,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ELSE
    SELF%VD%FT9 => NULL ()
  ENDIF

ENDIF

END SUBROUTINE CPG_TNDSI_DDH_TYPE_INIT

SUBROUTINE CPG_TNDSI_DDH_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TNDSI_DDH_TYPE) :: SELF
INTEGER (KIND=JPIM), INTENT (IN) :: BLOCK_INDEX

IF (ASSOCIATED (SELF%ZDATA_GMV)) SELF%ZVIEW_GMV => SELF%ZDATA_GMV (:,:,:,BLOCK_INDEX)

CALL SELF%U%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%V%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%T%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%PD%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%VD%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_TNDSI_DDH_TYPE_UPDATE_VIEW

SUBROUTINE CPG_TNDSI_DDH_TYPE_FINAL (SELF)

CLASS (CPG_TNDSI_DDH_TYPE) :: SELF

CALL SELF%U%FINAL
CALL SELF%V%FINAL
CALL SELF%T%FINAL
CALL SELF%PD%FINAL
CALL SELF%VD%FINAL

END SUBROUTINE CPG_TNDSI_DDH_TYPE_FINAL

SUBROUTINE CPG_TNDHD_DDH_TYPE_INIT (SELF, YDMDDH, YDGPDDH)

CLASS (CPG_TNDHD_DDH_TYPE) :: SELF
TYPE (TMDDH),     INTENT (IN) :: YDMDDH
TYPE (TGPDDH),    INTENT (IN), TARGET :: YDGPDDH

IF (ALLOCATED (YDGPDDH%GMVTNDHD_DDH)) THEN

  SELF%ZDATA_GMV => YDGPDDH%GMVTNDHD_DDH

  IF (YDMDDH%MHDDDH_U > 0) THEN
    CALL FIELD_NEW (SELF%F_U, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_U,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MHDDDH_V > 0) THEN
    CALL FIELD_NEW (SELF%F_V, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_V,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MHDDDH_T > 0) THEN
    CALL FIELD_NEW (SELF%F_T, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_T,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MHDDDH_PD > 0) THEN
    CALL FIELD_NEW (SELF%F_PD, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_PD,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MHDDDH_VD > 0) THEN
    CALL FIELD_NEW (SELF%F_VD, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_VD,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MHDDDH_NHX > 0) THEN
    CALL FIELD_NEW (SELF%F_NHX, DATA=YDGPDDH%GMVTNDHD_DDH (:,:,YDMDDH%MHDDDH_NHX,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF

ENDIF

IF (ALLOCATED (YDGPDDH%GFLTNDHD_DDH)) THEN

  SELF%ZDATA_GFL => YDGPDDH%GFLTNDHD_DDH

  IF (YDMDDH%MHDDDH_Q > 0) THEN
    CALL FIELD_NEW (SELF%F_Q, DATA=YDGPDDH%GFLTNDHD_DDH (:,:,YDMDDH%MHDDDH_Q,:), PERSISTENT=.TRUE., INITIALIZED=.FALSE.,&
        & SYNC_ON_FINAL=.FALSE.)
  ENDIF

ENDIF

END SUBROUTINE CPG_TNDHD_DDH_TYPE_INIT

SUBROUTINE CPG_TNDHD_DDH_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TNDHD_DDH_TYPE) :: SELF
INTEGER (KIND=JPIM), INTENT (IN) :: BLOCK_INDEX

IF (ASSOCIATED (SELF%ZDATA_GMV)) SELF%ZVIEW_GMV => SELF%ZDATA_GMV (:,:,:,BLOCK_INDEX)
IF (ASSOCIATED (SELF%ZDATA_GFL)) SELF%ZVIEW_GFL => SELF%ZDATA_GFL (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_U)) THEN
  SELF%U => SELF%F_U%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_V)) THEN
  SELF%V => SELF%F_V%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_T)) THEN
  SELF%T => SELF%F_T%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_PD)) THEN
  SELF%PD => SELF%F_PD%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_VD)) THEN
  SELF%VD => SELF%F_VD%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_NHX)) THEN
  SELF%NHX => SELF%F_NHX%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_Q)) THEN
  SELF%Q => SELF%F_Q%GET_VIEW (BLOCK_INDEX)
ENDIF

END SUBROUTINE CPG_TNDHD_DDH_TYPE_UPDATE_VIEW

SUBROUTINE CPG_TNDHD_DDH_TYPE_FINAL (SELF)

CLASS (CPG_TNDHD_DDH_TYPE) :: SELF

IF (ASSOCIATED (SELF%F_U)) THEN
  CALL FIELD_DELETE (SELF%F_U)
  SELF%F_U => NULL ()
  SELF%U => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_V)) THEN
  CALL FIELD_DELETE (SELF%F_V)
  SELF%F_V => NULL ()
  SELF%V => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_T)) THEN
  CALL FIELD_DELETE (SELF%F_T)
  SELF%F_T => NULL ()
  SELF%T => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_PD)) THEN
  CALL FIELD_DELETE (SELF%F_PD)
  SELF%F_PD => NULL ()
  SELF%PD => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VD)) THEN
  CALL FIELD_DELETE (SELF%F_VD)
  SELF%F_VD => NULL ()
  SELF%VD => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_NHX)) THEN
  CALL FIELD_DELETE (SELF%F_NHX)
  SELF%F_NHX => NULL ()
  SELF%NHX => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_Q)) THEN
  CALL FIELD_DELETE (SELF%F_Q)
  SELF%F_Q => NULL ()
  SELF%Q => NULL ()
ENDIF

END SUBROUTINE CPG_TNDHD_DDH_TYPE_FINAL

SUBROUTINE CPG_TNDSL_DDH_TYPE_INIT (SELF, YDMDDH, YDGPDDH, YGFL)

USE YOM_YGFL, ONLY: TYPE_GFLD, TYPE_GFL_COMP

CLASS (CPG_TNDSL_DDH_TYPE) :: SELF
TYPE (TMDDH),            INTENT (IN) :: YDMDDH
TYPE (TGPDDH),           INTENT (IN), TARGET :: YDGPDDH
TYPE (TYPE_GFLD),        INTENT (IN) :: YGFL

INTEGER (KIND=JPIM) :: IFLD, JFLD
CHARACTER (LEN=64)  :: CLNAME
CHARACTER (LEN=16)  :: CLI

IF (ALLOCATED (YDGPDDH%GMVTNDSL_DDH)) THEN
  SELF%ZDATA_GMV => YDGPDDH%GMVTNDSL_DDH

  IF (YDMDDH%MSLDDH_U > 0) THEN
    CALL FIELD_NEW (SELF%U%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_U,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MSLDDH_V > 0) THEN
    CALL FIELD_NEW (SELF%V%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_V,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MSLDDH_T > 0) THEN
    CALL FIELD_NEW (SELF%T%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_T,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MSLDDH_PD > 0) THEN
    CALL FIELD_NEW (SELF%PD%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_PD,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MSLDDH_VD > 0) THEN
    CALL FIELD_NEW (SELF%VD%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_VD,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
  IF (YDMDDH%MSLDDH_NHX > 0) THEN
    CALL FIELD_NEW (SELF%NHX%F_P, DATA=YDGPDDH%GMVTNDSL_DDH (:,:,YDMDDH%MSLDDH_NHX,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
  ENDIF
ENDIF

IF (ALLOCATED (YDGPDDH%GFLTNDSL_DDH)) THEN
  SELF%ZDATA_GFL => YDGPDDH%GFLTNDSL_DDH

  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%Q%F_P, "Q", YGFL%YQ)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%I%F_P, "I", YGFL%YI)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%L%F_P, "L", YGFL%YL)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%IMF%F_P, "IMF", YGFL%YIMF)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%LMF%F_P, "LMF", YGFL%YLMF)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%LCONV%F_P, "LCONV", YGFL%YLCONV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%ICONV%F_P, "ICONV", YGFL%YICONV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%RCONV%F_P, "RCONV", YGFL%YRCONV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SCONV%F_P, "SCONV", YGFL%YSCONV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%IRAD%F_P, "IRAD", YGFL%YIRAD)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%LRAD%F_P, "LRAD", YGFL%YLRAD)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%S%F_P, "S", YGFL%YS)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%R%F_P, "R", YGFL%YR)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%G%F_P, "G", YGFL%YG)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%H%F_P, "H", YGFL%YH)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%TKE%F_P, "TKE", YGFL%YTKE)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%TTE%F_P, "TTE", YGFL%YTTE)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EFB1%F_P, "EFB1", YGFL%YEFB1)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EFB2%F_P, "EFB2", YGFL%YEFB2)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EFB3%F_P, "EFB3", YGFL%YEFB3)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%A%F_P, "A", YGFL%YA)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AMF%F_P, "AMF", YGFL%YAMF)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%O3%F_P, "O3", YGFL%YO3)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SRC%F_P, "SRC", YGFL%YSRC)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%MXL%F_P, "MXL", YGFL%YMXL)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SHTUR%F_P, "SHTUR", YGFL%YSHTUR)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%FQTUR%F_P, "FQTUR", YGFL%YFQTUR)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%FSTUR%F_P, "FSTUR", YGFL%YFSTUR)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%CPF%F_P, "CPF", YGFL%YCPF)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SPF%F_P, "SPF", YGFL%YSPF)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%CVGQ%F_P, "CVGQ", YGFL%YCVGQ)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%QVA%F_P, "QVA", YGFL%YQVA)
  IF (ASSOCIATED (YGFL%YGHG)) THEN
    IFLD = SIZE (YGFL%YGHG)
    ALLOCATE (SELF%GHG (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "GHG_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%GHG (JFLD)%F_P, CLNAME, YGFL%YGHG (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YCHEM)) THEN
    IFLD = SIZE (YGFL%YCHEM)
    ALLOCATE (SELF%CHEM (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "CHEM_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%CHEM (JFLD)%F_P, CLNAME, YGFL%YCHEM (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YAERO)) THEN
    IFLD = SIZE (YGFL%YAERO)
    ALLOCATE (SELF%AERO (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "AERO_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AERO (JFLD)%F_P, CLNAME, YGFL%YAERO (JFLD))
    ENDDO
  ENDIF
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%LRCH4%F_P, "LRCH4", YGFL%YLRCH4)
  IF (ASSOCIATED (YGFL%YFORC)) THEN
    IFLD = SIZE (YGFL%YFORC)
    ALLOCATE (SELF%FORC (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "FORC_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%FORC (JFLD)%F_P, CLNAME, YGFL%YFORC (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YEZDIAG)) THEN
    IFLD = SIZE (YGFL%YEZDIAG)
    ALLOCATE (SELF%EZDIAG (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "EZDIAG_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EZDIAG (JFLD)%F_P, CLNAME, YGFL%YEZDIAG (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YERA40)) THEN
    IFLD = SIZE (YGFL%YERA40)
    ALLOCATE (SELF%ERA40 (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "ERA40_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%ERA40 (JFLD)%F_P, CLNAME, YGFL%YERA40 (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YNOGW)) THEN
    IFLD = SIZE (YGFL%YNOGW)
    ALLOCATE (SELF%NOGW (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "NOGW_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%NOGW (JFLD)%F_P, CLNAME, YGFL%YNOGW (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YEMIS3D)) THEN
    IFLD = SIZE (YGFL%YEMIS3D)
    ALLOCATE (SELF%EMIS3D (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "EMIS3D_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EMIS3D (JFLD)%F_P, CLNAME, YGFL%YEMIS3D (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YEDRP)) THEN
    IFLD = SIZE (YGFL%YEDRP)
    ALLOCATE (SELF%EDRP (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "EDRP_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EDRP (JFLD)%F_P, CLNAME, YGFL%YEDRP (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YSLDIA)) THEN
    IFLD = SIZE (YGFL%YSLDIA)
    ALLOCATE (SELF%SLDIA (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "SLDIA_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SLDIA (JFLD)%F_P, CLNAME, YGFL%YSLDIA (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YAERAOT)) THEN
    IFLD = SIZE (YGFL%YAERAOT)
    ALLOCATE (SELF%AERAOT (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "AERAOT_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AERAOT (JFLD)%F_P, CLNAME, YGFL%YAERAOT (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YAERLISI)) THEN
    IFLD = SIZE (YGFL%YAERLISI)
    ALLOCATE (SELF%AERLISI (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "AERLISI_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AERLISI (JFLD)%F_P, CLNAME, YGFL%YAERLISI (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YAEROUT)) THEN
    IFLD = SIZE (YGFL%YAEROUT)
    ALLOCATE (SELF%AEROUT (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "AEROUT_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AEROUT (JFLD)%F_P, CLNAME, YGFL%YAEROUT (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YAEROCLIM)) THEN
    IFLD = SIZE (YGFL%YAEROCLIM)
    ALLOCATE (SELF%AEROCLIM (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "AEROCLIM_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%AEROCLIM (JFLD)%F_P, CLNAME, YGFL%YAEROCLIM (JFLD))
    ENDDO
  ENDIF
  IF (ASSOCIATED (YGFL%YUVP)) THEN
    IFLD = SIZE (YGFL%YUVP)
    ALLOCATE (SELF%UVP (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "UVP_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%UVP (JFLD)%F_P, CLNAME, YGFL%YUVP (JFLD))
    ENDDO
  ENDIF
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%PHYCTY%F_P, "PHYCTY", YGFL%YPHYCTY)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%RSPEC%F_P, "RSPEC", YGFL%YRSPEC)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%SDSAT%F_P, "SDSAT", YGFL%YSDSAT)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%CVV%F_P, "CVV", YGFL%YCVV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%RKTH%F_P, "RKTH", YGFL%YRKTH)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%RKTQV%F_P, "RKTQV", YGFL%YRKTQV)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%RKTQC%F_P, "RKTQC", YGFL%YRKTQC)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%UOM%F_P, "UOM", YGFL%YUOM)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%UAL%F_P, "UAL", YGFL%YUAL)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%DOM%F_P, "DOM", YGFL%YDOM)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%DAL%F_P, "DAL", YGFL%YDAL)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%UEN%F_P, "UEN", YGFL%YUEN)
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%UNEBH%F_P, "UNEBH", YGFL%YUNEBH)
  IF (ASSOCIATED (YGFL%YLIMA)) THEN
    IFLD = SIZE (YGFL%YLIMA)
    ALLOCATE (SELF%LIMA (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "LIMA_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%LIMA (JFLD)%F_P, CLNAME, YGFL%YLIMA (JFLD))
    ENDDO
  ENDIF
  CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%FSD%F_P, "FSD", YGFL%YFSD)
  IF (ASSOCIATED (YGFL%YEXT)) THEN
    IFLD = SIZE (YGFL%YEXT)
    ALLOCATE (SELF%EXT (IFLD))
    DO JFLD = 1, IFLD
      WRITE (CLI, '(I0)') JFLD
      CLNAME = "EXT_"//TRIM (CLI)
      CALL CPG_TNDSL_DDH_TYPE_INIT_V (SELF%EXT (JFLD)%F_P, CLNAME, YGFL%YEXT (JFLD))
    ENDDO
  ENDIF
ENDIF

CALL GREPVARS (SELF, COND_GFL, YGFL, SELF%GFL)

CONTAINS

LOGICAL FUNCTION COND_GFL (YDCOMP)
  USE YOM_YGFL, ONLY : TYPE_GFL_COMP
  TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
  COND_GFL = .TRUE.
END FUNCTION

SUBROUTINE CPG_TNDSL_DDH_TYPE_INIT_V (YDF, CDNAME, YDCOMP)

CLASS (FIELD_3RB), POINTER :: YDF
CHARACTER (LEN=*),    INTENT (IN) :: CDNAME
TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP

#include "abor1.intfb.h"

IF (YDCOMP%MP > 0) THEN
  IF (YDCOMP%MP > UBOUND (YDGPDDH%GFLTNDSL_DDH, 3)) THEN
    CALL ABOR1 ('CPG_TNDSL_DDH_TYPE_INIT: OUT OF BOUNDS ON YDGPDDH%GFLTNDSL_DDH')
  ENDIF
  CALL FIELD_NEW (YDF, DATA=YDGPDDH%GFLTNDSL_DDH (:,:,YDCOMP%MP,:), INITIALIZED=.FALSE., SYNC_ON_FINAL=.FALSE.)
ENDIF

END SUBROUTINE CPG_TNDSL_DDH_TYPE_INIT_V

END SUBROUTINE CPG_TNDSL_DDH_TYPE_INIT

SUBROUTINE CPG_TNDSL_DDH_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TNDSL_DDH_TYPE) :: SELF
INTEGER (KIND=JPIM), INTENT (IN) :: BLOCK_INDEX

INTEGER (KIND=JPIM) :: IFLD, JFLD

IF (ASSOCIATED (SELF%ZDATA_GMV)) SELF%ZVIEW_GMV => SELF%ZDATA_GMV (:,:,:,BLOCK_INDEX)
IF (ASSOCIATED (SELF%ZDATA_GFL)) SELF%ZVIEW_GFL => SELF%ZDATA_GFL (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%U%F_P)) THEN
  SELF%U%P => SELF%U%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%V%F_P)) THEN
  SELF%V%P => SELF%V%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%T%F_P)) THEN
  SELF%T%P => SELF%T%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%PD%F_P)) THEN
  SELF%PD%P => SELF%PD%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%VD%F_P)) THEN
  SELF%VD%P => SELF%VD%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%NHX%F_P)) THEN
  SELF%NHX%P => SELF%NHX%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%Q%F_P)) THEN
  SELF%Q%P => SELF%Q%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%I%F_P)) THEN
  SELF%I%P => SELF%I%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%L%F_P)) THEN
  SELF%L%P => SELF%L%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%IMF%F_P)) THEN
  SELF%IMF%P => SELF%IMF%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%LMF%F_P)) THEN
  SELF%LMF%P => SELF%LMF%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%LCONV%F_P)) THEN
  SELF%LCONV%P => SELF%LCONV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%ICONV%F_P)) THEN
  SELF%ICONV%P => SELF%ICONV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RCONV%F_P)) THEN
  SELF%RCONV%P => SELF%RCONV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%SCONV%F_P)) THEN
  SELF%SCONV%P => SELF%SCONV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%IRAD%F_P)) THEN
  SELF%IRAD%P => SELF%IRAD%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%LRAD%F_P)) THEN
  SELF%LRAD%P => SELF%LRAD%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%S%F_P)) THEN
  SELF%S%P => SELF%S%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%R%F_P)) THEN
  SELF%R%P => SELF%R%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%G%F_P)) THEN
  SELF%G%P => SELF%G%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%H%F_P)) THEN
  SELF%H%P => SELF%H%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%TKE%F_P)) THEN
  SELF%TKE%P => SELF%TKE%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%TTE%F_P)) THEN
  SELF%TTE%P => SELF%TTE%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%EFB1%F_P)) THEN
  SELF%EFB1%P => SELF%EFB1%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%EFB2%F_P)) THEN
  SELF%EFB2%P => SELF%EFB2%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%EFB3%F_P)) THEN
  SELF%EFB3%P => SELF%EFB3%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%A%F_P)) THEN
  SELF%A%P => SELF%A%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%AMF%F_P)) THEN
  SELF%AMF%P => SELF%AMF%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%O3%F_P)) THEN
  SELF%O3%P => SELF%O3%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%SRC%F_P)) THEN
  SELF%SRC%P => SELF%SRC%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%MXL%F_P)) THEN
  SELF%MXL%P => SELF%MXL%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%SHTUR%F_P)) THEN
  SELF%SHTUR%P => SELF%SHTUR%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%FQTUR%F_P)) THEN
  SELF%FQTUR%P => SELF%FQTUR%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%FSTUR%F_P)) THEN
  SELF%FSTUR%P => SELF%FSTUR%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%CPF%F_P)) THEN
  SELF%CPF%P => SELF%CPF%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%SPF%F_P)) THEN
  SELF%SPF%P => SELF%SPF%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%CVGQ%F_P)) THEN
  SELF%CVGQ%P => SELF%CVGQ%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%QVA%F_P)) THEN
  SELF%QVA%P => SELF%QVA%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ALLOCATED (SELF%GHG)) THEN
  IFLD = SIZE (SELF%GHG)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%GHG (JFLD)%F_P)) THEN
      SELF%GHG (JFLD)%P => SELF%GHG (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%CHEM)) THEN
  IFLD = SIZE (SELF%CHEM)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%CHEM (JFLD)%F_P)) THEN
      SELF%CHEM (JFLD)%P => SELF%CHEM (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%AERO)) THEN
  IFLD = SIZE (SELF%AERO)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERO (JFLD)%F_P)) THEN
      SELF%AERO (JFLD)%P => SELF%AERO (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ASSOCIATED (SELF%LRCH4%F_P)) THEN
  SELF%LRCH4%P => SELF%LRCH4%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ALLOCATED (SELF%FORC)) THEN
  IFLD = SIZE (SELF%FORC)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%FORC (JFLD)%F_P)) THEN
      SELF%FORC (JFLD)%P => SELF%FORC (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%EZDIAG)) THEN
  IFLD = SIZE (SELF%EZDIAG)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EZDIAG (JFLD)%F_P)) THEN
      SELF%EZDIAG (JFLD)%P => SELF%EZDIAG (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%ERA40)) THEN
  IFLD = SIZE (SELF%ERA40)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%ERA40 (JFLD)%F_P)) THEN
      SELF%ERA40 (JFLD)%P => SELF%ERA40 (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%NOGW)) THEN
  IFLD = SIZE (SELF%NOGW)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%NOGW (JFLD)%F_P)) THEN
      SELF%NOGW (JFLD)%P => SELF%NOGW (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%EMIS3D)) THEN
  IFLD = SIZE (SELF%EMIS3D)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EMIS3D (JFLD)%F_P)) THEN
      SELF%EMIS3D (JFLD)%P => SELF%EMIS3D (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%EDRP)) THEN
  IFLD = SIZE (SELF%EDRP)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EDRP (JFLD)%F_P)) THEN
      SELF%EDRP (JFLD)%P => SELF%EDRP (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%SLDIA)) THEN
  IFLD = SIZE (SELF%SLDIA)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%SLDIA (JFLD)%F_P)) THEN
      SELF%SLDIA (JFLD)%P => SELF%SLDIA (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%AERAOT)) THEN
  IFLD = SIZE (SELF%AERAOT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERAOT (JFLD)%F_P)) THEN
      SELF%AERAOT (JFLD)%P => SELF%AERAOT (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%AERLISI)) THEN
  IFLD = SIZE (SELF%AERLISI)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERLISI (JFLD)%F_P)) THEN
      SELF%AERLISI (JFLD)%P => SELF%AERLISI (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%AEROUT)) THEN
  IFLD = SIZE (SELF%AEROUT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AEROUT (JFLD)%F_P)) THEN
      SELF%AEROUT (JFLD)%P => SELF%AEROUT (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%AEROCLIM)) THEN
  IFLD = SIZE (SELF%AEROCLIM)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AEROCLIM (JFLD)%F_P)) THEN
      SELF%AEROCLIM (JFLD)%P => SELF%AEROCLIM (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (SELF%UVP)) THEN
  IFLD = SIZE (SELF%UVP)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%UVP (JFLD)%F_P)) THEN
      SELF%UVP (JFLD)%P => SELF%UVP (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ASSOCIATED (SELF%PHYCTY%F_P)) THEN
  SELF%PHYCTY%P => SELF%PHYCTY%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RSPEC%F_P)) THEN
  SELF%RSPEC%P => SELF%RSPEC%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%SDSAT%F_P)) THEN
  SELF%SDSAT%P => SELF%SDSAT%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%CVV%F_P)) THEN
  SELF%CVV%P => SELF%CVV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RKTH%F_P)) THEN
  SELF%RKTH%P => SELF%RKTH%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RKTQV%F_P)) THEN
  SELF%RKTQV%P => SELF%RKTQV%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RKTQC%F_P)) THEN
  SELF%RKTQC%P => SELF%RKTQC%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%UOM%F_P)) THEN
  SELF%UOM%P => SELF%UOM%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%UAL%F_P)) THEN
  SELF%UAL%P => SELF%UAL%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%DOM%F_P)) THEN
  SELF%DOM%P => SELF%DOM%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%DAL%F_P)) THEN
  SELF%DAL%P => SELF%DAL%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%UEN%F_P)) THEN
  SELF%UEN%P => SELF%UEN%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%UNEBH%F_P)) THEN
  SELF%UNEBH%P => SELF%UNEBH%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ALLOCATED (SELF%LIMA)) THEN
  IFLD = SIZE (SELF%LIMA)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%LIMA (JFLD)%F_P)) THEN
      SELF%LIMA (JFLD)%P => SELF%LIMA (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF
IF (ASSOCIATED (SELF%FSD%F_P)) THEN
  SELF%FSD%P => SELF%FSD%F_P%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ALLOCATED (SELF%EXT)) THEN
  IFLD = SIZE (SELF%EXT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EXT (JFLD)%F_P)) THEN
      SELF%EXT (JFLD)%P => SELF%EXT (JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ENDDO
ENDIF

DO JFLD = 1, SIZE (SELF%GFL)
  IF (ASSOCIATED (SELF%GFL(JFLD)%F_P)) THEN
    SELF%GFL(JFLD)%P => SELF%GFL(JFLD)%F_P%GET_VIEW (BLOCK_INDEX)
  ENDIF
ENDDO

END SUBROUTINE CPG_TNDSL_DDH_TYPE_UPDATE_VIEW

SUBROUTINE CPG_TNDSL_DDH_TYPE_FINAL (SELF)

CLASS (CPG_TNDSL_DDH_TYPE) :: SELF

INTEGER (KIND=JPIM) :: IFLD, JFLD

IF (ASSOCIATED (SELF%U%F_P)) THEN
  CALL FIELD_DELETE (SELF%U%F_P)
  SELF%U%F_P => NULL ()  
  SELF%U%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%V%F_P)) THEN
  CALL FIELD_DELETE (SELF%V%F_P)
  SELF%V%F_P => NULL ()  
  SELF%V%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%T%F_P)) THEN
  CALL FIELD_DELETE (SELF%T%F_P)
  SELF%T%F_P => NULL ()  
  SELF%T%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%PD%F_P)) THEN
  CALL FIELD_DELETE (SELF%PD%F_P)
  SELF%PD%F_P => NULL ()  
  SELF%PD%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%VD%F_P)) THEN
  CALL FIELD_DELETE (SELF%VD%F_P)
  SELF%VD%F_P => NULL ()  
  SELF%VD%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%NHX%F_P)) THEN
  CALL FIELD_DELETE (SELF%NHX%F_P)
  SELF%NHX%F_P => NULL ()  
  SELF%NHX%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%Q%F_P)) THEN
  CALL FIELD_DELETE (SELF%Q%F_P)
  SELF%Q%F_P => NULL ()
  SELF%Q%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%I%F_P)) THEN
  CALL FIELD_DELETE (SELF%I%F_P)
  SELF%I%F_P => NULL ()
  SELF%I%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%L%F_P)) THEN
  CALL FIELD_DELETE (SELF%L%F_P)
  SELF%L%F_P => NULL ()
  SELF%L%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%IMF%F_P)) THEN
  CALL FIELD_DELETE (SELF%IMF%F_P)
  SELF%IMF%F_P => NULL ()
  SELF%IMF%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%LMF%F_P)) THEN
  CALL FIELD_DELETE (SELF%LMF%F_P)
  SELF%LMF%F_P => NULL ()
  SELF%LMF%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%LCONV%F_P)) THEN
  CALL FIELD_DELETE (SELF%LCONV%F_P)
  SELF%LCONV%F_P => NULL ()
  SELF%LCONV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%ICONV%F_P)) THEN
  CALL FIELD_DELETE (SELF%ICONV%F_P)
  SELF%ICONV%F_P => NULL ()
  SELF%ICONV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%RCONV%F_P)) THEN
  CALL FIELD_DELETE (SELF%RCONV%F_P)
  SELF%RCONV%F_P => NULL ()
  SELF%RCONV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%SCONV%F_P)) THEN
  CALL FIELD_DELETE (SELF%SCONV%F_P)
  SELF%SCONV%F_P => NULL ()
  SELF%SCONV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%IRAD%F_P)) THEN
  CALL FIELD_DELETE (SELF%IRAD%F_P)
  SELF%IRAD%F_P => NULL ()
  SELF%IRAD%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%LRAD%F_P)) THEN
  CALL FIELD_DELETE (SELF%LRAD%F_P)
  SELF%LRAD%F_P => NULL ()
  SELF%LRAD%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%S%F_P)) THEN
  CALL FIELD_DELETE (SELF%S%F_P)
  SELF%S%F_P => NULL ()
  SELF%S%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%R%F_P)) THEN
  CALL FIELD_DELETE (SELF%R%F_P)
  SELF%R%F_P => NULL ()
  SELF%R%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%G%F_P)) THEN
  CALL FIELD_DELETE (SELF%G%F_P)
  SELF%G%F_P => NULL ()
  SELF%G%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%H%F_P)) THEN
  CALL FIELD_DELETE (SELF%H%F_P)
  SELF%H%F_P => NULL ()
  SELF%H%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%TKE%F_P)) THEN
  CALL FIELD_DELETE (SELF%TKE%F_P)
  SELF%TKE%F_P => NULL ()
  SELF%TKE%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%TTE%F_P)) THEN
  CALL FIELD_DELETE (SELF%TTE%F_P)
  SELF%TTE%F_P => NULL ()
  SELF%TTE%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%EFB1%F_P)) THEN
  CALL FIELD_DELETE (SELF%EFB1%F_P)
  SELF%EFB1%F_P => NULL ()
  SELF%EFB1%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%EFB2%F_P)) THEN
  CALL FIELD_DELETE (SELF%EFB2%F_P)
  SELF%EFB2%F_P => NULL ()
  SELF%EFB2%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%EFB3%F_P)) THEN
  CALL FIELD_DELETE (SELF%EFB3%F_P)
  SELF%EFB3%F_P => NULL ()
  SELF%EFB3%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%A%F_P)) THEN
  CALL FIELD_DELETE (SELF%A%F_P)
  SELF%A%F_P => NULL ()
  SELF%A%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%AMF%F_P)) THEN
  CALL FIELD_DELETE (SELF%AMF%F_P)
  SELF%AMF%F_P => NULL ()
  SELF%AMF%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%O3%F_P)) THEN
  CALL FIELD_DELETE (SELF%O3%F_P)
  SELF%O3%F_P => NULL ()
  SELF%O3%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%SRC%F_P)) THEN
  CALL FIELD_DELETE (SELF%SRC%F_P)
  SELF%SRC%F_P => NULL ()
  SELF%SRC%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%MXL%F_P)) THEN
  CALL FIELD_DELETE (SELF%MXL%F_P)
  SELF%MXL%F_P => NULL ()
  SELF%MXL%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%SHTUR%F_P)) THEN
  CALL FIELD_DELETE (SELF%SHTUR%F_P)
  SELF%SHTUR%F_P => NULL ()
  SELF%SHTUR%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%FQTUR%F_P)) THEN
  CALL FIELD_DELETE (SELF%FQTUR%F_P)
  SELF%FQTUR%F_P => NULL ()
  SELF%FQTUR%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%FSTUR%F_P)) THEN
  CALL FIELD_DELETE (SELF%FSTUR%F_P)
  SELF%FSTUR%F_P => NULL ()
  SELF%FSTUR%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%CPF%F_P)) THEN
  CALL FIELD_DELETE (SELF%CPF%F_P)
  SELF%CPF%F_P => NULL ()
  SELF%CPF%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%SPF%F_P)) THEN
  CALL FIELD_DELETE (SELF%SPF%F_P)
  SELF%SPF%F_P => NULL ()
  SELF%SPF%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%CVGQ%F_P)) THEN
  CALL FIELD_DELETE (SELF%CVGQ%F_P)
  SELF%CVGQ%F_P => NULL ()
  SELF%CVGQ%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%QVA%F_P)) THEN
  CALL FIELD_DELETE (SELF%QVA%F_P)
  SELF%QVA%F_P => NULL ()
  SELF%QVA%P => NULL ()
ENDIF
IF (ALLOCATED (SELF%GHG)) THEN
  IFLD = SIZE (SELF%GHG)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%GHG (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%GHG (JFLD)%F_P)
      SELF%GHG (JFLD)%F_P => NULL ()
      SELF%GHG (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%GHG)
ENDIF
IF (ALLOCATED (SELF%CHEM)) THEN
  IFLD = SIZE (SELF%CHEM)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%CHEM (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%CHEM (JFLD)%F_P)
      SELF%CHEM (JFLD)%F_P => NULL ()
      SELF%CHEM (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%CHEM)
ENDIF
IF (ALLOCATED (SELF%AERO)) THEN
  IFLD = SIZE (SELF%AERO)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERO (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%AERO (JFLD)%F_P)
      SELF%AERO (JFLD)%F_P => NULL ()
      SELF%AERO (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%AERO)
ENDIF
IF (ASSOCIATED (SELF%LRCH4%F_P)) THEN
  CALL FIELD_DELETE (SELF%LRCH4%F_P)
  SELF%LRCH4%F_P => NULL ()
  SELF%LRCH4%P => NULL ()
ENDIF
IF (ALLOCATED (SELF%FORC)) THEN
  IFLD = SIZE (SELF%FORC)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%FORC (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%FORC (JFLD)%F_P)
      SELF%FORC (JFLD)%F_P => NULL ()
      SELF%FORC (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%FORC)
ENDIF
IF (ALLOCATED (SELF%EZDIAG)) THEN
  IFLD = SIZE (SELF%EZDIAG)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EZDIAG (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%EZDIAG (JFLD)%F_P)
      SELF%EZDIAG (JFLD)%F_P => NULL ()
      SELF%EZDIAG (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%EZDIAG)
ENDIF
IF (ALLOCATED (SELF%ERA40)) THEN
  IFLD = SIZE (SELF%ERA40)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%ERA40 (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%ERA40 (JFLD)%F_P)
      SELF%ERA40 (JFLD)%F_P => NULL ()
      SELF%ERA40 (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%ERA40)
ENDIF
IF (ALLOCATED (SELF%NOGW)) THEN
  IFLD = SIZE (SELF%NOGW)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%NOGW (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%NOGW (JFLD)%F_P)
      SELF%NOGW (JFLD)%F_P => NULL ()
      SELF%NOGW (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%NOGW)
ENDIF
IF (ALLOCATED (SELF%EMIS3D)) THEN
  IFLD = SIZE (SELF%EMIS3D)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EMIS3D (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%EMIS3D (JFLD)%F_P)
      SELF%EMIS3D (JFLD)%F_P => NULL ()
      SELF%EMIS3D (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%EMIS3D)
ENDIF
IF (ALLOCATED (SELF%EDRP)) THEN
  IFLD = SIZE (SELF%EDRP)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EDRP (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%EDRP (JFLD)%F_P)
      SELF%EDRP (JFLD)%F_P => NULL ()
      SELF%EDRP (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%EDRP)
ENDIF
IF (ALLOCATED (SELF%SLDIA)) THEN
  IFLD = SIZE (SELF%SLDIA)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%SLDIA (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%SLDIA (JFLD)%F_P)
      SELF%SLDIA (JFLD)%F_P => NULL ()
      SELF%SLDIA (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%SLDIA)
ENDIF
IF (ALLOCATED (SELF%AERAOT)) THEN
  IFLD = SIZE (SELF%AERAOT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERAOT (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%AERAOT (JFLD)%F_P)
      SELF%AERAOT (JFLD)%F_P => NULL ()
      SELF%AERAOT (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%AERAOT)
ENDIF
IF (ALLOCATED (SELF%AERLISI)) THEN
  IFLD = SIZE (SELF%AERLISI)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AERLISI (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%AERLISI (JFLD)%F_P)
      SELF%AERLISI (JFLD)%F_P => NULL ()
      SELF%AERLISI (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%AERLISI)
ENDIF
IF (ALLOCATED (SELF%AEROUT)) THEN
  IFLD = SIZE (SELF%AEROUT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AEROUT (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%AEROUT (JFLD)%F_P)
      SELF%AEROUT (JFLD)%F_P => NULL ()
      SELF%AEROUT (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%AEROUT)
ENDIF
IF (ALLOCATED (SELF%AEROCLIM)) THEN
  IFLD = SIZE (SELF%AEROCLIM)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%AEROCLIM (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%AEROCLIM (JFLD)%F_P)
      SELF%AEROCLIM (JFLD)%F_P => NULL ()
      SELF%AEROCLIM (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%AEROCLIM)
ENDIF
IF (ALLOCATED (SELF%UVP)) THEN
  IFLD = SIZE (SELF%UVP)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%UVP (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%UVP (JFLD)%F_P)
      SELF%UVP (JFLD)%F_P => NULL ()
      SELF%UVP (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%UVP)
ENDIF
IF (ASSOCIATED (SELF%PHYCTY%F_P)) THEN
  CALL FIELD_DELETE (SELF%PHYCTY%F_P)
  SELF%PHYCTY%F_P => NULL ()
  SELF%PHYCTY%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%RSPEC%F_P)) THEN
  CALL FIELD_DELETE (SELF%RSPEC%F_P)
  SELF%RSPEC%F_P => NULL ()
  SELF%RSPEC%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%SDSAT%F_P)) THEN
  CALL FIELD_DELETE (SELF%SDSAT%F_P)
  SELF%SDSAT%F_P => NULL ()
  SELF%SDSAT%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%CVV%F_P)) THEN
  CALL FIELD_DELETE (SELF%CVV%F_P)
  SELF%CVV%F_P => NULL ()
  SELF%CVV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%RKTH%F_P)) THEN
  CALL FIELD_DELETE (SELF%RKTH%F_P)
  SELF%RKTH%F_P => NULL ()
  SELF%RKTH%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%RKTQV%F_P)) THEN
  CALL FIELD_DELETE (SELF%RKTQV%F_P)
  SELF%RKTQV%F_P => NULL ()
  SELF%RKTQV%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%RKTQC%F_P)) THEN
  CALL FIELD_DELETE (SELF%RKTQC%F_P)
  SELF%RKTQC%F_P => NULL ()
  SELF%RKTQC%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%UOM%F_P)) THEN
  CALL FIELD_DELETE (SELF%UOM%F_P)
  SELF%UOM%F_P => NULL ()
  SELF%UOM%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%UAL%F_P)) THEN
  CALL FIELD_DELETE (SELF%UAL%F_P)
  SELF%UAL%F_P => NULL ()
  SELF%UAL%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%DOM%F_P)) THEN
  CALL FIELD_DELETE (SELF%DOM%F_P)
  SELF%DOM%F_P => NULL ()
  SELF%DOM%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%DAL%F_P)) THEN
  CALL FIELD_DELETE (SELF%DAL%F_P)
  SELF%DAL%F_P => NULL ()
  SELF%DAL%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%UEN%F_P)) THEN
  CALL FIELD_DELETE (SELF%UEN%F_P)
  SELF%UEN%F_P => NULL ()
  SELF%UEN%P => NULL ()
ENDIF
IF (ASSOCIATED (SELF%UNEBH%F_P)) THEN
  CALL FIELD_DELETE (SELF%UNEBH%F_P)
  SELF%UNEBH%F_P => NULL ()
  SELF%UNEBH%P => NULL ()
ENDIF
IF (ALLOCATED (SELF%LIMA)) THEN
  IFLD = SIZE (SELF%LIMA)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%LIMA (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%LIMA (JFLD)%F_P)
      SELF%LIMA (JFLD)%F_P => NULL ()
      SELF%LIMA (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%LIMA)
ENDIF
IF (ASSOCIATED (SELF%FSD%F_P)) THEN
  CALL FIELD_DELETE (SELF%FSD%F_P)
  SELF%FSD%F_P => NULL ()
  SELF%FSD%P => NULL ()
ENDIF
IF (ALLOCATED (SELF%EXT)) THEN
  IFLD = SIZE (SELF%EXT)
  DO JFLD = 1, IFLD
    IF (ASSOCIATED (SELF%EXT (JFLD)%F_P)) THEN
      CALL FIELD_DELETE (SELF%EXT (JFLD)%F_P)
      SELF%EXT (JFLD)%F_P => NULL ()
      SELF%EXT (JFLD)%P => NULL ()
    ENDIF
  ENDDO
  DEALLOCATE (SELF%EXT)
ENDIF

DEALLOCATE (SELF%GFL)

END SUBROUTINE CPG_TNDSL_DDH_TYPE_FINAL

SUBROUTINE CPG_DDH_TND_TYPE_INIT (SELF, YDMDDH, YDGPDDH, YGFL)

USE YOM_YGFL, ONLY: TYPE_GFLD

CLASS (CPG_DDH_TND_TYPE) :: SELF
TYPE (TMDDH),            INTENT (IN) :: YDMDDH
TYPE (TGPDDH),           INTENT (IN), TARGET :: YDGPDDH
TYPE (TYPE_GFLD),        INTENT (IN) :: YGFL

CALL SELF%YSI%INIT (YDMDDH, YDGPDDH)
CALL SELF%YHD%INIT (YDMDDH, YDGPDDH)
CALL SELF%YSL%INIT (YDMDDH, YDGPDDH, YGFL)

END SUBROUTINE CPG_DDH_TND_TYPE_INIT

SUBROUTINE CPG_DDH_TND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DDH_TND_TYPE) :: SELF
INTEGER (KIND=JPIM), INTENT (IN) :: BLOCK_INDEX

CALL SELF%YSI%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%YHD%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%YSL%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_DDH_TND_TYPE_UPDATE_VIEW

SUBROUTINE CPG_DDH_TND_TYPE_FINAL (SELF)

CLASS (CPG_DDH_TND_TYPE) :: SELF

CALL SELF%YSI%FINAL
CALL SELF%YHD%FINAL
CALL SELF%YSL%FINAL

END SUBROUTINE CPG_DDH_TND_TYPE_FINAL

END MODULE CPG_DDH_TND_TYPE_MOD


