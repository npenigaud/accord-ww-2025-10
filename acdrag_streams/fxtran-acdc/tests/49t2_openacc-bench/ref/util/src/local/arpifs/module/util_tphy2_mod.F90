MODULE UTIL_TPHY2_MOD

USE YOMPHY2, ONLY : TPHY2

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TPHY2
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TPHY2
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TPHY2
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TPHY2
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TPHY2
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TPHY2
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TPHY2
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TPHY2 (SELF, KLUN)

IMPLICIT NONE
TYPE (TPHY2), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%NTSHM
WRITE (KLUN) SELF%NTSML
WRITE (KLUN) SELF%TSPHY
WRITE (KLUN) SELF%XMUCVPP
WRITE (KLUN) SELF%XMULAF
WRITE (KLUN) SELF%XDAMP
WRITE (KLUN) SELF%HCLP
WRITE (KLUN) SELF%HTCLS
WRITE (KLUN) SELF%HVCLS
WRITE (KLUN) SELF%HTSHM
WRITE (KLUN) SELF%HTSML
WRITE (KLUN) SELF%HWMOHIGH
WRITE (KLUN) SELF%HWMOLOW
WRITE (KLUN) SELF%GZ0RAF
WRITE (KLUN) SELF%FACRAF
WRITE (KLUN) SELF%FACRAFCV
WRITE (KLUN) SELF%FACRAFDCAPE
WRITE (KLUN) SELF%GCAPERAF
WRITE (KLUN) SELF%HTKERAF
WRITE (KLUN) SELF%LRAFTUR
WRITE (KLUN) SELF%LMULAF
WRITE (KLUN) SELF%LWMOCLOUD
WRITE (KLUN) SELF%LRAFTKE
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TPHY2 (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TPHY2), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%NTSHM
READ (KLUN) SELF%NTSML
READ (KLUN) ZTMP0
SELF%TSPHY = ZTMP0
READ (KLUN) ZTMP0
SELF%XMUCVPP = ZTMP0
READ (KLUN) ZTMP0
SELF%XMULAF = ZTMP0
READ (KLUN) ZTMP0
SELF%XDAMP = ZTMP0
READ (KLUN) ZTMP0
SELF%HCLP = ZTMP0
READ (KLUN) ZTMP0
SELF%HTCLS = ZTMP0
READ (KLUN) ZTMP0
SELF%HVCLS = ZTMP0
READ (KLUN) ZTMP0
SELF%HTSHM = ZTMP0
READ (KLUN) ZTMP0
SELF%HTSML = ZTMP0
READ (KLUN) ZTMP0
SELF%HWMOHIGH = ZTMP0
READ (KLUN) ZTMP0
SELF%HWMOLOW = ZTMP0
READ (KLUN) ZTMP0
SELF%GZ0RAF = ZTMP0
READ (KLUN) ZTMP0
SELF%FACRAF = ZTMP0
READ (KLUN) ZTMP0
SELF%FACRAFCV = ZTMP0
READ (KLUN) ZTMP0
SELF%FACRAFDCAPE = ZTMP0
READ (KLUN) ZTMP0
SELF%GCAPERAF = ZTMP0
READ (KLUN) ZTMP0
SELF%HTKERAF = ZTMP0
READ (KLUN) SELF%LRAFTUR
READ (KLUN) SELF%LMULAF
READ (KLUN) SELF%LWMOCLOUD
READ (KLUN) SELF%LRAFTKE
END SUBROUTINE

SUBROUTINE ACDC_COPY_TPHY2 (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TPHY2), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TPHY2 (SELF)

IMPLICIT NONE
TYPE (TPHY2), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TPHY2 (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TPHY2), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTSHM), CDPATH//'%NTSHM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTSML), CDPATH//'%NTSML'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TSPHY), CDPATH//'%TSPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XMUCVPP), CDPATH//'%XMUCVPP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XMULAF), CDPATH//'%XMULAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XDAMP), CDPATH//'%XDAMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HCLP), CDPATH//'%HCLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HTCLS), CDPATH//'%HTCLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HVCLS), CDPATH//'%HVCLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HTSHM), CDPATH//'%HTSHM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HTSML), CDPATH//'%HTSML'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HWMOHIGH), CDPATH//'%HWMOHIGH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HWMOLOW), CDPATH//'%HWMOLOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GZ0RAF), CDPATH//'%GZ0RAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%FACRAF), CDPATH//'%FACRAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%FACRAFCV), CDPATH//'%FACRAFCV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%FACRAFDCAPE), CDPATH//'%FACRAFDCAPE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GCAPERAF), CDPATH//'%GCAPERAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HTKERAF), CDPATH//'%HTKERAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRAFTUR), CDPATH//'%LRAFTUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LMULAF), CDPATH//'%LMULAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWMOCLOUD), CDPATH//'%LWMOCLOUD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRAFTKE), CDPATH//'%LRAFTKE'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TPHY2 (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TPHY2), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TPHY2 (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TPHY2),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NTSHM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSHM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTSML)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSML'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%TSPHY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TSPHY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XMUCVPP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMUCVPP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XMULAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMULAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XDAMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDAMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HCLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HCLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HTCLS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTCLS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HVCLS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HVCLS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HTSHM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTSHM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HTSML)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTSML'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HWMOHIGH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HWMOHIGH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HWMOLOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HWMOLOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%GZ0RAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GZ0RAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%FACRAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%FACRAFCV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAFCV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%FACRAFDCAPE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAFDCAPE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%GCAPERAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GCAPERAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HTKERAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTKERAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRAFTUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAFTUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LMULAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMULAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWMOCLOUD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWMOCLOUD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRAFTKE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAFTKE'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
