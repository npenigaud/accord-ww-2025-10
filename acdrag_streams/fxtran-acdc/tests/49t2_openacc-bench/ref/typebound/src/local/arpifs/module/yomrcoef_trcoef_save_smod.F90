SUBMODULE (YOMRCOEF) YOMRCOEF_TRCOEF_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TRCOEF (SELF, KLUN)

IMPLICIT NONE
CLASS (TRCOEF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LSOLRAD, LTHERRAD, LTRMATSUM, LTRWEIGHT
WRITE (KLUN) SELF%LRCOEF
WRITE (KLUN) SELF%LTLADDIA
WRITE (KLUN) SELF%LGLOBRAD
WRITE (KLUN) SELF%NG3SR
WRITE (KLUN) SELF%NGMTR
WRITE (KLUN) SELF%NLATWR
WRITE (KLUN) SELF%NLATRD
WRITE (KLUN) SELF%NLENGSRB
WRITE (KLUN) SELF%NLENGTRB
LSOLRAD = ALLOCATED (SELF%SOLRAD)
WRITE (KLUN) LSOLRAD
IF (LSOLRAD) THEN
  WRITE (KLUN) LBOUND (SELF%SOLRAD)
  WRITE (KLUN) UBOUND (SELF%SOLRAD)
  WRITE (KLUN) SELF%SOLRAD
ENDIF
LTHERRAD = ALLOCATED (SELF%THERRAD)
WRITE (KLUN) LTHERRAD
IF (LTHERRAD) THEN
  WRITE (KLUN) LBOUND (SELF%THERRAD)
  WRITE (KLUN) UBOUND (SELF%THERRAD)
  WRITE (KLUN) SELF%THERRAD
ENDIF
LTRWEIGHT = ALLOCATED (SELF%TRWEIGHT)
WRITE (KLUN) LTRWEIGHT
IF (LTRWEIGHT) THEN
  WRITE (KLUN) LBOUND (SELF%TRWEIGHT)
  WRITE (KLUN) UBOUND (SELF%TRWEIGHT)
  WRITE (KLUN) SELF%TRWEIGHT
ENDIF
LTRMATSUM = ALLOCATED (SELF%TRMATSUM)
WRITE (KLUN) LTRMATSUM
IF (LTRMATSUM) THEN
  WRITE (KLUN) LBOUND (SELF%TRMATSUM)
  WRITE (KLUN) UBOUND (SELF%TRMATSUM)
  WRITE (KLUN) SELF%TRMATSUM
ENDIF
END SUBROUTINE

END SUBMODULE
