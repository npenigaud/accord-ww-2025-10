SUBMODULE (YOE_SPECTRAL_PLANCK) YOE_SPECTRAL_PLANCK_TSPECTRALPLANCK_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TSPECTRALPLANCK (SELF, KLUN)

IMPLICIT NONE
CLASS (TSPECTRALPLANCK), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LINTERVAL_MAP, LPLANCK_LUT, LWAVLEN_BOUND
WRITE (KLUN) SELF%NINTERVALS
WRITE (KLUN) SELF%NTEMPS
WRITE (KLUN) SELF%TEMP1
WRITE (KLUN) SELF%DTEMP
LPLANCK_LUT = ALLOCATED (SELF%PLANCK_LUT)
WRITE (KLUN) LPLANCK_LUT
IF (LPLANCK_LUT) THEN
  WRITE (KLUN) LBOUND (SELF%PLANCK_LUT)
  WRITE (KLUN) UBOUND (SELF%PLANCK_LUT)
  WRITE (KLUN) SELF%PLANCK_LUT
ENDIF
LWAVLEN_BOUND = ALLOCATED (SELF%WAVLEN_BOUND)
WRITE (KLUN) LWAVLEN_BOUND
IF (LWAVLEN_BOUND) THEN
  WRITE (KLUN) LBOUND (SELF%WAVLEN_BOUND)
  WRITE (KLUN) UBOUND (SELF%WAVLEN_BOUND)
  WRITE (KLUN) SELF%WAVLEN_BOUND
ENDIF
LINTERVAL_MAP = ALLOCATED (SELF%INTERVAL_MAP)
WRITE (KLUN) LINTERVAL_MAP
IF (LINTERVAL_MAP) THEN
  WRITE (KLUN) LBOUND (SELF%INTERVAL_MAP)
  WRITE (KLUN) UBOUND (SELF%INTERVAL_MAP)
  WRITE (KLUN) SELF%INTERVAL_MAP
ENDIF
END SUBROUTINE

END SUBMODULE
