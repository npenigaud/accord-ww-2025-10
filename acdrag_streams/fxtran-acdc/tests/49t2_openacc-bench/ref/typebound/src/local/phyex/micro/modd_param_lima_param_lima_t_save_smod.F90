SUBMODULE (MODD_PARAM_LIMA) MODD_PARAM_LIMA_PARAM_LIMA_T_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_PARAM_LIMA_T (SELF, KLUN)

IMPLICIT NONE
CLASS (PARAM_LIMA_T), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LNIMM, LNINDICE_CCN_IMM, LXABSCISS, LXBETAHEN_MULTI, LXCONC_CCN_TOT, LXCTMIN, LXFRAC, LXFRAC_REF, LXKHEN_MULTI, LXLIMIT_FACTOR
LOGICAL :: LXLOGSIG_CCN, LXMDIAM_IFN, LXMUHEN_MULTI, LXRHO_CCN, LXRHO_IFN, LXRTMIN, LXR_MEAN_CCN, LXSIGMA_IFN, LXWEIGHT
WRITE (KLUN) SELF%LLIMA_DIAG
WRITE (KLUN) SELF%LPTSPLIT
WRITE (KLUN) SELF%LFEEDBACKT
WRITE (KLUN) SELF%NMAXITER
WRITE (KLUN) SELF%XMRSTEP
WRITE (KLUN) SELF%XTSTEP_TS
WRITE (KLUN) SELF%LNUCL
WRITE (KLUN) SELF%LSEDI
WRITE (KLUN) SELF%LHHONI
WRITE (KLUN) SELF%LMEYERS
WRITE (KLUN) SELF%LCIBU
WRITE (KLUN) SELF%LRDSF
WRITE (KLUN) SELF%NMOM_I
WRITE (KLUN) SELF%NMOM_S
WRITE (KLUN) SELF%NMOM_G
WRITE (KLUN) SELF%NMOM_H
WRITE (KLUN) SELF%NMOD_IFN
WRITE (KLUN) SELF%XIFN_CONC
WRITE (KLUN) SELF%LIFN_HOM
WRITE (KLUN) SELF%CIFN_SPECIES
WRITE (KLUN) SELF%CINT_MIXING
WRITE (KLUN) SELF%NMOD_IMM
WRITE (KLUN) SELF%NIND_SPECIE
LNIMM = ALLOCATED (SELF%NIMM)
WRITE (KLUN) LNIMM
IF (LNIMM) THEN
  WRITE (KLUN) LBOUND (SELF%NIMM)
  WRITE (KLUN) UBOUND (SELF%NIMM)
  WRITE (KLUN) SELF%NIMM
ENDIF
LNINDICE_CCN_IMM = ALLOCATED (SELF%NINDICE_CCN_IMM)
WRITE (KLUN) LNINDICE_CCN_IMM
IF (LNINDICE_CCN_IMM) THEN
  WRITE (KLUN) LBOUND (SELF%NINDICE_CCN_IMM)
  WRITE (KLUN) UBOUND (SELF%NINDICE_CCN_IMM)
  WRITE (KLUN) SELF%NINDICE_CCN_IMM
ENDIF
WRITE (KLUN) SELF%NSPECIE
LXMDIAM_IFN = ALLOCATED (SELF%XMDIAM_IFN)
WRITE (KLUN) LXMDIAM_IFN
IF (LXMDIAM_IFN) THEN
  WRITE (KLUN) LBOUND (SELF%XMDIAM_IFN)
  WRITE (KLUN) UBOUND (SELF%XMDIAM_IFN)
  WRITE (KLUN) SELF%XMDIAM_IFN
ENDIF
LXSIGMA_IFN = ALLOCATED (SELF%XSIGMA_IFN)
WRITE (KLUN) LXSIGMA_IFN
IF (LXSIGMA_IFN) THEN
  WRITE (KLUN) LBOUND (SELF%XSIGMA_IFN)
  WRITE (KLUN) UBOUND (SELF%XSIGMA_IFN)
  WRITE (KLUN) SELF%XSIGMA_IFN
ENDIF
LXRHO_IFN = ALLOCATED (SELF%XRHO_IFN)
WRITE (KLUN) LXRHO_IFN
IF (LXRHO_IFN) THEN
  WRITE (KLUN) LBOUND (SELF%XRHO_IFN)
  WRITE (KLUN) UBOUND (SELF%XRHO_IFN)
  WRITE (KLUN) SELF%XRHO_IFN
ENDIF
LXFRAC = ALLOCATED (SELF%XFRAC)
WRITE (KLUN) LXFRAC
IF (LXFRAC) THEN
  WRITE (KLUN) LBOUND (SELF%XFRAC)
  WRITE (KLUN) UBOUND (SELF%XFRAC)
  WRITE (KLUN) SELF%XFRAC
ENDIF
LXFRAC_REF = ALLOCATED (SELF%XFRAC_REF)
WRITE (KLUN) LXFRAC_REF
IF (LXFRAC_REF) THEN
  WRITE (KLUN) LBOUND (SELF%XFRAC_REF)
  WRITE (KLUN) UBOUND (SELF%XFRAC_REF)
  WRITE (KLUN) SELF%XFRAC_REF
ENDIF
WRITE (KLUN) SELF%LSNOW_T
WRITE (KLUN) SELF%LMURAKAMI
WRITE (KLUN) SELF%CPRISTINE_ICE_LIMA
WRITE (KLUN) SELF%CHEVRIMED_ICE_LIMA
WRITE (KLUN) SELF%XALPHAI
WRITE (KLUN) SELF%XNUI
WRITE (KLUN) SELF%XALPHAS
WRITE (KLUN) SELF%XNUS
WRITE (KLUN) SELF%XALPHAG
WRITE (KLUN) SELF%XNUG
WRITE (KLUN) SELF%NPHILLIPS
WRITE (KLUN) SELF%XT0
WRITE (KLUN) SELF%XDT0
WRITE (KLUN) SELF%XDSI0
WRITE (KLUN) SELF%XSW0
WRITE (KLUN) SELF%XRHO_CFDC
WRITE (KLUN) SELF%XH
WRITE (KLUN) SELF%XAREA1
WRITE (KLUN) SELF%XGAMMA
WRITE (KLUN) SELF%XTX1
WRITE (KLUN) SELF%XTX2
LXABSCISS = ALLOCATED (SELF%XABSCISS)
WRITE (KLUN) LXABSCISS
IF (LXABSCISS) THEN
  WRITE (KLUN) LBOUND (SELF%XABSCISS)
  WRITE (KLUN) UBOUND (SELF%XABSCISS)
  WRITE (KLUN) SELF%XABSCISS
ENDIF
LXWEIGHT = ALLOCATED (SELF%XWEIGHT)
WRITE (KLUN) LXWEIGHT
IF (LXWEIGHT) THEN
  WRITE (KLUN) LBOUND (SELF%XWEIGHT)
  WRITE (KLUN) UBOUND (SELF%XWEIGHT)
  WRITE (KLUN) SELF%XWEIGHT
ENDIF
WRITE (KLUN) SELF%NDIAM
WRITE (KLUN) SELF%XFACTNUC_DEP
WRITE (KLUN) SELF%XFACTNUC_CON
WRITE (KLUN) SELF%XNDEBRIS_CIBU
WRITE (KLUN) SELF%LACTI
WRITE (KLUN) SELF%LSEDC
WRITE (KLUN) SELF%LACTIT
WRITE (KLUN) SELF%LDEPOC
WRITE (KLUN) SELF%LACTTKE
WRITE (KLUN) SELF%LADJ
WRITE (KLUN) SELF%LSPRO
WRITE (KLUN) SELF%LKHKO
WRITE (KLUN) SELF%LKESSLERAC
WRITE (KLUN) SELF%NMOM_C
WRITE (KLUN) SELF%NMOM_R
WRITE (KLUN) SELF%NMOD_CCN
WRITE (KLUN) SELF%XCCN_CONC
WRITE (KLUN) SELF%LCCN_HOM
WRITE (KLUN) SELF%CCCN_MODES
LXR_MEAN_CCN = ALLOCATED (SELF%XR_MEAN_CCN)
WRITE (KLUN) LXR_MEAN_CCN
IF (LXR_MEAN_CCN) THEN
  WRITE (KLUN) LBOUND (SELF%XR_MEAN_CCN)
  WRITE (KLUN) UBOUND (SELF%XR_MEAN_CCN)
  WRITE (KLUN) SELF%XR_MEAN_CCN
ENDIF
LXLOGSIG_CCN = ALLOCATED (SELF%XLOGSIG_CCN)
WRITE (KLUN) LXLOGSIG_CCN
IF (LXLOGSIG_CCN) THEN
  WRITE (KLUN) LBOUND (SELF%XLOGSIG_CCN)
  WRITE (KLUN) UBOUND (SELF%XLOGSIG_CCN)
  WRITE (KLUN) SELF%XLOGSIG_CCN
ENDIF
LXRHO_CCN = ALLOCATED (SELF%XRHO_CCN)
WRITE (KLUN) LXRHO_CCN
IF (LXRHO_CCN) THEN
  WRITE (KLUN) LBOUND (SELF%XRHO_CCN)
  WRITE (KLUN) UBOUND (SELF%XRHO_CCN)
  WRITE (KLUN) SELF%XRHO_CCN
ENDIF
LXKHEN_MULTI = ALLOCATED (SELF%XKHEN_MULTI)
WRITE (KLUN) LXKHEN_MULTI
IF (LXKHEN_MULTI) THEN
  WRITE (KLUN) LBOUND (SELF%XKHEN_MULTI)
  WRITE (KLUN) UBOUND (SELF%XKHEN_MULTI)
  WRITE (KLUN) SELF%XKHEN_MULTI
ENDIF
LXMUHEN_MULTI = ALLOCATED (SELF%XMUHEN_MULTI)
WRITE (KLUN) LXMUHEN_MULTI
IF (LXMUHEN_MULTI) THEN
  WRITE (KLUN) LBOUND (SELF%XMUHEN_MULTI)
  WRITE (KLUN) UBOUND (SELF%XMUHEN_MULTI)
  WRITE (KLUN) SELF%XMUHEN_MULTI
ENDIF
LXBETAHEN_MULTI = ALLOCATED (SELF%XBETAHEN_MULTI)
WRITE (KLUN) LXBETAHEN_MULTI
IF (LXBETAHEN_MULTI) THEN
  WRITE (KLUN) LBOUND (SELF%XBETAHEN_MULTI)
  WRITE (KLUN) UBOUND (SELF%XBETAHEN_MULTI)
  WRITE (KLUN) SELF%XBETAHEN_MULTI
ENDIF
LXCONC_CCN_TOT = ALLOCATED (SELF%XCONC_CCN_TOT)
WRITE (KLUN) LXCONC_CCN_TOT
IF (LXCONC_CCN_TOT) THEN
  WRITE (KLUN) LBOUND (SELF%XCONC_CCN_TOT)
  WRITE (KLUN) UBOUND (SELF%XCONC_CCN_TOT)
  WRITE (KLUN) SELF%XCONC_CCN_TOT
ENDIF
LXLIMIT_FACTOR = ALLOCATED (SELF%XLIMIT_FACTOR)
WRITE (KLUN) LXLIMIT_FACTOR
IF (LXLIMIT_FACTOR) THEN
  WRITE (KLUN) LBOUND (SELF%XLIMIT_FACTOR)
  WRITE (KLUN) UBOUND (SELF%XLIMIT_FACTOR)
  WRITE (KLUN) SELF%XLIMIT_FACTOR
ENDIF
WRITE (KLUN) SELF%XALPHAR
WRITE (KLUN) SELF%XNUR
WRITE (KLUN) SELF%XALPHAC
WRITE (KLUN) SELF%XNUC
WRITE (KLUN) SELF%HPARAM_CCN
WRITE (KLUN) SELF%HINI_CCN
WRITE (KLUN) SELF%HTYPE_CCN
WRITE (KLUN) SELF%XFSOLUB_CCN
WRITE (KLUN) SELF%XACTEMP_CCN
WRITE (KLUN) SELF%XAERDIFF
WRITE (KLUN) SELF%XAERHEIGHT
WRITE (KLUN) SELF%XVDEPOC
WRITE (KLUN) SELF%LSCAV
WRITE (KLUN) SELF%LAERO_MASS
WRITE (KLUN) SELF%NDIAMR
WRITE (KLUN) SELF%NDIAMP
WRITE (KLUN) SELF%XT0SCAV
WRITE (KLUN) SELF%XTREF
WRITE (KLUN) SELF%XNDO
WRITE (KLUN) SELF%XMUA0
WRITE (KLUN) SELF%XT_SUTH_A
WRITE (KLUN) SELF%XMFPA0
WRITE (KLUN) SELF%XVISCW
WRITE (KLUN) SELF%XRHO00
WRITE (KLUN) SELF%XCEXVT
LXRTMIN = ALLOCATED (SELF%XRTMIN)
WRITE (KLUN) LXRTMIN
IF (LXRTMIN) THEN
  WRITE (KLUN) LBOUND (SELF%XRTMIN)
  WRITE (KLUN) UBOUND (SELF%XRTMIN)
  WRITE (KLUN) SELF%XRTMIN
ENDIF
LXCTMIN = ALLOCATED (SELF%XCTMIN)
WRITE (KLUN) LXCTMIN
IF (LXCTMIN) THEN
  WRITE (KLUN) LBOUND (SELF%XCTMIN)
  WRITE (KLUN) UBOUND (SELF%XCTMIN)
  WRITE (KLUN) SELF%XCTMIN
ENDIF
WRITE (KLUN) SELF%NSPLITSED
WRITE (KLUN) SELF%XLB
WRITE (KLUN) SELF%XLBEX
WRITE (KLUN) SELF%XD
WRITE (KLUN) SELF%XFSEDR
WRITE (KLUN) SELF%XFSEDC
END SUBROUTINE

END SUBMODULE
