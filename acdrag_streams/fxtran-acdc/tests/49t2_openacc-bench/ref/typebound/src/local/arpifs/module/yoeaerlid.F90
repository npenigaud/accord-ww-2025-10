MODULE YOEAERLID

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*    ** *YOEAERLID* - PARAMETERS AND COEFFICIENTS FOR GEMS/MACC LIDAR 
!                      SIMULATOR OF AEROSOL EFFECTS
!     ------------------------------------------------------------------
!
!     JJMorcrette, 20090702

TYPE :: TEAERLID
INTEGER(KIND=JPIM) :: NAELID
INTEGER(KIND=JPIM) :: NWLID, NAERLISI, JWLID(3)
REAL(KIND=JPRB) :: RWLID(3)
REAL(KIND=JPRB) :: RLICO2(6)
REAL(KIND=JPRB) :: RLIO2(6)
REAL(KIND=JPRB) :: RLINO2(5,3)
REAL(KIND=JPRB) :: RLIO3(5,3)

REAL(KIND=JPRB) :: RLICLS, RLIDELT, RLINS, RLIPREF, RLITREF, RLIT0
REAL(KIND=JPRB) :: RLIDDZ
!---------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TEAERLID
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TEAERLID
PROCEDURE :: ACDC_HOST => ACDC_HOST_TEAERLID
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TEAERLID
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TEAERLID
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TEAERLID
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TEAERLID
END TYPE TEAERLID
!=====================================================================

TYPE(TEAERLID), POINTER :: YREAERLID => NULL()

!     ------------------------------------------------------------------
! NWLID   : NUMBER OF WAVELENGTHS IN THE LIDAR SIMULATOR
! NAERLISI: =1: 1./(Lidar Ratio); =2: Lidar Ratio
! JWLID   : INDICES OF WAVELENGTHS FOR LIDAR SIMULATOR
! RWLID   : WAVELENGTHS FOR LIDAR SIMULATOR
! RLICLS  : CALIBRATION FACTOR FOR LIDAR 
! RLICO2  : CO2 ABSORPTION COEFFICIENTS (MALKMUS MODEL) 
! RLIO2   : O2 ABSORPTION COEFFCIENTS   (MALKMUS MODEL)
! RLINO2  : NO2 ABSORPTION CROSS-SECTION (CM2/MOLEC)
! RLIO3   : O3 ABSORPTION CROSS-SECTION (CM2/MOLEC)
! RLIDELT : PARAMETER IN EXPRESSION OF RAYLEIGH SCATTERING OPTICAL THICKNESS
! RLINS   : PARAMETER IN EXPRESSION OF RAYLEIGH SCATTERING OPTICAL THICKNESS
! RLIPREF : REFERENCE PRESSURE (RAYLEIGH)
! RLITREF : REFERENCE TEMPERATURE (RAYLEIGH)
! RLIT0   : REFERENCE TEMPERATURE (MALKMUS MODEL)
!     ------------------------------------------------------------------

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TEAERLID (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEAERLID), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TEAERLID (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TEAERLID), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TEAERLID (SELF)

IMPLICIT NONE
CLASS (TEAERLID), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TEAERLID (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TEAERLID), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TEAERLID (SELF, KLUN)

IMPLICIT NONE
CLASS (TEAERLID), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TEAERLID (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TEAERLID),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TEAERLID (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEAERLID), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TEAERLID), INTENT(IN) :: SELF
INTEGER     , INTENT(IN) :: KDEPTH
INTEGER     , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_aer%yreaerlid : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NAELID = ', SELF%NAELID
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NWLID = ', SELF%NWLID
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NAERLISI = ', SELF%NAERLISI
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'JWLID sum = ', SUM(SELF%JWLID)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RWLID sum = ', SUM(SELF% RWLID)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLICO2 sum =', SUM(SELF%RLICO2)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIO2 sum = ', SUM(SELF%RLIO2)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLINO2 sum = ',SUM(SELF%RLINO2)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIO3 sum = ', SUM(SELF%RLIO3)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLICLS = ', SELF%RLICLS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIDELT = ', SELF%RLIDELT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLINS = ', SELF%RLINS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIPREF = ', SELF%RLIPREF
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLITREF = ', SELF%RLITREF
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIT0 = ', SELF%RLIT0
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLIDDZ = ', SELF%RLIDDZ

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOEAERLID
