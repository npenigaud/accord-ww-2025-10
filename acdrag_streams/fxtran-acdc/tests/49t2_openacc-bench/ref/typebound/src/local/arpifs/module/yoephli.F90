! (C) Copyright 1988- ECMWF.
!
! This software is licensed under the terms of the Apache Licence Version 2.0
! which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
!
! In applying this licence, ECMWF does not waive the privileges and immunities
! granted to it by virtue of its status as an intergovernmental organisation
! nor does it submit to any jurisdiction.

MODULE YOEPHLI

!$ACDC methods 


USE PARKIND1  ,ONLY : JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*    ** *YOEPHLI* CONTAINS CONSTANTS FOR THE LINEARIZED PHYSICS
!     ------------------------------------------------------------------

TYPE :: TEPHLI
LOGICAL :: LTLEVOL
LOGICAL :: LPHYLIN
LOGICAL :: LPHYSFCLIN
LOGICAL :: LENOPERT
LOGICAL :: LEPPCFLS
LOGICAL :: LRAISANEN
LOGICAL :: LOPPTWINS

REAL(KIND=JPRB) :: RLPTRC
REAL(KIND=JPRB) :: RLPAL1
REAL(KIND=JPRB) :: RLPAL2
REAL(KIND=JPRB) :: RLPBB
REAL(KIND=JPRB) :: RLPCC
REAL(KIND=JPRB) :: RLPDD
REAL(KIND=JPRB) :: RLPMIXL
REAL(KIND=JPRB) :: RLPBETA
REAL(KIND=JPRB) :: RLPDRAG
REAL(KIND=JPRB) :: RLPEVAP
REAL(KIND=JPRB) :: RLPP00
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TEPHLI
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TEPHLI
PROCEDURE :: ACDC_HOST => ACDC_HOST_TEPHLI
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TEPHLI
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TEPHLI
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TEPHLI
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TEPHLI
END TYPE TEPHLI
!============================================================================

TYPE(TEPHLI), POINTER :: YREPHLI => NULL()



!*     *YOEPHLI* CONTAINS CONSTANTS NEEDED BY 
!     THE LINEARIZED PHYSICS

!     J.F. MAHFOUF        E.C.M.W.F.    23/06/96

!     NAME        TYPE     DESCRIPTION
!     ----        ----     -----------

!     *RLPTRC*    REAL     CRITICAL TEMPERATURE FOR MIXED PHASE PROPERTIES
!                          OF WATER 
!     *RLPAL1*    REAL     SMOOTHING COEFFICIENT
!     *RLPAL2*    REAL     SMOOTHING COEFFICIENT
!     *RLPBB*     REAL     CONSTANT FROM THE LOUIS ET AL. FORMULATION
!     *RLPCC*     REAL     CONSTANT FROM THE LOUIS ET AL. FORMULATION
!     *RLPDD*     REAL     CONSTANT FROM THE LOUIS ET AL. FORMULATION
!     *RLPMIXL*   REAL     PSEUDO DEPTH OF THE PLANETARY BOUNDARY LAYER
!     *RLPBETA*   REAL     REDUCTION FACTOR OF THE ASYMPTOTIC MIXING LENGTH
!     *RLPDRAG*   REAL     COEFFICIENT FOR THE ESTIMATION OF SURFACE DRAG
!     *RLPEVAP*   REAL     FRACTION OF POSSIBLE RAINFALL EVAPORATION
!     *RLPP00*    REAL     PRESSURE ABOVE WHICH RADIATION IS NOT APPLIED
!     *LTLEVOL*   LOGICAL  SWITCH FOR TL EVOLUTION OF PERTURBATION RUN
!     *LPHYLIN*   LOGICAL  TRUE WHEN LINEARIZED PHYSICS IS ACTIVATED 
!     *LENOPERT   LOGICAL  TRUE WHEN NO PERTURBATION IS REQUIRED
!                          FOR SURFACE ARRAYS
!     *LEPPCFLS   LOGICAL  TRUE WHEN POST-PROCESSING OF SURFACE FIELDS 
!                          REQUIRED
!     *LRAISANEN  LOGICAL  TRUE WHEN RAISANEN OVERLAP SCHEME IS
!                          ACTIVATED
!     *LOPPTWINS* LOGICAL  TRUE FOR RUNNING OPPOSITE TWINS (BOTH NL AND TL)
!     ------------------------------------------------------------------

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TEPHLI (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEPHLI), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TEPHLI (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TEPHLI), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TEPHLI (SELF)

IMPLICIT NONE
CLASS (TEPHLI), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TEPHLI (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TEPHLI), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TEPHLI (SELF, KLUN)

IMPLICIT NONE
CLASS (TEPHLI), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TEPHLI (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TEPHLI),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TEPHLI (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEPHLI), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TEPHLI), INTENT(IN) :: SELF
INTEGER      , INTENT(IN) :: KDEPTH
INTEGER      , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_slin%yrephli : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LTLEVOL = ', SELF%LTLEVOL
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LPHYLIN = ', SELF%LPHYLIN
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LENOPERT = ', SELF%LENOPERT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEPPCFLS = ', SELF%LEPPCFLS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LRAISANEN = ', SELF%LRAISANEN
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPTRC = ', SELF%RLPTRC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPAL1 = ', SELF%RLPAL1
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPAL2 = ', SELF%RLPAL2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPBB = ', SELF%RLPBB
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPCC = ', SELF%RLPCC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPDD = ', SELF%RLPDD
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPMIXL = ', SELF%RLPMIXL
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPBETA = ', SELF%RLPBETA
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPDRAG = ', SELF%RLPDRAG
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPEVAP = ', SELF%RLPEVAP
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLPP00 = ', SELF%RLPP00

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOEPHLI
