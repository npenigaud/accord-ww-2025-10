SUBMODULE (YOEWCOU) YOEWCOU_TEWCOU_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TEWCOU (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TEWCOU), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) SELF%NATMFLX
READ (KLUN) SELF%NGAUSSW
READ (KLUN) SELF%NLONW
READ (KLUN) SELF%NLATW
READ (KLUN) SELF%NLON1W
READ (KLUN) SELF%NLAT1W
READ (KLUN) SELF%NNORXW
READ (KLUN) SELF%NSTPW
READ (KLUN) SELF%NGRIB_HANDLE_FOR_WAM
READ (KLUN) ZTMP0
SELF%RSOUTW = ZTMP0
READ (KLUN) ZTMP0
SELF%RNORTW = ZTMP0
READ (KLUN) ZTMP0
SELF%RDEGREW = ZTMP0
READ (KLUN) ZTMP0
SELF%RMISSW = ZTMP0
READ (KLUN) SELF%LWCOU
READ (KLUN) SELF%LWCOU2W
READ (KLUN) SELF%LWCOUNORMS
READ (KLUN) SELF%LWCUR
READ (KLUN) SELF%LWCOURNW
READ (KLUN) SELF%LWCOUHMF
READ (KLUN) SELF%LWSTOKES
READ (KLUN) SELF%LWFLUX
READ (KLUN) SELF%CBEGDAT
READ (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MASK_WAVE_IN (IL1(1):IU1(1)))
  READ (KLUN) SELF%MASK_WAVE_IN
ENDIF
READ (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%MASK_WAVE_OUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%MASK_WAVE_OUT
ENDIF
READ (KLUN) SELF%LWVIN_MASK_NOT_SET
READ (KLUN) SELF%LWVOUT_MASK_NOT_SET
READ (KLUN) SELF%LWVIN_UNINITIALISED
READ (KLUN) SELF%MWVIN_SENDTOT
READ (KLUN) SELF%MWVIN_RECVTOT
READ (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDCNT (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDCNT
ENDIF
READ (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVCNT (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVCNT
ENDIF
READ (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDOFF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDOFF
ENDIF
READ (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVOFF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVOFF
ENDIF
READ (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDBUF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDBUF
ENDIF
READ (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVBUF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVBUF
ENDIF
READ (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDIND (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDIND
ENDIF
READ (KLUN) SELF%LWFRSTIME
READ (KLUN) SELF%LWINIT
READ (KLUN) SELF%NADV_WAVE
READ (KLUN) SELF%NWV_W2IWGHT
READ (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%IWV_LON (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%IWV_LON
ENDIF
READ (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%IWV_LAT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%IWV_LAT
ENDIF
READ (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%WV_W2IWGHT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%WV_W2IWGHT,1):UBOUND(SELF%WV_W2IWGHT,1), LBOUND(SELF%WV_W2IWGHT,2):UBOUND(SELF%WV_W2IWGHT,2)))
  READ (KLUN) ZTMP2
  SELF%WV_W2IWGHT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE

END SUBMODULE
