SUBMODULE (SPP_GEN_MOD) SPP_GEN_MOD_SPP_MODEL_SIZE_SMOD

IMPLICIT NONE

CONTAINS

MODULE FUNCTION ACDC_SIZE_SPP_MODEL (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (SPP_MODEL),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
INTEGER :: J1
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%VERSION) * LEN (SELF%VERSION)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VERSION'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%DEFINED_PERTS) * SIZE (SELF%DEFINED_PERTS) * LEN (SELF%DEFINED_PERTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%DEFINED_PERTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ACTIVE_PERTS) * SIZE (SELF%ACTIVE_PERTS) * LEN (SELF%ACTIVE_PERTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ACTIVE_PERTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDEF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDEF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NACT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NACT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRFTOTAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRFTOTAL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRFTOTAL_RADGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRFTOTAL_RADGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSEED_OFF) * SIZE (SELF%NSEED_OFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSEED_OFF'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
DO J1 = LBOUND (SELF%PNDEF, 1), UBOUND (SELF%PNDEF, 1)
  ISIZE = SELF%PNDEF (J1)%ACDC_SIZE (CLPATH//'%PNDEF', .FALSE.)
  JSIZE = JSIZE + ISIZE
  KSIZE = KSIZE + ISIZE
ENDDO
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%PNDEF'
ENDIF
JSIZE = 0
DO J1 = LBOUND (SELF%PN, 1), UBOUND (SELF%PN, 1)
  ISIZE = SELF%PN (J1)%ACDC_SIZE (CLPATH//'%PN', .FALSE.)
  JSIZE = JSIZE + ISIZE
  KSIZE = KSIZE + ISIZE
ENDDO
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%PN'
ENDIF
ISIZE = KIND (SELF%TAU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XLCOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XLCOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%SDEV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SDEV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%KSEED_OFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KSEED_OFF'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END SUBMODULE
