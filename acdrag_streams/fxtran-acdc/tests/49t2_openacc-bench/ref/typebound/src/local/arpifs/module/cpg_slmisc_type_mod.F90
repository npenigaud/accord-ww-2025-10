MODULE CPG_SLMISC_TYPE_MOD

!$ACDC methods --methods-list=host,wipe,copy --skip-components cpg --field-api --field-api-class cpg


USE PARKIND1, ONLY : JPRB, JPIM
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_REGISTRY_MOD

IMPLICIT NONE

TYPE CPG_SLMISC_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SLHDA (:) => NULL () 
  CLASS (FIELD_2RB), POINTER :: F_SLHDA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SLHDD0 (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_SLHDD0 => NULL ()
  INTEGER(KIND=JPIM), POINTER, CONTIGUOUS :: ISETTLOFF (:,:) => NULL ()
  CLASS (FIELD_3IM), POINTER :: F_ISETTLOFF => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_SLMISC_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_SLMISC_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SLMISC_TYPE_FINAL
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SLMISC_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SLMISC_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SLMISC_TYPE
END TYPE CPG_SLMISC_TYPE

INTERFACE

MODULE SUBROUTINE ACDC_COPY_CPG_SLMISC_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SLMISC_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SLMISC_TYPE (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SLMISC_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SLMISC_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SLMISC_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE CPG_SLMISC_TYPE_INIT (SELF, REGISTRY, NLEV, PSLHDA, PSLHDD0)

CLASS (CPG_SLMISC_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),            INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),              INTENT (IN)    :: NLEV
REAL (KIND=JPRB),   TARGET,       INTENT (IN)    :: PSLHDA (:,:) 
REAL (KIND=JPRB),   TARGET,       INTENT (IN)    :: PSLHDD0 (:,:) 


CALL FIELD_NEW (SELF%F_SLHDA    , DATA=PSLHDA)
CALL FIELD_NEW (SELF%F_SLHDD0   , DATA=PSLHDD0)
CALL FIELD_NEW (SELF%F_ISETTLOFF, UBOUNDS=[REGISTRY%GEOM%YRDIM%NPROMA, NLEV, REGISTRY%GEOM%YRDIM%NGPBLKS], PERSISTENT=.TRUE.)

END SUBROUTINE CPG_SLMISC_TYPE_INIT

SUBROUTINE CPG_SLMISC_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SLMISC_TYPE)              :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_SLHDA))       SELF%SLHDA     => SELF%F_SLHDA%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_SLHDD0))      SELF%SLHDD0    => SELF%F_SLHDD0%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_ISETTLOFF))   SELF%ISETTLOFF => SELF%F_ISETTLOFF%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_SLMISC_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SLMISC_TYPE_FINAL (SELF)

CLASS (CPG_SLMISC_TYPE)              :: SELF

IF (ASSOCIATED (SELF%F_SLHDA))     CALL FIELD_DELETE (SELF%F_SLHDA)
IF (ASSOCIATED (SELF%F_SLHDD0))    CALL FIELD_DELETE (SELF%F_SLHDD0)
IF (ASSOCIATED (SELF%F_ISETTLOFF)) CALL FIELD_DELETE (SELF%F_ISETTLOFF)

SELF%F_SLHDA  => NULL () 
SELF%F_SLHDD0  => NULL ()
SELF%F_ISETTLOFF => NULL ()

SELF%SLHDA  => NULL () 
SELF%SLHDD0  => NULL ()
SELF%ISETTLOFF => NULL ()

END SUBROUTINE CPG_SLMISC_TYPE_FINAL

END MODULE CPG_SLMISC_TYPE_MOD



