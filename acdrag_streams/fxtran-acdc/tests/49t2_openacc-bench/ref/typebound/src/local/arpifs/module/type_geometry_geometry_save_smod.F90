SUBMODULE (TYPE_GEOMETRY) TYPE_GEOMETRY_GEOMETRY_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_GEOMETRY (SELF, KLUN)

IMPLICIT NONE
CLASS (GEOMETRY), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
WRITE (KLUN) SELF%LNHX_GEOM
CALL SELF%YRVERT_GEOM%ACDC_SAVE (KLUN)
CALL SELF%YRSTA%ACDC_SAVE (KLUN)
CALL SELF%YRLAP%ACDC_SAVE (KLUN)
CALL SELF%YRCSGLEG%ACDC_SAVE (KLUN)
CALL SELF%YRDIM%ACDC_SAVE (KLUN)
CALL SELF%YRDIMV%ACDC_SAVE (KLUN)
CALL SELF%YRMP%ACDC_SAVE (KLUN)
CALL SELF%YRGEM%ACDC_SAVE (KLUN)
WRITE (KLUN) SELF%AD_GEOM
CALL SELF%YROROG_B%ACDC_SAVE (KLUN)
CALL SELF%YSPGEOM%ACDC_SAVE (KLUN)
CALL SELF%YVABIO%ACDC_SAVE (KLUN)
CALL SELF%YREDIM%ACDC_SAVE (KLUN)
CALL SELF%YREGEO%ACDC_SAVE (KLUN)
CALL SELF%YREMP%ACDC_SAVE (KLUN)
CALL SELF%YRELAP%ACDC_SAVE (KLUN)
CALL SELF%YREGSL%ACDC_SAVE (KLUN)
LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
WRITE (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  CALL SELF%YRELBC_GEO%ACDC_SAVE (KLUN)
ENDIF
END SUBROUTINE

END SUBMODULE
