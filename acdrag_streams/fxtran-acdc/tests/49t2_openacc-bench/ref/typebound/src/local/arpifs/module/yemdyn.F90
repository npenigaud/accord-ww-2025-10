MODULE YEMDYN

!$ACDC methods 


USE PARKIND1  ,ONLY : JPRB

IMPLICIT NONE

SAVE

TYPE  :: TEDYN
!     ------------------------------------------------------------------

!===========   MAIN HORIZONTAL DIFFUSION SCHEME  ==============================

! * LEVEL AND WAVENUMBER DEPENDENT INVERSE CHARACTERISTIC TIMES:
! RDIVORE  : for diffusion of vorticity.
! RDIDIVE  : for diffusion of divergence.
! RDITE    : for diffusion of temperature.
! RDIGFLE  : for diffusion of GFL vars.
! RDIPDE   : for diffusion of pressure departure (NH).
! RDIVDE   : for diffusion of vertical divergence (NH).
! RDISPE   : for diffusion of surface pressure.

REAL(KIND=JPRB),ALLOCATABLE:: RDIVORE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDIDIVE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDITE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDIGFLE(:,:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDIPDE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDIVDE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDISPE(:)

!===========   ADDITIONAL HORIZONTAL DIFFUSION SCHEME FOR SLHD  ===============

! * LEVEL AND WAVENUMBER DEPENDENT INVERSE CHARACTERISTIC TIMES:
! RDSVORE  : for diffusion of vorticity.
! RDSDIVE  : for diffusion of divergence.
! RDSVDE   : for diffusion of vertical divergence (NH).

REAL(KIND=JPRB),ALLOCATABLE:: RDSVORE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDSDIVE(:,:)
REAL(KIND=JPRB),ALLOCATABLE:: RDSVDE(:,:)

!===========   "LGRADSP" OPTION  ==============================================

! REFILV: for filtering of vorticity.
! REFILD: for filtering of pressure departure.
REAL(KIND=JPRB),ALLOCATABLE :: REFILV(:,:)
REAL(KIND=JPRB),ALLOCATABLE :: REFILD(:,:)

!===========   SEMI-IMPLICIT SCHEME ===========================================

! LESIDG   : .F.: Semi-implicit-scheme with reduced divergence.
!            .T.: Semi-implicit scheme with not reduced divergence.
! RTHRESIDG: threshold on RSTRET for activation of LESIDG option

LOGICAL :: LESIDG
REAL(KIND=JPRB) :: RTHRESIDG

!===========   LAM MODEL MASS CORRECTOR =======================================

! * XMALD:  imposed dry air mass for mass corrector in LAM models

REAL(KIND=JPRB) :: XMALD

!===========   MISCELLANEOUS  =================================================

! TCDIS    : ??? (no comment provided, used in the transform package).

REAL(KIND=JPRB) :: TCDIS

CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_TEDYN
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TEDYN
PROCEDURE :: ACDC_HOST => ACDC_HOST_TEDYN
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TEDYN
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TEDYN
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TEDYN
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TEDYN
END TYPE TEDYN

!     ------------------------------------------------------------------
INTERFACE

MODULE SUBROUTINE ACDC_COPY_TEDYN (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TEDYN (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TEDYN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TEDYN (SELF)

IMPLICIT NONE
CLASS (TEDYN), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TEDYN (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TEDYN), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TEDYN (SELF, KLUN)

IMPLICIT NONE
CLASS (TEDYN), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TEDYN (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TEDYN),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TEDYN (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

END MODULE YEMDYN
