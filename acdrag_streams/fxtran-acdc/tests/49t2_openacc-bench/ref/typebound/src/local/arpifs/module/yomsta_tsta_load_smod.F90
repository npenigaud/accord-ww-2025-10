SUBMODULE (YOMSTA) YOMSTA_TSTA_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TSTA (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TSTA), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LSTDEN, LSTPHI, LSTPRE, LSTPREH, LSTTEM, LSTZ, LSVETAF, LSVETAH
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LSTPREH
IF (LSTPREH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STPREH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STPREH,1):UBOUND(SELF%STPREH,1)))
  READ (KLUN) ZTMP1
  SELF%STPREH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSTPRE
IF (LSTPRE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STPRE (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STPRE,1):UBOUND(SELF%STPRE,1)))
  READ (KLUN) ZTMP1
  SELF%STPRE = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSTPHI
IF (LSTPHI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STPHI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STPHI,1):UBOUND(SELF%STPHI,1)))
  READ (KLUN) ZTMP1
  SELF%STPHI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSTTEM
IF (LSTTEM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STTEM (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STTEM,1):UBOUND(SELF%STTEM,1)))
  READ (KLUN) ZTMP1
  SELF%STTEM = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSTDEN
IF (LSTDEN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STDEN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STDEN,1):UBOUND(SELF%STDEN,1)))
  READ (KLUN) ZTMP1
  SELF%STDEN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSTZ
IF (LSTZ) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%STZ (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%STZ,1):UBOUND(SELF%STZ,1)))
  READ (KLUN) ZTMP1
  SELF%STZ = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSVETAH
IF (LSVETAH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SVETAH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SVETAH,1):UBOUND(SELF%SVETAH,1)))
  READ (KLUN) ZTMP1
  SELF%SVETAH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSVETAF
IF (LSVETAF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SVETAF (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SVETAF,1):UBOUND(SELF%SVETAF,1)))
  READ (KLUN) ZTMP1
  SELF%SVETAF = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

END SUBMODULE
