SUBROUTINE LARCINB_RRINTOPT (JFLD, YDCPG_BNDS, YDCPG_DDH_TND&
&, YDCPG_GFLF, YDGEOMETRY, YDLDDH, YDML_DYN)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE CPG_DDH_TND_TYPE_MOD,ONLY:CPG_DDH_TND_TYPE
USE CPG_GFL_TYPE_MOD,ONLY:CPG_GFL_TYPE, CPG_GFLSL_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE YOMLDDH,ONLY:TLDDH
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

INTEGER (KIND=JPIM), INTENT (INOUT)::JFLD
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_DDH_TND_TYPE), INTENT (INOUT)::YDCPG_DDH_TND
TYPE (CPG_GFL_TYPE), INTENT (INOUT)::YDCPG_GFLF
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TLDDH), INTENT (IN)::YDLDDH
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('LARCINB_RRINTOPT', 0, ZHOOK_HANDLE)

IF (YDML_DYN%YRDYN%RRINTOPT/=1._JPRB) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCPG_GFLF%GFL (JFLD)%P (JROF, JLEV)=YDCPG_GFLF%GFL (JFLD)%P (JROF, JLEV)*YDML_DYN%YRDYN%RRINTOPT
    ENDDO

  ENDDO

ENDIF


IF (YDLDDH%LRSLDDH) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCPG_DDH_TND%YSL%GFL (JFLD)%P (JROF, JLEV)=YDCPG_DDH_TND%YSL%GFL&
      & (JFLD)%P (JROF, JLEV)+YDCPG_GFLF%GFL (JFLD)%P (JROF, JLEV)
    ENDDO

  ENDDO

ENDIF

IF (LHOOK) CALL DR_HOOK ('LARCINB_RRINTOPT', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
