SUBROUTINE APL_ARPEGE_RADIATION_ACRANEB2 (YDCFU, YDCPG_BNDS, YDCPG_MISC, YDCPG_OPTS&
&, YDMF_PHYS, YDMF_PHYS_BASE_STATE, YDMF_PHYS_SURF, YDMODEL, YDVARS, PAER, PALBDIR,&
& PCLCT_RAD, PDECRD, PFLU_EMIS, PQCO2, PQO3, PQV, PRDG_MU0, PRDG_MU0LU, PFRSODS)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_GPAR_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE YOMCFU,ONLY:TCFU
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (TCFU), INTENT (IN)::YDCFU
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
REAL (KIND=JPRB), INTENT (IN)::PAER (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6)
REAL (KIND=JPRB), INTENT (IN)::PALBDIR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PCLCT_RAD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PDECRD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PFLU_EMIS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PQCO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQO3 (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PRDG_MU0 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PRDG_MU0LU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFRSODS (YDCPG_OPTS%KLON)
#include "acraneb2.intfb.h"
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_ACRANEB2', 0, ZHOOK_HANDLE)
CALL ACRANEB2 (YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF&
&, YDCPG_OPTS%LCONFX, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH&
&%NTRADI, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KLON, YDCPG_OPTS%NSTEP, YDCFU%NFRRC, YDMF_PHYS_BASE_STATE%YCPG_PHY&
&%PREHYD, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%CP, YDMF_PHYS_BASE_STATE&
&%YCPG_DYN%RCP%R, YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%DELP, YDCPG_MISC%NEB, PQV, PQCO2, YDCPG_MISC%QICE&
&, YDCPG_MISC%QLI, PQO3, YDMF_PHYS_BASE_STATE%T, YDMF_PHYS%OUT%ALB, PALBDIR, PFLU_EMIS, YDVARS%GEOMETRY&
&%GELAM%T0, YDVARS%GEOMETRY%GEMU%T0, PRDG_MU0, PRDG_MU0LU, YDMF_PHYS_BASE_STATE%YGSP_RR%T, PDECRD,&
& PCLCT_RAD, YDMF_PHYS%OPT%GDEOSI, YDMF_PHYS%OPT%GUEOSI, YDMF_PHYS%OPT%GMU0, YDMF_PHYS%OPT%GMU0_MIN&
&, YDMF_PHYS%OPT%GMU0_MAX, YDMF_PHYS%OPT%GDEOTI, YDMF_PHYS%OPT%GDEOTI2, YDMF_PHYS%OPT%GUEOTI, YDMF_PHYS&
&%OPT%GUEOTI2, YDMF_PHYS%OPT%GEOLT, YDMF_PHYS%OPT%GEOXT, YDMF_PHYS%OPT%GRPROX, YDMF_PHYS%OPT%GMIXP&
&, YDMF_PHYS%OPT%GFLUXC, YDMF_PHYS%OPT%GRSURF, YDMF_PHYS_SURF%GSD_VD%PSUND, YDMF_PHYS%OUT%FRSO, YDMF_PHYS&
&%OUT%FRTH, YDMF_PHYS%OUT%FRSOC, YDMF_PHYS%OUT%FRTHC, PFRSODS, YDMF_PHYS%OUT%FRSOPS, YDMF_PHYS%OUT&
&%FRSOLU, YDMF_PHYS%OUT%FRTHDS, PAER)

DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
  YDMF_PHYS%OUT%FRSODS (JLON)=PFRSODS (JLON)+YDMF_PHYS%OUT%FRSOPS (JLON)
ENDDO

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_ACRANEB2', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
