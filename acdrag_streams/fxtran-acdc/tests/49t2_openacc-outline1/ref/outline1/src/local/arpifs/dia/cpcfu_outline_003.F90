SUBROUTINE CPCFU_OUTLINE_003 (LDFRRC, LDNORESET, LDRESET&
&, KTIME, YDCFU, YDCPG_BNDS, YDMF_PHYS_OUT, YDRIP)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE YOMCFU,ONLY:TCFU
USE YOMRIP,ONLY:TRIP
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDFRRC
LOGICAL, INTENT (INOUT)::LDNORESET
LOGICAL, INTENT (INOUT)::LDRESET
INTEGER (KIND=JPIM), INTENT (INOUT)::KTIME
TYPE (TCFU), INTENT (INOUT)::YDCFU
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (TRIP), INTENT (IN)::YDRIP
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_003', 0, ZHOOK_HANDLE)

IF (YDCFU%YFRSODS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSODS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSODS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSODS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSODS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSDNI%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSDNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSDNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSDNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSDNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSGNI%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSGNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSGNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSGNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSGNI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSOPS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSOPS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSOPS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSOPS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSOPS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSOPT%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSOPT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSOPT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSOPT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSOPT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRTHDS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRTHDS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRTHDS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRTHDS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRTHDS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSOLU%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSOLU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FRSOLU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSOLU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSOLU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YNEBCON%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%NEBCON (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%NEBCON (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%NEBCON (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%CLCC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YNEBHAU%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%NEBHAU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%NEBHAU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%NEBHAU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%CLCH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YNEBMOY%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%NEBMOY (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%NEBMOY (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%NEBMOY (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%CLCM (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YNEBBAS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%NEBBAS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%NEBBAS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%NEBBAS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%CLCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSOC0%LACTIVE.AND.LDFRRC) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSOC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  KTIME=YDCFU%NFRRC
  YDCFU%FRSOC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSOC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSOC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 0)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRSOC1%LACTIVE.AND.LDFRRC) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRSOC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  KTIME=YDCFU%NFRRC
  YDCFU%FRSOC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRSOC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRSOC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRTHC0%LACTIVE.AND.LDFRRC) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRTHC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  KTIME=YDCFU%NFRRC
  YDCFU%FRTHC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRTHC0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRTHC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 0)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFRTHC1%LACTIVE.AND.LDFRRC) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FRTHC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  KTIME=YDCFU%NFRRC
  YDCFU%FRTHC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FRTHC1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRTHC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFLASH%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FLASH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FLASH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FLASH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FLASH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YLOADSNOW%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%LOADSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%LOADSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%LOADSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%LOADSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YLOADICE%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%LOADICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%LOADICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%LOADICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%LOADICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YDIAMACCR%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%DIAMACCR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%DIAMACCR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%DIAMACCR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%DIAMACCR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YPCPWSNOW%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%PCPWSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%PCPWSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%PCPWSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%PCPWSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YPCPICE%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%PCPICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%PCPICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%PCPICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%PCPICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_003', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
