SUBROUTINE GPMPFC_EXPL_PART2 (YDVARS, YDCPG_OPTS, YDCPG_BNDS, PGM)

!$ACDC outline1    


USE PARKIND1, ONLY : JPIM, JPRB
USE YOMHOOK,  ONLY: LHOOK, JPHOOK, DR_HOOK

USE MODEL_GENERAL_CONF_MOD , ONLY : MODEL_GENERAL_CONF_TYPE
USE FIELD_VARIABLES_MOD    , ONLY : FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD      , ONLY : CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE

TYPE(FIELD_VARIABLES), INTENT(INOUT) :: YDVARS
TYPE(CPG_OPTS_TYPE)  , INTENT(IN)    :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE)  , INTENT(IN)    :: YDCPG_BNDS
REAL(KIND=JPRB)      , INTENT(IN)    :: PGM (YDCPG_OPTS%KLON)

INTEGER (KIND=JPIM) :: JFLD
INTEGER (KIND=JPIM) :: JLEV
INTEGER (KIND=JPIM) :: JROF

REAL(KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK("GPMPFC_EXPL_PART2",0,ZHOOK_HANDLE)

DO JFLD = 1, SIZE (YDVARS%GFL_PTR)
  IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LCDERS) THEN

!$ACDC PARALLEL, TARGET=OpenMP/OpenMPSingleColumn/OpenACCSingleColumn {

    DO JLEV = 1, YDCPG_OPTS%KFLEVG
      DO JROF = YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
        YDVARS%GFL_PTR (JFLD)%DM (JROF,JLEV) = YDVARS%GFL_PTR (JFLD)%DM (JROF,JLEV) * PGM (JROF)
        YDVARS%GFL_PTR (JFLD)%DL (JROF,JLEV) = YDVARS%GFL_PTR (JFLD)%DL (JROF,JLEV) * PGM (JROF)
      ENDDO
    ENDDO

!$ACDC }

  ENDIF
ENDDO

IF (LHOOK) CALL DR_HOOK("GPMPFC_EXPL_PART2",1,ZHOOK_HANDLE)

END SUBROUTINE GPMPFC_EXPL_PART2
