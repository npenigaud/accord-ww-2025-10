MODULE FXTRAN_ACDC_GET_MPI_RANK_MOD

!
! Copyright 2025 Meteo-France
! All rights reserved
! philippe.marguinaud@meteo.fr
!

IMPLICIT NONE

CONTAINS

SUBROUTINE FXTRAN_ACDC_GET_MPI_RANK (KRANK)

INTEGER :: KRANK

CHARACTER*16 :: CLRANK

CLRANK = ''

CALL GETENV ("OMPI_COMM_WORLD_RANK", CLRANK)

IF (CLRANK /= '') THEN
  READ (CLRANK, *) KRANK
ELSE
  KRANK = -1
ENDIF

END SUBROUTINE

END MODULE
