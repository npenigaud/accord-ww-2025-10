SUBMODULE (VARIABLE_MODULE) VARIABLE_MODULE_VARIABLE_2RB_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_VARIABLE_2RB (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (VARIABLE_2RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
YLSUPER => SELF
CALL YLSUPER%ACDC_WIPE (LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (SELF%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FT0)
ENDIF

LFT1 = ASSOCIATED (SELF%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FT1)
ENDIF

LFT9 = ASSOCIATED (SELF%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FT9)
ENDIF

LFPH9 = ASSOCIATED (SELF%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FPH9)
ENDIF

LFDL = ASSOCIATED (SELF%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FDL)
ENDIF

LFDM = ASSOCIATED (SELF%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FDM)
ENDIF

LFDL9 = ASSOCIATED (SELF%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FDL9)
ENDIF

LFDM9 = ASSOCIATED (SELF%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (SELF%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (SELF%FPC_PH)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
