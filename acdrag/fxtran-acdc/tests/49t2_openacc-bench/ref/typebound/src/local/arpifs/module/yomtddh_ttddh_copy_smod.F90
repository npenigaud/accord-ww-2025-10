SUBMODULE (YOMTDDH) YOMTDDH_TTDDH_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_TTDDH (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCFLDNAMES2D, LCFLDNAMES3D, LCFLDTYPES2D, LCFLDTYPES3D, LHDCS0, LHDCS1, LHDCVB0, LHDCVB1, LPDDHFSVI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LHDCVB0 = ALLOCATED (SELF%HDCVB0)
IF (LHDCVB0) THEN
  !$ACC ENTER DATA CREATE (SELF%HDCVB0)
  !$ACC UPDATE DEVICE (SELF%HDCVB0)
  !$ACC ENTER DATA ATTACH (SELF%HDCVB0)
ENDIF

LHDCVB1 = ALLOCATED (SELF%HDCVB1)
IF (LHDCVB1) THEN
  !$ACC ENTER DATA CREATE (SELF%HDCVB1)
  !$ACC UPDATE DEVICE (SELF%HDCVB1)
  !$ACC ENTER DATA ATTACH (SELF%HDCVB1)
ENDIF

LHDCS0 = ALLOCATED (SELF%HDCS0)
IF (LHDCS0) THEN
  !$ACC ENTER DATA CREATE (SELF%HDCS0)
  !$ACC UPDATE DEVICE (SELF%HDCS0)
  !$ACC ENTER DATA ATTACH (SELF%HDCS0)
ENDIF

LHDCS1 = ALLOCATED (SELF%HDCS1)
IF (LHDCS1) THEN
  !$ACC ENTER DATA CREATE (SELF%HDCS1)
  !$ACC UPDATE DEVICE (SELF%HDCS1)
  !$ACC ENTER DATA ATTACH (SELF%HDCS1)
ENDIF

LPDDHFSVI = ALLOCATED (SELF%PDDHFSVI)
IF (LPDDHFSVI) THEN
  !$ACC ENTER DATA CREATE (SELF%PDDHFSVI)
  !$ACC UPDATE DEVICE (SELF%PDDHFSVI)
  !$ACC ENTER DATA ATTACH (SELF%PDDHFSVI)
ENDIF

LCFLDNAMES3D = ALLOCATED (SELF%CFLDNAMES3D)
IF (LCFLDNAMES3D) THEN
  !$ACC ENTER DATA CREATE (SELF%CFLDNAMES3D)
  !$ACC UPDATE DEVICE (SELF%CFLDNAMES3D)
  !$ACC ENTER DATA ATTACH (SELF%CFLDNAMES3D)
ENDIF

LCFLDTYPES3D = ALLOCATED (SELF%CFLDTYPES3D)
IF (LCFLDTYPES3D) THEN
  !$ACC ENTER DATA CREATE (SELF%CFLDTYPES3D)
  !$ACC UPDATE DEVICE (SELF%CFLDTYPES3D)
  !$ACC ENTER DATA ATTACH (SELF%CFLDTYPES3D)
ENDIF

LCFLDNAMES2D = ALLOCATED (SELF%CFLDNAMES2D)
IF (LCFLDNAMES2D) THEN
  !$ACC ENTER DATA CREATE (SELF%CFLDNAMES2D)
  !$ACC UPDATE DEVICE (SELF%CFLDNAMES2D)
  !$ACC ENTER DATA ATTACH (SELF%CFLDNAMES2D)
ENDIF

LCFLDTYPES2D = ALLOCATED (SELF%CFLDTYPES2D)
IF (LCFLDTYPES2D) THEN
  !$ACC ENTER DATA CREATE (SELF%CFLDTYPES2D)
  !$ACC UPDATE DEVICE (SELF%CFLDTYPES2D)
  !$ACC ENTER DATA ATTACH (SELF%CFLDTYPES2D)
ENDIF

END SUBROUTINE

END SUBMODULE
