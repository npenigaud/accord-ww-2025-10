SUBMODULE (YOMLAP) YOMLAP_TLAP_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_TLAP (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TLAP), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LMYMS, LNASM0, LNASM0G, LNASN0, LNSE0L, LNSPZERO, LNVALUE, LRLAPDI, LRLAPIN
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LNASN0 = ALLOCATED (SELF%NASN0)
IF (LNASN0) THEN
  !$ACC ENTER DATA CREATE (SELF%NASN0)
  !$ACC UPDATE DEVICE (SELF%NASN0)
  !$ACC ENTER DATA ATTACH (SELF%NASN0)
ENDIF

LNASM0 = ALLOCATED (SELF%NASM0)
IF (LNASM0) THEN
  !$ACC ENTER DATA CREATE (SELF%NASM0)
  !$ACC UPDATE DEVICE (SELF%NASM0)
  !$ACC ENTER DATA ATTACH (SELF%NASM0)
ENDIF

LNASM0G = ALLOCATED (SELF%NASM0G)
IF (LNASM0G) THEN
  !$ACC ENTER DATA CREATE (SELF%NASM0G)
  !$ACC UPDATE DEVICE (SELF%NASM0G)
  !$ACC ENTER DATA ATTACH (SELF%NASM0G)
ENDIF

LNVALUE = ALLOCATED (SELF%NVALUE)
IF (LNVALUE) THEN
  !$ACC ENTER DATA CREATE (SELF%NVALUE)
  !$ACC UPDATE DEVICE (SELF%NVALUE)
  !$ACC ENTER DATA ATTACH (SELF%NVALUE)
ENDIF

LMYMS = ALLOCATED (SELF%MYMS)
IF (LMYMS) THEN
  !$ACC ENTER DATA CREATE (SELF%MYMS)
  !$ACC UPDATE DEVICE (SELF%MYMS)
  !$ACC ENTER DATA ATTACH (SELF%MYMS)
ENDIF

LNSPZERO = ALLOCATED (SELF%NSPZERO)
IF (LNSPZERO) THEN
  !$ACC ENTER DATA CREATE (SELF%NSPZERO)
  !$ACC UPDATE DEVICE (SELF%NSPZERO)
  !$ACC ENTER DATA ATTACH (SELF%NSPZERO)
ENDIF

LNSE0L = ALLOCATED (SELF%NSE0L)
IF (LNSE0L) THEN
  !$ACC ENTER DATA CREATE (SELF%NSE0L)
  !$ACC UPDATE DEVICE (SELF%NSE0L)
  !$ACC ENTER DATA ATTACH (SELF%NSE0L)
ENDIF

LRLAPDI = ALLOCATED (SELF%RLAPDI)
IF (LRLAPDI) THEN
  !$ACC ENTER DATA CREATE (SELF%RLAPDI)
  !$ACC UPDATE DEVICE (SELF%RLAPDI)
  !$ACC ENTER DATA ATTACH (SELF%RLAPDI)
ENDIF

LRLAPIN = ALLOCATED (SELF%RLAPIN)
IF (LRLAPIN) THEN
  !$ACC ENTER DATA CREATE (SELF%RLAPIN)
  !$ACC UPDATE DEVICE (SELF%RLAPIN)
  !$ACC ENTER DATA ATTACH (SELF%RLAPIN)
ENDIF

END SUBROUTINE

END SUBMODULE
