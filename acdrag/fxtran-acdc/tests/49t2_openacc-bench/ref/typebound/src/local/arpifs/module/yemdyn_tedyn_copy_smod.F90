SUBMODULE (YEMDYN) YEMDYN_TEDYN_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_TEDYN (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LRDIVORE = ALLOCATED (SELF%RDIVORE)
IF (LRDIVORE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIVORE)
  !$ACC UPDATE DEVICE (SELF%RDIVORE)
  !$ACC ENTER DATA ATTACH (SELF%RDIVORE)
ENDIF

LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
IF (LRDIDIVE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIDIVE)
  !$ACC UPDATE DEVICE (SELF%RDIDIVE)
  !$ACC ENTER DATA ATTACH (SELF%RDIDIVE)
ENDIF

LRDITE = ALLOCATED (SELF%RDITE)
IF (LRDITE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDITE)
  !$ACC UPDATE DEVICE (SELF%RDITE)
  !$ACC ENTER DATA ATTACH (SELF%RDITE)
ENDIF

LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
IF (LRDIGFLE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIGFLE)
  !$ACC UPDATE DEVICE (SELF%RDIGFLE)
  !$ACC ENTER DATA ATTACH (SELF%RDIGFLE)
ENDIF

LRDIPDE = ALLOCATED (SELF%RDIPDE)
IF (LRDIPDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIPDE)
  !$ACC UPDATE DEVICE (SELF%RDIPDE)
  !$ACC ENTER DATA ATTACH (SELF%RDIPDE)
ENDIF

LRDIVDE = ALLOCATED (SELF%RDIVDE)
IF (LRDIVDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIVDE)
  !$ACC UPDATE DEVICE (SELF%RDIVDE)
  !$ACC ENTER DATA ATTACH (SELF%RDIVDE)
ENDIF

LRDISPE = ALLOCATED (SELF%RDISPE)
IF (LRDISPE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDISPE)
  !$ACC UPDATE DEVICE (SELF%RDISPE)
  !$ACC ENTER DATA ATTACH (SELF%RDISPE)
ENDIF

LRDSVORE = ALLOCATED (SELF%RDSVORE)
IF (LRDSVORE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSVORE)
  !$ACC UPDATE DEVICE (SELF%RDSVORE)
  !$ACC ENTER DATA ATTACH (SELF%RDSVORE)
ENDIF

LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
IF (LRDSDIVE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSDIVE)
  !$ACC UPDATE DEVICE (SELF%RDSDIVE)
  !$ACC ENTER DATA ATTACH (SELF%RDSDIVE)
ENDIF

LRDSVDE = ALLOCATED (SELF%RDSVDE)
IF (LRDSVDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSVDE)
  !$ACC UPDATE DEVICE (SELF%RDSVDE)
  !$ACC ENTER DATA ATTACH (SELF%RDSVDE)
ENDIF

LREFILV = ALLOCATED (SELF%REFILV)
IF (LREFILV) THEN
  !$ACC ENTER DATA CREATE (SELF%REFILV)
  !$ACC UPDATE DEVICE (SELF%REFILV)
  !$ACC ENTER DATA ATTACH (SELF%REFILV)
ENDIF

LREFILD = ALLOCATED (SELF%REFILD)
IF (LREFILD) THEN
  !$ACC ENTER DATA CREATE (SELF%REFILD)
  !$ACC UPDATE DEVICE (SELF%REFILD)
  !$ACC ENTER DATA ATTACH (SELF%REFILD)
ENDIF

END SUBROUTINE

END SUBMODULE
