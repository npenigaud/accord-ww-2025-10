SUBMODULE (YOMRADF) YOMRADF_TRADF_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TRADF (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TRADF), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) LEMTD
IF (LEMTD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTD,1):UBOUND(SELF%EMTD,1), LBOUND(SELF%EMTD,2):UBOUND(SELF%EMTD,2), LBOUND(SELF%EMTD,3):UBOUND(SELF%EMTD,3)))
  READ (KLUN) ZTMP3
  SELF%EMTD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTRSW
IF (LTRSW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%TRSW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%TRSW,1):UBOUND(SELF%TRSW,1), LBOUND(SELF%TRSW,2):UBOUND(SELF%TRSW,2), LBOUND(SELF%TRSW,3):UBOUND(SELF%TRSW,3)))
  READ (KLUN) ZTMP3
  SELF%TRSW = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LEMTC
IF (LEMTC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTC,1):UBOUND(SELF%EMTC,1), LBOUND(SELF%EMTC,2):UBOUND(SELF%EMTC,2), LBOUND(SELF%EMTC,3):UBOUND(SELF%EMTC,3)))
  READ (KLUN) ZTMP3
  SELF%EMTC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTRSC
IF (LTRSC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%TRSC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%TRSC,1):UBOUND(SELF%TRSC,1), LBOUND(SELF%TRSC,2):UBOUND(SELF%TRSC,2), LBOUND(SELF%TRSC,3):UBOUND(SELF%TRSC,3)))
  READ (KLUN) ZTMP3
  SELF%TRSC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LEMTU
IF (LEMTU) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTU (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTU,1):UBOUND(SELF%EMTU,1), LBOUND(SELF%EMTU,2):UBOUND(SELF%EMTU,2), LBOUND(SELF%EMTU,3):UBOUND(SELF%EMTU,3)))
  READ (KLUN) ZTMP3
  SELF%EMTU = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTAUAER
IF (LTAUAER) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%TAUAER (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%TAUAER,1):UBOUND(SELF%TAUAER,1), LBOUND(SELF%TAUAER,2):UBOUND(SELF%TAUAER,2), LBOUND(SELF%TAUAER,3):UBOUND(SELF%TAUAER,3), LBOUND(SELF%TAUAER,4):UBOUND(SELF%TAUAER,4)))
  READ (KLUN) ZTMP4
  SELF%TAUAER = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LSRSWD
IF (LSRSWD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWD,1):UBOUND(SELF%SRSWD,1), LBOUND(SELF%SRSWD,2):UBOUND(SELF%SRSWD,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWDC
IF (LSRLWDC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRLWDC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRLWDC,1):UBOUND(SELF%SRLWDC,1), LBOUND(SELF%SRLWDC,2):UBOUND(SELF%SRLWDC,2)))
  READ (KLUN) ZTMP2
  SELF%SRLWDC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWD
IF (LSRLWD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%SRLWD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%SRLWD,1):UBOUND(SELF%SRLWD,1), LBOUND(SELF%SRLWD,2):UBOUND(SELF%SRLWD,2), LBOUND(SELF%SRLWD,3):UBOUND(SELF%SRLWD,3)))
  READ (KLUN) ZTMP3
  SELF%SRLWD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LSRSWDC
IF (LSRSWDC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDC,1):UBOUND(SELF%SRSWDC,1), LBOUND(SELF%SRSWDC,2):UBOUND(SELF%SRSWDC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDCS
IF (LSRSWDCS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDCS (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDCS,1):UBOUND(SELF%SRSWDCS,1), LBOUND(SELF%SRSWDCS,2):UBOUND(SELF%SRSWDCS,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDCS = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWDCS
IF (LSRLWDCS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRLWDCS (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRLWDCS,1):UBOUND(SELF%SRLWDCS,1), LBOUND(SELF%SRLWDCS,2):UBOUND(SELF%SRLWDCS,2)))
  READ (KLUN) ZTMP2
  SELF%SRLWDCS = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDV
IF (LSRSWDV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDV,1):UBOUND(SELF%SRSWDV,1), LBOUND(SELF%SRSWDV,2):UBOUND(SELF%SRSWDV,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDUV
IF (LSRSWDUV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDUV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDUV,1):UBOUND(SELF%SRSWDUV,1), LBOUND(SELF%SRSWDUV,2):UBOUND(SELF%SRSWDUV,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDUV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LEDRO
IF (LEDRO) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%EDRO (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%EDRO,1):UBOUND(SELF%EDRO,1), LBOUND(SELF%EDRO,2):UBOUND(SELF%EDRO,2)))
  READ (KLUN) ZTMP2
  SELF%EDRO = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWPAR
IF (LSRSWPAR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWPAR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWPAR,1):UBOUND(SELF%SRSWPAR,1), LBOUND(SELF%SRSWPAR,2):UBOUND(SELF%SRSWPAR,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWPAR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWUVB
IF (LSRSWUVB) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWUVB (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWUVB,1):UBOUND(SELF%SRSWUVB,1), LBOUND(SELF%SRSWUVB,2):UBOUND(SELF%SRSWUVB,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWUVB = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWPARC
IF (LSRSWPARC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWPARC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWPARC,1):UBOUND(SELF%SRSWPARC,1), LBOUND(SELF%SRSWPARC,2):UBOUND(SELF%SRSWPARC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWPARC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWTINC
IF (LSRSWTINC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWTINC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWTINC,1):UBOUND(SELF%SRSWTINC,1), LBOUND(SELF%SRSWTINC,2):UBOUND(SELF%SRSWTINC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWTINC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRFDIR
IF (LSRFDIR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRFDIR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRFDIR,1):UBOUND(SELF%SRFDIR,1), LBOUND(SELF%SRFDIR,2):UBOUND(SELF%SRFDIR,2)))
  READ (KLUN) ZTMP2
  SELF%SRFDIR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRCDIR
IF (LSRCDIR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRCDIR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRCDIR,1):UBOUND(SELF%SRCDIR,1), LBOUND(SELF%SRCDIR,2):UBOUND(SELF%SRCDIR,2)))
  READ (KLUN) ZTMP2
  SELF%SRCDIR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRMOON
IF (LRMOON) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RMOON (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RMOON,1):UBOUND(SELF%RMOON,1), LBOUND(SELF%RMOON,2):UBOUND(SELF%RMOON,2)))
  READ (KLUN) ZTMP2
  SELF%RMOON = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LDERIVATIVELW
IF (LDERIVATIVELW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%DERIVATIVELW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%DERIVATIVELW,1):UBOUND(SELF%DERIVATIVELW,1), LBOUND(SELF%DERIVATIVELW,2):UBOUND(SELF%DERIVATIVELW,2), LBOUND(SELF%DERIVATIVELW,3):UBOUND(SELF%DERIVATIVELW,3)))
  READ (KLUN) ZTMP3
  SELF%DERIVATIVELW = ZTMP3
  DEALLOCATE (ZTMP3)
ELSE
  NULLIFY (SELF%DERIVATIVELW)
ENDIF
END SUBROUTINE

END SUBMODULE
