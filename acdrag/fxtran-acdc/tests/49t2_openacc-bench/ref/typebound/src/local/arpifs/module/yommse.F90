MODULE YOMMSE

!$ACDC methods 


USE PARKIND1, ONLY : JPIM, JPRB

!**** *YOMMSE*  - Store MSE parameters

!     Author. 
!     ------- 
!      Philippe Marguinaud *METEO FRANCE*
!      Original : 01-01-2011

!      Modifications :
!      P.Marguinaud : 11-09-2012 : New parameters

USE YOMCT0, ONLY : JPNPST

IMPLICIT NONE

TYPE TMSE

LOGICAL :: LPGDFWR   = .FALSE.       ! Default is do not write PGD 
LOGICAL :: LHISFWR   = .TRUE.        ! Default is write SURFEX historic data 
LOGICAL :: LFTZERO   = .TRUE.        ! Force SURFEX fields to 0 in extension zone

INTEGER(KIND=JPIM) :: NSURFEXCTLMAX = 3_JPIM
INTEGER(KIND=JPIM) :: NSURFEXCTL = 3_JPIM
INTEGER(KIND=JPIM) :: NSTEP_DUMP_STATE(JPNPST) = -1_JPIM

CHARACTER(LEN=4) :: CPREFIX_SFX1 = 'SFX.', &
                  & CPREFIX_SFX2 = 'X'

REAL (KIND=JPRB) :: XZSEPS = 1.E-2_JPRB ! Admitted relative difference between model and SURFEX orography

CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_TMSE
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TMSE
PROCEDURE :: ACDC_HOST => ACDC_HOST_TMSE
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TMSE
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TMSE
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TMSE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TMSE
END TYPE TMSE

!! TYPE(TMSE), POINTER :: YRMSE => NULL()

SAVE

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TMSE (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TMSE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TMSE (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TMSE), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TMSE (SELF)

IMPLICIT NONE
CLASS (TMSE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TMSE (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TMSE), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TMSE (SELF, KLUN)

IMPLICIT NONE
CLASS (TMSE), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TMSE (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TMSE),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TMSE (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TMSE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

END MODULE YOMMSE

