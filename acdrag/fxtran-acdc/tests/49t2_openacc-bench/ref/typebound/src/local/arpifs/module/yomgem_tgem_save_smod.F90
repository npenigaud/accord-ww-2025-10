SUBMODULE (YOMGEM) YOMGEM_TGEM_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TGEM (SELF, KLUN)

IMPLICIT NONE
CLASS (TGEM), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LNDGLU, LNGPTOTL, LNLOEN, LNLOENG, LNMEN, LNMENG, LNSTAGP, LNTSTAGP
WRITE (KLUN) SELF%NGPTOT
WRITE (KLUN) SELF%NGPTOT_CAP
WRITE (KLUN) SELF%NGPTOTMX
WRITE (KLUN) SELF%NGPTOTG
LNGPTOTL = ALLOCATED (SELF%NGPTOTL)
WRITE (KLUN) LNGPTOTL
IF (LNGPTOTL) THEN
  WRITE (KLUN) LBOUND (SELF%NGPTOTL)
  WRITE (KLUN) UBOUND (SELF%NGPTOTL)
  WRITE (KLUN) SELF%NGPTOTL
ENDIF
WRITE (KLUN) SELF%RDELXN
WRITE (KLUN) SELF%SLHDP
WRITE (KLUN) SELF%RMUCEN
WRITE (KLUN) SELF%RLOCEN
WRITE (KLUN) SELF%RSTRET
WRITE (KLUN) SELF%NSTTYP
WRITE (KLUN) SELF%NHTYP
WRITE (KLUN) SELF%RNLGINC
WRITE (KLUN) SELF%R4JP
WRITE (KLUN) SELF%RC2P1
WRITE (KLUN) SELF%RC2M1
WRITE (KLUN) SELF%RCOR0
WRITE (KLUN) SELF%RCOR1
LNLOEN = ALLOCATED (SELF%NLOEN)
WRITE (KLUN) LNLOEN
IF (LNLOEN) THEN
  WRITE (KLUN) LBOUND (SELF%NLOEN)
  WRITE (KLUN) UBOUND (SELF%NLOEN)
  WRITE (KLUN) SELF%NLOEN
ENDIF
LNLOENG = ALLOCATED (SELF%NLOENG)
WRITE (KLUN) LNLOENG
IF (LNLOENG) THEN
  WRITE (KLUN) LBOUND (SELF%NLOENG)
  WRITE (KLUN) UBOUND (SELF%NLOENG)
  WRITE (KLUN) SELF%NLOENG
ENDIF
LNMEN = ALLOCATED (SELF%NMEN)
WRITE (KLUN) LNMEN
IF (LNMEN) THEN
  WRITE (KLUN) LBOUND (SELF%NMEN)
  WRITE (KLUN) UBOUND (SELF%NMEN)
  WRITE (KLUN) SELF%NMEN
ENDIF
LNMENG = ALLOCATED (SELF%NMENG)
WRITE (KLUN) LNMENG
IF (LNMENG) THEN
  WRITE (KLUN) LBOUND (SELF%NMENG)
  WRITE (KLUN) UBOUND (SELF%NMENG)
  WRITE (KLUN) SELF%NMENG
ENDIF
LNDGLU = ALLOCATED (SELF%NDGLU)
WRITE (KLUN) LNDGLU
IF (LNDGLU) THEN
  WRITE (KLUN) LBOUND (SELF%NDGLU)
  WRITE (KLUN) UBOUND (SELF%NDGLU)
  WRITE (KLUN) SELF%NDGLU
ENDIF
LNSTAGP = ALLOCATED (SELF%NSTAGP)
WRITE (KLUN) LNSTAGP
IF (LNSTAGP) THEN
  WRITE (KLUN) LBOUND (SELF%NSTAGP)
  WRITE (KLUN) UBOUND (SELF%NSTAGP)
  WRITE (KLUN) SELF%NSTAGP
ENDIF
LNTSTAGP = ALLOCATED (SELF%NTSTAGP)
WRITE (KLUN) LNTSTAGP
IF (LNTSTAGP) THEN
  WRITE (KLUN) LBOUND (SELF%NTSTAGP)
  WRITE (KLUN) UBOUND (SELF%NTSTAGP)
  WRITE (KLUN) SELF%NTSTAGP
ENDIF
END SUBROUTINE

END SUBMODULE
