SUBMODULE (SPP_GEN_MOD) SPP_GEN_MOD_SPP_MODEL_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_SPP_MODEL (SELF, KLUN)

IMPLICIT NONE
CLASS (SPP_MODEL), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
WRITE (KLUN) SELF%VERSION
WRITE (KLUN) SELF%NMAX
WRITE (KLUN) SELF%DEFINED_PERTS
WRITE (KLUN) SELF%ACTIVE_PERTS
WRITE (KLUN) SELF%NDEF
WRITE (KLUN) SELF%NACT
WRITE (KLUN) SELF%NRFTOTAL
WRITE (KLUN) SELF%NRFTOTAL_RADGRID
WRITE (KLUN) SELF%NSEED_OFF
DO J1 = LBOUND (SELF%PNDEF, 1), UBOUND (SELF%PNDEF, 1)
  CALL SELF%PNDEF (J1)%ACDC_SAVE (KLUN)
ENDDO
DO J1 = LBOUND (SELF%PN, 1), UBOUND (SELF%PN, 1)
  CALL SELF%PN (J1)%ACDC_SAVE (KLUN)
ENDDO
WRITE (KLUN) SELF%TAU
WRITE (KLUN) SELF%XLCOR
WRITE (KLUN) SELF%SDEV
WRITE (KLUN) SELF%KSEED_OFF
END SUBROUTINE

END SUBMODULE
