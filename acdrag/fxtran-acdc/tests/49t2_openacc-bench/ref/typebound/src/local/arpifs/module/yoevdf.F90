MODULE YOEVDF

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*    ** *YOEVDF* CONTAINS CONSTANTS NEEDED BY *VDF....*
!     ------------------------------------------------------------------
TYPE TVDF
REAL(KIND=JPRB) :: RLAM
REAL(KIND=JPRB) :: RVDIFTS
LOGICAL         :: LWDS 
REAL(KIND=JPRB) :: REPS1WDS 
REAL(KIND=JPRB) :: REPS2WDS 
REAL(KIND=JPRB) :: RETAWDS 
REAL(KIND=JPRB) :: RTOFDALPHA
REAL(KIND=JPRB) :: REISTHSC
INTEGER(KIND=JPIM) :: NSUBST
REAL(KIND=JPRB) :: RFAC_TWO_COEF
REAL(KIND=JPRB) :: RZC_H
REAL(KIND=JPRB) :: RZL_INF

!---------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TVDF
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TVDF
PROCEDURE :: ACDC_HOST => ACDC_HOST_TVDF
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TVDF
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TVDF
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TVDF
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TVDF
END TYPE TVDF
!*     *YOEVDF* CONTAINS CONSTANTS NEEDED BY *VDF....*
!     FOR THE COMPUTATION OF VERTICAL DIFFUSION

!     A.C.M. BELJAARS      E.C.M.W.F.    14/12/89

!     OBUKHOV-L UPDATE     ACMB          26/03/90.
!     LWDS-upate           A.Beljaars    Jan-2014   
!     HARMONIE-AROME upd   U. Andrae     Dec-2020

!     NAME        TYPE     DESCRIPTION
!     ----        ----     -----------

!     *RLAM*      REAL     *ASYMPTOTIC MIXING LENGTH FOR MOMENTUM
!     *RVDIFTS*   REAL     *FACTOR FOR TIME STEP WEIGHTING IN *VDF....*
!     *LWDS*      LOGICAL  .T. for Wood/Diamantakis/Staniforth scheme      
!     *REPS1WDS*  REAL     Epsilon1 in WDS       
!     *REPS2WDS*  REAL     Epsilon2 in WDS         
!     *RETAWDS*   REAL     Eta in WDS         
!     *REISTHSC   REAL     Threshold for Inversion strength (K) for Stratocumulus
!     *NSUBST*    INTEGER  Number of substeps in VDF           
!     ------------------------------------------------------------------

 !---------------------------------------------------------------------

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TVDF (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TVDF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TVDF (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TVDF), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TVDF (SELF)

IMPLICIT NONE
CLASS (TVDF), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TVDF (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TVDF), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TVDF (SELF, KLUN)

IMPLICIT NONE
CLASS (TVDF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TVDF (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TVDF),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TVDF (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TVDF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS 
  
SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TVDF), INTENT(IN) :: SELF
INTEGER    , INTENT(IN) :: KDEPTH
INTEGER    , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH)    // 'model%yrml_phy_g%yrvdf : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RLAM = ', SELF%RLAM
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RVDIFTS = ', SELF%RVDIFTS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LWDS = ', SELF%LWDS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'REPS1WDS = ', SELF%REPS1WDS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'REPS2WDS = ', SELF%REPS2WDS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RETAWDS = ', SELF%RETAWDS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NSUBST = ', SELF%NSUBST
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'REISTHSC = ', SELF%REISTHSC
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RFAC_TWO_COEF = ', SELF%RFAC_TWO_COEF
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RZC_H = ', SELF%RZC_H
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RZL_INF = ', SELF%RZL_INF


END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOEVDF
