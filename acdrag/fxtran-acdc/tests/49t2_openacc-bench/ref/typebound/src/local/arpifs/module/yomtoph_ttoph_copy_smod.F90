SUBMODULE (YOMTOPH) YOMTOPH_TTOPH_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_TTOPH (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTOPH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LRMESOU = ALLOCATED (SELF%RMESOU)
IF (LRMESOU) THEN
  !$ACC ENTER DATA CREATE (SELF%RMESOU)
  !$ACC UPDATE DEVICE (SELF%RMESOU)
  !$ACC ENTER DATA ATTACH (SELF%RMESOU)
ENDIF

LRMESOT = ALLOCATED (SELF%RMESOT)
IF (LRMESOT) THEN
  !$ACC ENTER DATA CREATE (SELF%RMESOT)
  !$ACC UPDATE DEVICE (SELF%RMESOT)
  !$ACC ENTER DATA ATTACH (SELF%RMESOT)
ENDIF

LRMESOQ = ALLOCATED (SELF%RMESOQ)
IF (LRMESOQ) THEN
  !$ACC ENTER DATA CREATE (SELF%RMESOQ)
  !$ACC UPDATE DEVICE (SELF%RMESOQ)
  !$ACC ENTER DATA ATTACH (SELF%RMESOQ)
ENDIF

LRUREL = ALLOCATED (SELF%RUREL)
IF (LRUREL) THEN
  !$ACC ENTER DATA CREATE (SELF%RUREL)
  !$ACC UPDATE DEVICE (SELF%RUREL)
  !$ACC ENTER DATA ATTACH (SELF%RUREL)
ENDIF

LRVREL = ALLOCATED (SELF%RVREL)
IF (LRVREL) THEN
  !$ACC ENTER DATA CREATE (SELF%RVREL)
  !$ACC UPDATE DEVICE (SELF%RVREL)
  !$ACC ENTER DATA ATTACH (SELF%RVREL)
ENDIF

LRTREL = ALLOCATED (SELF%RTREL)
IF (LRTREL) THEN
  !$ACC ENTER DATA CREATE (SELF%RTREL)
  !$ACC UPDATE DEVICE (SELF%RTREL)
  !$ACC ENTER DATA ATTACH (SELF%RTREL)
ENDIF

LRQREL = ALLOCATED (SELF%RQREL)
IF (LRQREL) THEN
  !$ACC ENTER DATA CREATE (SELF%RQREL)
  !$ACC UPDATE DEVICE (SELF%RQREL)
  !$ACC ENTER DATA ATTACH (SELF%RQREL)
ENDIF

END SUBROUTINE

END SUBMODULE
