MODULE YOPHNC

!$ACDC methods 


IMPLICIT NONE

SAVE

! -------- SWITCHES FOR T-DT TRAJECTORY AND PHYSICS  -------------

! LETRAJP  : TRUE IF STORAGE OF TRAJECTORY AT T-DT
! LETRAJPT : TRUE IF STORAGE OF TRAJECTORY OF PHYS.TENDENCIES
!            FOR ADJOINT

! LERADI2   : TRUE IF RADIATION SCHEME ACTIVATED IN TL AND AD
! LERADS2   : TRUE IF RADIATION AT THE SURFACE ACTIVATED IN TL AND AD
! LERADSW2  : TRUE IF SHORTWAVE RADIATION SCHEME ACTIVATED IN TL AND AD
! LERADN2   : TRUE IF LINEARIZED SW+LW RAD.SCHEMES ACTIVATED IN TL AND AD
! LERADFL2  : TRUE IF FULL LINERAIZED LW = a dF + da F IN TL AND AD
! LERADLW2  : TRUE IF LONGWAVE RADIATION SCHEME ACTIVATED IN TL AND AD
! LH2OCO2   : TRUE IF TRANSMISSION FUNCTIONS COMPUTED ONLY FOR H2O and CO2
!                     ABSORBERS IN LW-RADIATION
! LWLOPT    : TRUE IF OPTIMIZATION OF LINEARIZED LW-RADIATION
! LWSOPT    : TRUE IF OPTIMIZATION OF LINEARIZED SW-RADIATION
! LEDCLD2   : TRUE IF DIAGNOSTIC CLOUDS ACTIVATED IN TL AND AD
! LEPCLD2   : TRUE IF SIMPLE PROGNOSTIC CLOUD SCHEME FOR LINEARIZED MODEL ACTIVATED
! LENCLD2   : TRUE IF SIMPLE CLOUD SCHEME FOR LINEARIZED MODEL ACTIVATED
! LEVAPLS2  : TRUE IF EVAPORATION OF LARGE SCALE CONDENSATION IN TL/AD
! LEVDIF2   : TRUE IF VERTICAL DIFFUSION ACTIVATED IN TL AND AD
! LEGWDG2   : TRUE IF S.S. OROGRAPHY SCHEME ACTIVATED IN TL AND AD
! LECUMF2   : TRUE IF MASS-FLUX CONVECTION ACTIVATED IN TL AND AD
! LECOND2   : TRUE IF CONDENSATION SCHEME ACTIVATED IN TL AND AD
! LEGWWMS2  : TRUE IF NON-OROGRAPHIC GRAVITY WAVE DRAG ACTIVATED IN TL/AD
! LEQNGT2   : TRUE IF Q<0 REMOVAL SCHEME ACTIVATED IN TL AND AD
! LESURF2   : TRUE IF LAND SURFACE  SCHEME ACTIVATED IN TL AND AD
! LEKPERT   : TRUE IF PERTURBATION OF EXCHANGE COEEFICIENTS
! LEKPERTS  : TRUE IF PERTURBATION OF SURFACE EXCHANGE COEEFICIENTS
! LTRACLNPH : TRUE IF TRACERS TO BE USED IN LINEARIZED PHYSICS

TYPE :: TPHNC
LOGICAL :: LETRAJP
LOGICAL :: LETRAJPT
LOGICAL :: LERADI2
LOGICAL :: LERADS2
LOGICAL :: LERADSW2
LOGICAL :: LERADN2
LOGICAL :: LERADFL2
LOGICAL :: LERADLW2
LOGICAL :: LH2OCO2
LOGICAL :: LWLOPT
LOGICAL :: LWSOPT
LOGICAL :: LEDCLD2
LOGICAL :: LEPCLD2
LOGICAL :: LENCLD2
LOGICAL :: LEVAPLS2
LOGICAL :: LEVDIF2
LOGICAL :: LEGWDG2
LOGICAL :: LECUMF2
LOGICAL :: LECOND2
LOGICAL :: LEGWWMS2
LOGICAL :: LEQNGT2
LOGICAL :: LESURF2
LOGICAL :: LEKPERT
LOGICAL :: LEKPERTS
LOGICAL :: LTRACLNPH
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: ACDC_COPY => ACDC_COPY_TPHNC
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TPHNC
PROCEDURE :: ACDC_HOST => ACDC_HOST_TPHNC
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TPHNC
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TPHNC
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TPHNC
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TPHNC
END TYPE TPHNC
!============================================================================

!!TYPE(TPHNC), POINTER :: YRPHNC => NULL()

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TPHNC (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TPHNC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TPHNC (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TPHNC), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TPHNC (SELF)

IMPLICIT NONE
CLASS (TPHNC), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TPHNC (SELF, KLUN)

IMPLICIT NONE
CLASS (TPHNC), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TPHNC (SELF, KLUN)

IMPLICIT NONE
CLASS (TPHNC), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TPHNC (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TPHNC),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TPHNC (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TPHNC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TPHNC), INTENT(IN) :: SELF
INTEGER     , INTENT(IN) :: KDEPTH
INTEGER     , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_slin%yrphnc : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LETRAJP = ', SELF%LETRAJP
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LETRAJPT = ', SELF%LETRAJPT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADI2 = ', SELF%LERADI2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADS2 = ', SELF%LERADS2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADSW2 = ', SELF%LERADSW2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADN2 = ', SELF%LERADN2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADFL2 = ', SELF%LERADFL2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LERADLW2 = ', SELF%LERADLW2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LH2OCO2 = ', SELF%LH2OCO2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LWLOPT = ', SELF%LWLOPT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LWSOPT = ', SELF%LWSOPT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEDCLD2 = ', SELF%LEDCLD2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEPCLD2 = ', SELF%LEPCLD2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LENCLD2 = ', SELF%LENCLD2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEVAPLS2 = ', SELF%LEVAPLS2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEVDIF2 = ', SELF%LEVDIF2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEGWDG2 = ', SELF%LEGWDG2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LECUMF2 = ', SELF%LECUMF2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LECOND2 = ', SELF%LECOND2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEGWWMS2 = ', SELF%LEGWWMS2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEQNGT2 = ', SELF%LEQNGT2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LESURF2 = ', SELF%LESURF2
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEKPERT = ', SELF%LEKPERT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LEKPERTS = ', SELF%LEKPERTS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LTRACLNPH = ', SELF%LTRACLNPH

END SUBROUTINE PRINT_CONFIGURATION
!     ------------------------------------------------------------------
END MODULE YOPHNC
