MODULE UTIL_TADVPRS_MOD

USE YOMPHY0, ONLY : TADVPRS

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TADVPRS
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TADVPRS
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TADVPRS
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TADVPRS
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TADVPRS
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TADVPRS
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TADVPRS
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TADVPRS (SELF, KLUN)

IMPLICIT NONE
TYPE (TADVPRS), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%LLMELTS
WRITE (KLUN) SELF%LLFREEZ
WRITE (KLUN) SELF%LLEVAPX
WRITE (KLUN) SELF%ZEPS
WRITE (KLUN) SELF%ZNU1
WRITE (KLUN) SELF%ZNU2
WRITE (KLUN) SELF%ZTAU1
WRITE (KLUN) SELF%ZTAU2
WRITE (KLUN) SELF%ZSIGMA1
WRITE (KLUN) SELF%ZSIGMA2
WRITE (KLUN) SELF%ZFVENTR1
WRITE (KLUN) SELF%ZFVENTR2
WRITE (KLUN) SELF%ZFVENTS1
WRITE (KLUN) SELF%ZFVENTS2
WRITE (KLUN) SELF%ZFVELR
WRITE (KLUN) SELF%ZFVELS
WRITE (KLUN) SELF%ZTMELT
WRITE (KLUN) SELF%ZRHOW
WRITE (KLUN) SELF%ZNRHOW
WRITE (KLUN) SELF%ZDVISC
WRITE (KLUN) SELF%ZSQTVIS
WRITE (KLUN) SELF%ZCDARV
WRITE (KLUN) SELF%ZRHOREF
WRITE (KLUN) SELF%ZEXP1
WRITE (KLUN) SELF%ZEXP4
WRITE (KLUN) SELF%ZEXP6
WRITE (KLUN) SELF%ZPREF
WRITE (KLUN) SELF%ZCOEFF1
WRITE (KLUN) SELF%ZCOEFF2
WRITE (KLUN) SELF%ZCOEFF2B
WRITE (KLUN) SELF%ZCOEFF3
WRITE (KLUN) SELF%ZCOEFF4
WRITE (KLUN) SELF%ZCOEFF5
WRITE (KLUN) SELF%ZCOEFF6
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TADVPRS (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TADVPRS), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%LLMELTS
READ (KLUN) SELF%LLFREEZ
READ (KLUN) SELF%LLEVAPX
READ (KLUN) ZTMP0
SELF%ZEPS = ZTMP0
READ (KLUN) ZTMP0
SELF%ZNU1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZNU2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZTAU1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZTAU2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZSIGMA1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZSIGMA2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVENTR1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVENTR2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVENTS1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVENTS2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVELR = ZTMP0
READ (KLUN) ZTMP0
SELF%ZFVELS = ZTMP0
READ (KLUN) ZTMP0
SELF%ZTMELT = ZTMP0
READ (KLUN) ZTMP0
SELF%ZRHOW = ZTMP0
READ (KLUN) ZTMP0
SELF%ZNRHOW = ZTMP0
READ (KLUN) ZTMP0
SELF%ZDVISC = ZTMP0
READ (KLUN) ZTMP0
SELF%ZSQTVIS = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCDARV = ZTMP0
READ (KLUN) ZTMP0
SELF%ZRHOREF = ZTMP0
READ (KLUN) ZTMP0
SELF%ZEXP1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZEXP4 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZEXP6 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZPREF = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF1 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF2 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF2B = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF3 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF4 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF5 = ZTMP0
READ (KLUN) ZTMP0
SELF%ZCOEFF6 = ZTMP0
END SUBROUTINE

SUBROUTINE ACDC_COPY_TADVPRS (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TADVPRS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TADVPRS (SELF)

IMPLICIT NONE
TYPE (TADVPRS), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TADVPRS (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TADVPRS), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LLMELTS), CDPATH//'%LLMELTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LLFREEZ), CDPATH//'%LLFREEZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LLEVAPX), CDPATH//'%LLEVAPX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZEPS), CDPATH//'%ZEPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZNU1), CDPATH//'%ZNU1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZNU2), CDPATH//'%ZNU2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZTAU1), CDPATH//'%ZTAU1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZTAU2), CDPATH//'%ZTAU2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZSIGMA1), CDPATH//'%ZSIGMA1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZSIGMA2), CDPATH//'%ZSIGMA2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVENTR1), CDPATH//'%ZFVENTR1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVENTR2), CDPATH//'%ZFVENTR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVENTS1), CDPATH//'%ZFVENTS1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVENTS2), CDPATH//'%ZFVENTS2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVELR), CDPATH//'%ZFVELR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZFVELS), CDPATH//'%ZFVELS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZTMELT), CDPATH//'%ZTMELT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZRHOW), CDPATH//'%ZRHOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZNRHOW), CDPATH//'%ZNRHOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZDVISC), CDPATH//'%ZDVISC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZSQTVIS), CDPATH//'%ZSQTVIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCDARV), CDPATH//'%ZCDARV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZRHOREF), CDPATH//'%ZRHOREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZEXP1), CDPATH//'%ZEXP1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZEXP4), CDPATH//'%ZEXP4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZEXP6), CDPATH//'%ZEXP6'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZPREF), CDPATH//'%ZPREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF1), CDPATH//'%ZCOEFF1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF2), CDPATH//'%ZCOEFF2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF2B), CDPATH//'%ZCOEFF2B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF3), CDPATH//'%ZCOEFF3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF4), CDPATH//'%ZCOEFF4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF5), CDPATH//'%ZCOEFF5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZCOEFF6), CDPATH//'%ZCOEFF6'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TADVPRS (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TADVPRS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TADVPRS (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TADVPRS),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LLMELTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLMELTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LLFREEZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLFREEZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LLEVAPX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLEVAPX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZEPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZNU1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNU1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZNU2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNU2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZTAU1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTAU1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZTAU2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTAU2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZSIGMA1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSIGMA1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZSIGMA2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSIGMA2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVENTR1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTR1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVENTR2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTR2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVENTS1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTS1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVENTS2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTS2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVELR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVELR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZFVELS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVELS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZTMELT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTMELT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZRHOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZRHOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZNRHOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNRHOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZDVISC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZDVISC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZSQTVIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSQTVIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCDARV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCDARV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZRHOREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZRHOREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZEXP1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZEXP4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZEXP6)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP6'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZPREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZPREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF2B)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF2B'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF5)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF5'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%ZCOEFF6)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF6'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
