MODULE UTIL_TDPHY_MOD

USE YOMDPHY, ONLY : TDPHY

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TDPHY
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TDPHY
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TDPHY
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TDPHY
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TDPHY
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TDPHY
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TDPHY
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TDPHY (SELF, KLUN)

IMPLICIT NONE
TYPE (TDPHY), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%NCSS
WRITE (KLUN) SELF%NVXP
WRITE (KLUN) SELF%NVXP2
WRITE (KLUN) SELF%NCXP
WRITE (KLUN) SELF%NCSI
WRITE (KLUN) SELF%NCOM
WRITE (KLUN) SELF%NCSNEC
WRITE (KLUN) SELF%NTILES
WRITE (KLUN) SELF%NVEXTR
WRITE (KLUN) SELF%NVEXTRDI
WRITE (KLUN) SELF%NVEXTRRAD
WRITE (KLUN) SELF%NVEXTRDYN
WRITE (KLUN) SELF%NVXTR2
WRITE (KLUN) SELF%NVECOUT
WRITE (KLUN) SELF%NCEXTR
WRITE (KLUN) SELF%NVCLIS
WRITE (KLUN) SELF%NTOZ1D
WRITE (KLUN) SELF%NTOZ2D
WRITE (KLUN) SELF%NTOZ3D
WRITE (KLUN) SELF%NTSSG
WRITE (KLUN) SELF%LTPROF
WRITE (KLUN) SELF%LDIRCLSMOD
WRITE (KLUN) SELF%LDIRSICMOD
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TDPHY (SELF, KLUN)

IMPLICIT NONE
TYPE (TDPHY), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

READ (KLUN) SELF%NCSS
READ (KLUN) SELF%NVXP
READ (KLUN) SELF%NVXP2
READ (KLUN) SELF%NCXP
READ (KLUN) SELF%NCSI
READ (KLUN) SELF%NCOM
READ (KLUN) SELF%NCSNEC
READ (KLUN) SELF%NTILES
READ (KLUN) SELF%NVEXTR
READ (KLUN) SELF%NVEXTRDI
READ (KLUN) SELF%NVEXTRRAD
READ (KLUN) SELF%NVEXTRDYN
READ (KLUN) SELF%NVXTR2
READ (KLUN) SELF%NVECOUT
READ (KLUN) SELF%NCEXTR
READ (KLUN) SELF%NVCLIS
READ (KLUN) SELF%NTOZ1D
READ (KLUN) SELF%NTOZ2D
READ (KLUN) SELF%NTOZ3D
READ (KLUN) SELF%NTSSG
READ (KLUN) SELF%LTPROF
READ (KLUN) SELF%LDIRCLSMOD
READ (KLUN) SELF%LDIRSICMOD
END SUBROUTINE

SUBROUTINE ACDC_COPY_TDPHY (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TDPHY), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TDPHY (SELF)

IMPLICIT NONE
TYPE (TDPHY), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TDPHY (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TDPHY), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCSS), CDPATH//'%NCSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVXP), CDPATH//'%NVXP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVXP2), CDPATH//'%NVXP2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCXP), CDPATH//'%NCXP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCSI), CDPATH//'%NCSI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCOM), CDPATH//'%NCOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCSNEC), CDPATH//'%NCSNEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTILES), CDPATH//'%NTILES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVEXTR), CDPATH//'%NVEXTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVEXTRDI), CDPATH//'%NVEXTRDI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVEXTRRAD), CDPATH//'%NVEXTRRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVEXTRDYN), CDPATH//'%NVEXTRDYN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVXTR2), CDPATH//'%NVXTR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVECOUT), CDPATH//'%NVECOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCEXTR), CDPATH//'%NCEXTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVCLIS), CDPATH//'%NVCLIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTOZ1D), CDPATH//'%NTOZ1D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTOZ2D), CDPATH//'%NTOZ2D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTOZ3D), CDPATH//'%NTOZ3D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTSSG), CDPATH//'%NTSSG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LTPROF), CDPATH//'%LTPROF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDIRCLSMOD), CDPATH//'%LDIRCLSMOD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDIRSICMOD), CDPATH//'%LDIRSICMOD'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TDPHY (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TDPHY), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TDPHY (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TDPHY),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NCSS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCSS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVXP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVXP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVXP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVXP2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCXP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCXP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCSI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCSI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCOM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCSNEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCSNEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTILES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTILES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVEXTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVEXTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVEXTRDI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVEXTRDI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVEXTRRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVEXTRRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVEXTRDYN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVEXTRDYN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVXTR2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVXTR2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVECOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVECOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCEXTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCEXTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVCLIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVCLIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTOZ1D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTOZ1D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTOZ2D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTOZ2D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTOZ3D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTOZ3D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTSSG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSSG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LTPROF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTPROF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDIRCLSMOD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIRCLSMOD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDIRSICMOD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIRSICMOD'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
