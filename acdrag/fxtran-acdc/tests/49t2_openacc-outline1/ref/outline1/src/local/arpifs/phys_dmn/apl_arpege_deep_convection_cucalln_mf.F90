SUBROUTINE APL_ARPEGE_DEEP_CONVECTION_CUCALLN_MF (LDDSLPHY, KSPPN2D, YDCPG_BNDS, YDCPG_OPTS&
&, YDMF_PHYS, YDMF_PHYS_BASE_STATE, YDMODEL, YDVARS, PVDIFTS, KCBOT, KCTOP, LDCUM, LDLAND&
&, LDSHCV, PQV, PACPR, PCUCONVCA, PDXTDK, PFCQLF, PFCQLI, PGEOM1, PGEOMH, PLCRIT_AER, PLISUM&
&, PLU, PMFU, PSNDE, PTENDQ, PTENDT, PTENQ, PTENT, PTENU, PTENV, PVERVEL)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDDSLPHY
INTEGER (KIND=JPIM), INTENT (INOUT)::KSPPN2D
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
REAL (KIND=JPRB), INTENT (INOUT)::PVDIFTS
INTEGER (KIND=JPIM), INTENT (INOUT)::KCBOT (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM), INTENT (INOUT)::KCTOP (YDCPG_OPTS%KLON)
LOGICAL, INTENT (INOUT)::LDCUM (YDCPG_OPTS%KLON)
LOGICAL, INTENT (INOUT)::LDLAND (YDCPG_OPTS%KLON)
LOGICAL, INTENT (INOUT)::LDSHCV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PQV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PACPR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PCUCONVCA (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PDXTDK (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFCQLF (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PFCQLI (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PGEOM1 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PGEOMH (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PLCRIT_AER (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PLISUM (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PLU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PMFU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSNDE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 2)
REAL (KIND=JPRB), INTENT (INOUT)::PTENDQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTENDT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTENQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTENT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTENU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTENV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PVERVEL (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
#include "cucalln_mf.intfb.h"
REAL (KIND=JPRB)::ZCEN (1, 1, 1)
REAL (KIND=JPRB)::ZSCAV (1)
REAL (KIND=JPRB)::ZTENC (1, 1, 1)
INTEGER (KIND=JPIM)::IBASC (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM)::IBOTSC (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM)::ICBOT_LIG (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM)::ICTOP_LIG (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM)::ITOPC (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM)::ITYPE (YDCPG_OPTS%KLON)
LOGICAL::LLCUM_LIG (YDCPG_OPTS%KLON)
LOGICAL::LLSC (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZDIFF (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZFHPCL (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZFHPCN (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZGP2DSPPA (YDCPG_OPTS%KLON, 1)
REAL (KIND=JPRB)::ZLGLAC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZLRAIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZLUDE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZLUDELI (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 4)
REAL (KIND=JPRB)::ZMFD (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZMFDDE_RATE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZMFUDE_RATE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRSUD (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 2)
REAL (KIND=JPRB)::ZVDISCU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZWMEAN (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZWU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_CUCALLN_MF', 0, ZHOOK_HANDLE)
CALL CUCALLN_MF (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL&
&%YRCST, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL%YRML_PHY_SLIN, YDMODEL%YRML_PHY_EC, YDMODEL%YRML_GCONF%YGFL&
&, YDMODEL%YRML_CHEM%YRCHEM, YDMODEL%YRML_GCONF%YRSPP_CONFIG, YDMODEL%YRML_PHY_STOCH%YRPERTPAR, YDCPG_BNDS&
&%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, 0, YDCPG_OPTS%KFLEVG, PDXTDK, KSPPN2D, YDMODEL%YRML_PHY_MF&
&%YRPHY%YRCAPE%LMCAPEA, LDLAND, LDDSLPHY, YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY, PVDIFTS, YDMF_PHYS_BASE_STATE&
&%T, PQV, YDMF_PHYS_BASE_STATE%U, YDMF_PHYS_BASE_STATE%V, PLISUM, PVERVEL, YDMF_PHYS%OUT%DIFTQ, YDMF_PHYS&
&%OUT%DIFTS, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF, YDMF_PHYS_BASE_STATE&
&%YCPG_PHY%PREHYD, PGEOM1, PGEOMH, YDVARS%GEOMETRY%GM%T0, PCUCONVCA, ZGP2DSPPA, PTENT, PTENQ, PTENU, PTENV&
&, PTENDT, PTENDQ, PACPR, ITOPC, IBASC, ITYPE, KCBOT, KCTOP, IBOTSC, LDCUM, LLSC, ICBOT_LIG, ICTOP_LIG&
&, LLCUM_LIG, LDSHCV, PLCRIT_AER, PLU, ZLUDE, ZLUDELI, PSNDE, PMFU, ZMFD, ZLGLAC, YDMF_PHYS%OUT%DIFCQ&
&, YDMF_PHYS%OUT%DIFCS, ZFHPCL, ZFHPCN, YDMF_PHYS%OUT%FPLCL, YDMF_PHYS%OUT%FPLCN, ZLRAIN, ZRSUD, YDMF_PHYS&
&%OUT%STRCU, YDMF_PHYS%OUT%STRCV, PFCQLF, PFCQLI, ZMFUDE_RATE, ZMFDDE_RATE, YDMF_PHYS%OUT%CAPE, ZWU, ZWMEAN&
&, ZVDISCU, ZDIFF, 0, ZCEN, ZTENC, ZSCAV, ZSCAV)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_CUCALLN_MF', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
