SUBROUTINE CPGLAG_OUTLINE_000 (YDCPG_BNDS, YDCPG_SL2, YDGEOMETRY, YDMODEL, YDVARS)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_SL2_TYPE), INTENT (IN)::YDCPG_SL2
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPGLAG_OUTLINE_000', 0, ZHOOK_HANDLE)

DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

  DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    YDVARS%U%T1 (JROF, JLEV)=YDVARS%U%T1 (JROF, JLEV)+YDCPG_SL2%USI (JROF, JLEV)
    YDVARS%V%T1 (JROF, JLEV)=YDVARS%V%T1 (JROF, JLEV)+YDCPG_SL2%VSI (JROF, JLEV)
    YDVARS%T%T1 (JROF, JLEV)=YDVARS%T%T1 (JROF, JLEV)+YDCPG_SL2%TSI (JROF, JLEV)
  ENDDO

ENDDO


IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDVARS%SVD%T1 (JROF, JLEV)=YDVARS%SVD%T1 (JROF, JLEV)+YDCPG_SL2%VDSI (JROF, JLEV)
      YDVARS%SPD%T1 (JROF, JLEV)=YDVARS%SPD%T1 (JROF, JLEV)+YDCPG_SL2%PDSI (JROF, JLEV)
    ENDDO

  ENDDO

ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHQE_SOLVER_QE) THEN
  YDVARS%SPD%T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
  YDVARS%SP%T1 (JROF)=YDVARS%SP%T1 (JROF)+YDCPG_SL2%SPSI (JROF)
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPGLAG_OUTLINE_000', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
