SUBROUTINE CPCFU_OUTLINE_002 (LDNORESET, LDRESET, KTIME, YDCFU, YDCPG_BNDS, YDCPG_DYN0&
&, YDCPG_MISC, YDCPG_OPTS, YDMF_PHYS_OUT, YDMF_PHYS_SURF, YDRIP)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_MISC_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE YOMCFU,ONLY:TCFU
USE YOMRIP,ONLY:TRIP
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDNORESET
LOGICAL, INTENT (INOUT)::LDRESET
INTEGER (KIND=JPIM), INTENT (INOUT)::KTIME
TYPE (TCFU), INTENT (INOUT)::YDCFU
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (CPG_MISC_TYPE), INTENT (IN)::YDCPG_MISC
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (MF_PHYS_SURF_TYPE), INTENT (IN)::YDMF_PHYS_SURF
TYPE (TRIP), INTENT (IN)::YDRIP
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_002', 0, ZHOOK_HANDLE)

IF (YDCFU%YFNEBT%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FNEBT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FNEBT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FNEBT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDCPG_MISC%CLCT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFCLL%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)&
  &+YDMF_PHYS_OUT%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFCLN%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)&
  &+YDMF_PHYS_OUT%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFEVL%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FEVL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FEVL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FEVL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)&
  &+YDMF_PHYS_OUT%FEVL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFEVN%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FEVN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FEVN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FEVN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)&
  &+YDMF_PHYS_OUT%FEVN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFONTE%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FONTE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FONTE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FONTE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FONTE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFCHSP%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FCHSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FCHSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCHSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FCHSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFLWSP%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FLWSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FLWSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FLWSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FLWSP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YRUISS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%RUISS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%RUISS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%RUISS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%RUISS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YRUISP%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%RUISP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%RUISP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%RUISP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%RUISP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFEVV%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FEVV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FEVV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FEVV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FEVV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFTR%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FTR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FTR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FTR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FTR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YRUISL%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%RUISL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%RUISL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%RUISL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%RUISL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFGEL%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FGEL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FGEL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FGEL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FGEL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFGELS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FGELS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FGELS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FGELS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FGELS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFCS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FCS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FCS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)&
  &+YDMF_PHYS_OUT%FCS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YWS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%WS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%WS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%WS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDMF_PHYS_SURF&
  &%GSP_RR%PW_T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YSNS%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%SNS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%SNS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%SNS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDMF_PHYS_SURF&
  &%GSP_SG%PF_T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YSPRES%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%SPRES (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%SPRES (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%SPRES (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDCPG_DYN0&
  &%PRE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFDISH%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FDISH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FDISH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FDISH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDMF_PHYS_OUT&
  &%FDIS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF


IF (YDCFU%YFTOPH%LACTIVE) THEN
  LDNORESET=.FALSE.

  IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
    YDCFU%FTOPH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  KTIME=1
  YDCFU%FTOPH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FTOPH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
  &)+YDMF_PHYS_OUT%FRMH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 0)*YDRIP%TSTEP*REAL (KTIME, JPRB)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_002', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
