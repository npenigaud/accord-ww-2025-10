SUBROUTINE APL_ARPEGE_DEEP_CONVECTION_COPY (YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, PFPCOR, PSNDE)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
REAL (KIND=JPRB), INTENT (OUT)::PFPCOR (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSNDE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 2)
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_COPY', 0, ZHOOK_HANDLE)

DO JLEV=0, YDCPG_OPTS%KFLEVG

  DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    PFPCOR (JLON, JLEV)=YDMF_PHYS%OUT%FPLCL (JLON, JLEV)+YDMF_PHYS%OUT%FPLCN (JLON, JLEV)
    YDMF_PHYS%OUT%FCCQL (JLON, JLEV)=YDMF_PHYS%OUT%FPLCL (JLON, JLEV)
    YDMF_PHYS%OUT%FCCQN (JLON, JLEV)=YDMF_PHYS%OUT%FPLCN (JLON, JLEV)
    YDMF_PHYS%OUT%FPFPCL (JLON, JLEV)=YDMF_PHYS%OUT%FPLCL (JLON, JLEV)
    YDMF_PHYS%OUT%FPFPCN (JLON, JLEV)=YDMF_PHYS%OUT%FPLCN (JLON, JLEV)
    YDMF_PHYS%OUT%FPEVPCL (JLON, JLEV)=0._JPRB
    YDMF_PHYS%OUT%FPEVPCN (JLON, JLEV)=0._JPRB
  ENDDO

ENDDO


DO JLEV=1, YDCPG_OPTS%KFLEVG

  DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    YDMF_PHYS%OUT%FPEVPCL (JLON, JLEV)=YDMF_PHYS%OUT%FPEVPCL (JLON, JLEV-1)-PSNDE (JLON, JLEV, 1)
    YDMF_PHYS%OUT%FPEVPCN (JLON, JLEV)=YDMF_PHYS%OUT%FPEVPCN (JLON, JLEV-1)-PSNDE (JLON, JLEV, 2)
  ENDDO

ENDDO

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_COPY', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
