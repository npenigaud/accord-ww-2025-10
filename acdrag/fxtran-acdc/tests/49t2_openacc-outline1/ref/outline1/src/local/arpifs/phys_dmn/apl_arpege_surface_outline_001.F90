SUBROUTINE APL_ARPEGE_SURFACE_OUTLINE_001 (KRR, PDTMSE, PRHGMT, PSTATI, YDCPG_BNDS, YDCPG_GPAR&
&, YDCPG_MISC, YDCPG_OPTS, YDGEOMETRY, YDMF_PHYS, YDMF_PHYS_BASE_STATE, YDMF_PHYS_SURF, YDMODEL&
&, YDVARS, PCARDI, PALBD, PALBP, PALPHA1, PCFATH, PCFAU, PCFBTH, PCFBU, PCFBV, PCOEFA, PCOEFN&
&, PFLU_EMIS, PLVT, PQI, PQICE, PQL, PRDG_MU0, PRDG_MU0N, PSFSWDIF, PSFSWDIR, PSGROUPEL, PSRAIN&
&, PSSNOW, PTSN, PCFAQ, PCFBQ, PFEV, PFMDU, PFMDV, PSFSV, PSVM, PTWSNOW)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_GPAR_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

INTEGER (KIND=JPIM), INTENT (INOUT)::KRR
REAL (KIND=JPRB), INTENT (IN)::PDTMSE
REAL (KIND=JPRB), INTENT (IN)::PRHGMT
REAL (KIND=JPRB), INTENT (IN)::PSTATI
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_GPAR_TYPE), INTENT (INOUT)::YDCPG_GPAR
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
REAL (KIND=JPRB), INTENT (INOUT)::PCARDI
REAL (KIND=JPRB), INTENT (INOUT)::PALBD (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (INOUT)::PALBP (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (OUT)::PALPHA1 (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCFATH (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCFAU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCFBTH (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCFBU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCFBV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCOEFA (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PCOEFN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PFLU_EMIS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PLVT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQI (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PQICE (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQL (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PRDG_MU0 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PRDG_MU0N (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSFSWDIF (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (INOUT)::PSFSWDIR (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (INOUT)::PSGROUPEL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSRAIN (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSSNOW (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PTSN (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PCFAQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PCFBQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PFEV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFMDU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFMDV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSFSV (YDCPG_OPTS%KLON, 1)
REAL (KIND=JPRB), INTENT (INOUT)::PSVM (YDCPG_OPTS%KLON, 1, 1)
REAL (KIND=JPRB), INTENT (INOUT)::PTWSNOW (YDCPG_OPTS%KLON)
#include "acaa1.intfb.h"
#include "aro_ground_diag.h"
#include "aro_ground_diag_2isba.h"
#include "aro_ground_param.h"
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JSG
REAL (KIND=JPRB)::ZBUDSO (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZBUDTH (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCH (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZDEPTH_HEIGHT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZFCLL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFEVS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZHV2 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRHODREFM (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZSFCO2 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZSSO_STDEV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZTOWNS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZZS (YDCPG_OPTS%KLON)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_OUTLINE_001', 0, ZHOOK_HANDLE)

DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
  ZRHODREFM (JLON)=YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF (JLON, YDCPG_OPTS%KFLEVG)/(YDMF_PHYS_BASE_STATE&
  &%T (JLON, YDCPG_OPTS%KFLEVG)*YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%R (JLON, YDCPG_OPTS%KFLEVG))
  ZZS (JLON)=YDMF_PHYS_BASE_STATE%YCPG_DYN%PHI (JLON, YDCPG_OPTS%KFLEVG)/YDMODEL%YRCST%RG
ENDDO


DO JLEV=1, YDCPG_OPTS%KFLEVG

  DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    ZDEPTH_HEIGHT (JLON, JLEV)=(YDMF_PHYS_BASE_STATE%YCPG_DYN%PHIF (JLON, JLEV)-YDMF_PHYS_BASE_STATE&
    &%YCPG_DYN%PHI (JLON, YDCPG_OPTS%KFLEVG))/YDMODEL%YRCST%RG
  ENDDO

ENDDO

CALL ARO_GROUND_PARAM (YDCPG_BNDS%KBL, YDCPG_BNDS%KFDIA-YDCPG_BNDS%KIDIA+1, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
&%KFDIA, YDCPG_OPTS%NSTEP, KRR, YDMODEL%YRML_PHY_RAD%YRERAD%NSW, YDMODEL%YRML_GCONF%YGFL%NGFL_EXT, YDGEOMETRY&
&%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG, YDGEOMETRY%YRDIM%NDLUXG, YDMODEL%YRML_PHY_MF&
&%YRARPHY%LMPA, YDMODEL%YRML_PHY_MF%YRARPHY%CCOUPLING, YDCPG_OPTS%LCONFX, YDCPG_OPTS%NINDAT, PRHGMT&
&, PSTATI, YDMODEL%YRML_GCONF%YRRIP%RSOVR, YDMODEL%YRML_GCONF%YRRIP%RCODEC, YDMODEL%YRML_GCONF%YRRIP&
&%RSIDEC, YDVARS%GEOMETRY%RINDX%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDVARS%GEOMETRY%RINDY%T0 (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS_BASE_STATE%U (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG&
&:YDCPG_OPTS%KFLEVG), YDMF_PHYS_BASE_STATE%V (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS&
&%KFLEVG), YDMF_PHYS_BASE_STATE%T (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
&), YDMF_PHYS_BASE_STATE%Q (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG)&
&, PSVM, PCARDI, ZRHODREFM (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF&
& (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), YDMF_PHYS_BASE_STATE%YCPG_PHY&
&%PREHYD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), PDTMSE, ZDEPTH_HEIGHT&
& (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG), ZZS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMODEL&
&%YRML_PHY_MF%YRMSE%XZSEPS, PRDG_MU0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), PRDG_MU0N (YDCPG_BNDS%KIDIA&
&:YDCPG_BNDS%KFDIA), YDVARS%GEOMETRY%GELAM%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDVARS%GEOMETRY%GEMU&
&%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMODEL%YRML_PHY_MF%YRPARAR%XSW_BANDS, PSRAIN (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), PSSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), PSGROUPEL (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), YDMF_PHYS%OUT%FRTHDS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), PSFSWDIF (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA, 1:YDMODEL%YRML_PHY_RAD%YRERAD%NSW), PSFSWDIR (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDMODEL&
&%YRML_PHY_RAD%YRERAD%NSW), PCFAQ (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
&), PCFATH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), PCFAU (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), PCFBQ (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
&, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), PCFBTH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG&
&:YDCPG_OPTS%KFLEVG), PCFBU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
&), PCFBV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG), YDMF_PHYS%OUT%FCS&
& (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), PFEV (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), PSFSV, ZSFCO2 (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), PFMDU (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), PFMDV (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), PALBP (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDMODEL%YRML_PHY_RAD%YRERAD%NSW), PALBD (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA, 1:YDMODEL%YRML_PHY_RAD%YRERAD%NSW), PFLU_EMIS (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), PTSN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%FRTH (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA, YDCPG_OPTS%KFLEVG, 1), YDMODEL)
ZFEVS (:)=-PFEV (:)
CALL ARO_GROUND_DIAG (YDCPG_BNDS%KBL, YDCPG_BNDS%KFDIA-YDCPG_BNDS%KIDIA+1, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
&%KFDIA, YDCPG_OPTS%KFLEVG,-1, YDGEOMETRY%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG&
&, YDGEOMETRY%YRDIM%NDLUXG, ZZS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), ZFEVS (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), YDMF_PHYS_BASE_STATE%U (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDCPG_OPTS%KFLEVG), YDMF_PHYS_BASE_STATE&
&%V (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDCPG_OPTS%KFLEVG), ZDEPTH_HEIGHT (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA, 1:YDCPG_OPTS%KFLEVG), YDMF_PHYS%OUT%FRTH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG&
&, 1), YDMF_PHYS%OUT%FRSO (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, 1), YDVARS%GEOMETRY%RINDX&
&%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDVARS%GEOMETRY%RINDY%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
&), YDCPG_MISC%QS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%GZ0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), YDMF_PHYS%OUT%GZ0H (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%TCLS (YDCPG_BNDS%KIDIA&
&:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%QCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%RHCLS (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%UCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%VCLS&
& (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%NUCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS&
&%OUT%NVCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA&
&, 1), YDMF_PHYS%OUT%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), YDMF_PHYS%OUT%FEVL (YDCPG_BNDS%KIDIA&
&:YDCPG_BNDS%KFDIA, 1), YDMF_PHYS%OUT%FEVN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), ZSSO_STDEV (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), PTWSNOW (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%SNWDE (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), ZBUDTH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), ZBUDSO (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), ZFCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), ZTOWNS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), ZCD &
&(YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), ZCH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS%OUT%SIC (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA))

DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
  YDCPG_GPAR%GZ0 (JLON)=YDMF_PHYS%OUT%GZ0 (JLON)
  YDCPG_GPAR%GZ0H (JLON)=YDMF_PHYS%OUT%GZ0H (JLON)
  YDCPG_GPAR%VEMIS (JLON)=PFLU_EMIS (JLON)
  YDCPG_GPAR%VQS (JLON)=YDCPG_MISC%QS (JLON)
  YDCPG_GPAR%CD (JLON)=ZCD (JLON)
ENDDO


DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
  YDCPG_GPAR%ALBSCA (:, JSG)=PALBD (:, JSG)
  YDCPG_GPAR%ALBDIR (:, JSG)=PALBP (:, JSG)
ENDDO


DO JSG=1, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG+1

  DO JLEV=0, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDMF_PHYS%OUT%FRTH (JLON, JLEV, JSG)=YDMF_PHYS%OUT%FRTH (JLON, JLEV, JSG)+ZBUDTH (JLON)
    ENDDO

  ENDDO

ENDDO

CALL ARO_GROUND_DIAG_2ISBA (YDCPG_BNDS%KBL, YDCPG_BNDS%KFDIA-YDCPG_BNDS%KIDIA+1, YDCPG_BNDS%KIDIA&
&, YDCPG_BNDS%KFDIA, YDGEOMETRY%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG&
&, YDGEOMETRY%YRDIM%NDLUXG, YDVARS%GEOMETRY%RINDX%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDVARS&
&%GEOMETRY%RINDY%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS_SURF%GSD_VF%PLSM, YDMF_PHYS_SURF&
&%GSD_VV%PARG, YDMF_PHYS_SURF%GSD_VV%PSAB, YDMF_PHYS_SURF%GSD_VV%PD2, PTSN, PTWSNOW, YDMF_PHYS_SURF&
&%GSP_SB%PT_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), YDMF_PHYS_SURF%GSP_RR%PW_T1 (YDCPG_BNDS&
&%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS_SURF%GSP_SB%PQ_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)&
&, YDMF_PHYS_SURF%GSP_RR%PIC_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), YDMF_PHYS_SURF%GSP_SB%PTL_T1&
& (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), YDMF_PHYS_SURF%GSP_RR%PFC_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS&
&%KFDIA), YDMF_PHYS_SURF%GSP_SG%PA_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), YDMF_PHYS_SURF%GSP_SG&
&%PR_T1 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1), ZHV2)

DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
  YDMF_PHYS_SURF%GSD_VV%PHV (JLON)=ZHV2 (JLON)
ENDDO


IF (.NOT.YDMODEL%YRML_PHY_MF%YRPHY%LNODIFQC) THEN
  CALL ACAA1 (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
  &, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD, PCOEFN, YDMF_PHYS_BASE_STATE&
  &%YCPG_DYN%RCP%CP, PQL, PQI, YDMF_PHYS_BASE_STATE%T, PALPHA1, PCOEFA, PLVT, PQICE)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_OUTLINE_001', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
