SUBROUTINE LATTEX_EXPL_2TL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS&
&, YDML_DYN, YDCPG_SL1, YDVARS, LDCT, LDCTC)
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1B_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (CPG_SL1B_TYPE), INTENT (INOUT)::YDCPG_SL1
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
LOGICAL, INTENT (IN)::LDCT
LOGICAL, INTENT (IN)::LDCTC
LOGICAL::LLTDIABLIN


INTEGER (KIND=JPIM)::JGFL
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "lattex_expl_2tl_outline_000.intfb.h"
#include "lattex_expl_2tl_outline_006.intfb.h"
#include "lattex_expl_2tl_outline_005.intfb.h"
#include "lattex_expl_2tl_outline_004.intfb.h"
#include "lattex_expl_2tl_outline_003.intfb.h"
#include "lattex_expl_2tl_outline_002.intfb.h"
#include "lattex_expl_2tl_outline_001.intfb.h"
IF (LHOOK) CALL DR_HOOK ('LATTEX_EXPL_2TL', 0, ZHOOK_HANDLE)

IF (LDCT.AND.(.NOT.LDCTC)) THEN

  DO JGFL=1, SIZE (YDCPG_SL1%GFL)

    IF (YDVARS%GFL_PTR (JGFL)%YCOMP%LADV) THEN

      IF (YDML_DYN%YRDYN%LSPLTHOIGFL.AND.(YDML_DYN%YRDYN%NSPLTHOI==0&
        &).AND.(.NOT.YDVARS%GFL_PTR (JGFL)%YCOMP%LTDIABLIN)) THEN
        CALL LATTEX_EXPL_2TL_OUTLINE_000 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDVARS)
      ELSE
        CALL LATTEX_EXPL_2TL_OUTLINE_001 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDVARS)
      ENDIF

    ENDIF

  ENDDO

ELSEIF (.NOT.LDCT) THEN

  DO JGFL=1, SIZE (YDCPG_SL1%GFL)

    IF (YDVARS%GFL_PTR (JGFL)%YCOMP%LADV) THEN

      IF (YDML_DYN%YRDYN%LSPLTHOIGFL.AND.(YDML_DYN%YRDYN%NSPLTHOI==0&
        &).AND.(.NOT.YDVARS%GFL_PTR (JGFL)%YCOMP%LTDIABLIN)) THEN
        CALL LATTEX_EXPL_2TL_OUTLINE_002 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDVARS)
      ELSE
        CALL LATTEX_EXPL_2TL_OUTLINE_003 (JGFL, YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY, YDVARS)
      ENDIF

    ENDIF

  ENDDO

ENDIF


IF (YDVARS%CVGQ%YCOMP%LGP.AND.(.NOT.LDCTC)) THEN
  LLTDIABLIN=YDVARS%CVGQ%YCOMP%LTDIABLIN

  IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).OR.LLTDIABLIN) THEN
    CALL LATTEX_EXPL_2TL_OUTLINE_004 (YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY)
  ENDIF

  CALL LATTEX_EXPL_2TL_OUTLINE_005 (YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY)
  LLTDIABLIN=YDVARS%CVGQ%YCOMP%LTDIABLIN.AND.YDVARS%Q%YCOMP%LTDIABLIN

  IF ((YDML_DYN%YRDYN%NSPLTHOI==0).AND.LLTDIABLIN) THEN
    CALL LATTEX_EXPL_2TL_OUTLINE_006 (YDCPG_BNDS, YDCPG_SL1, YDGEOMETRY)
  ENDIF

ENDIF

IF (LHOOK) CALL DR_HOOK ('LATTEX_EXPL_2TL', 1, ZHOOK_HANDLE)
ENDSUBROUTINE LATTEX_EXPL_2TL
