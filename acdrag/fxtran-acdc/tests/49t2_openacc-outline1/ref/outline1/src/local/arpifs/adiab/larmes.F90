#ifdef RS6K
@PROCESS NOCHECK
#endif

SUBROUTINE LARMES (YDGEOMETRY, YDGEOMVARS, YDCST, YDRIP, YDML_DYN, YDCPG_OPTS&
&, YDCPG_BNDS, YDSL, YDCPG_SL1, YDCPG_SL2, YDMASK_SL2, YDA_KVSEPC, YDA_KVSEPL&
&, PSCO, PLEV, PCCO, PUF, PVF, PWF, KL0, KLH0, KLEV, PLSCAW, PRSCAW)
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE YOMCST,ONLY:TCST
USE YOMRIP,ONLY:TRIP
USE EINT_MOD,ONLY:SL_STRUCT
USE FIELD_VARIABLES_MOD,ONLY:GEOMETRY_VARIABLES
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1F_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_SL_MASK_TYPE_MOD,ONLY:CPG_SL_MASK_TYPE
USE FIELD_ARRAY_MODULE,ONLY:FIELD_2IM_ARRAY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (GEOMETRY_VARIABLES), INTENT (IN)::YDGEOMVARS
TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (TRIP), INTENT (IN)::YDRIP
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (SL_STRUCT), INTENT (IN)::YDSL
TYPE (CPG_SL1F_TYPE), INTENT (IN)::YDCPG_SL1
TYPE (CPG_SL2_TYPE), INTENT (IN)::YDCPG_SL2
TYPE (CPG_SL_MASK_TYPE), INTENT (INOUT)::YDMASK_SL2
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPC
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPL
REAL (KIND=JPRB), INTENT (INOUT)::PSCO (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTSCO%NDIM)
REAL (KIND=JPRB), INTENT (INOUT)::PLEV (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PCCO (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTCCO%NDIM)
REAL (KIND=JPRB), INTENT (INOUT)::PUF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PVF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PWF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
INTEGER (KIND=JPIM), INTENT (INOUT)::KL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, 0:3)
INTEGER (KIND=JPIM), INTENT (INOUT)::KLH0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, 0:3)
INTEGER (KIND=JPIM), INTENT (INOUT)::KLEV (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PLSCAW (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTLSCAW%NDIM)
REAL (KIND=JPRB), INTENT (INOUT)::PRSCAW (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTRSCAW%NDIM)












LOGICAL::LSMOOTH
LOGICAL::LLO
LOGICAL::LLSLHDQUAD
LOGICAL::LLSLHD
REAL (KIND=JPRB)::ZDTSA
REAL (KIND=JPRB)::ZDTS62
REAL (KIND=JPRB)::ZDTS22
REAL (KIND=JPRB)::ZINT



REAL (KIND=JPRB)::ZNOR2


REAL (KIND=JPRB)::ZSPHSV
















REAL (KIND=JPRB)::ZPV0
REAL (KIND=JPRB)::ZPU0















#include "abor1.intfb.h"
#include "larmes_larmes.intfb.h"









REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('LARMES', 0, ZHOOK_HANDLE)





IF (YDML_DYN%YRDYNA%LTWOTL) THEN
  LLO=.NOT.YDML_DYN%YRDYNA%LELTRA
ELSE
  LLO=.FALSE.
ENDIF


IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
  ZDTS22=YDRIP%RDTS22*4._JPRB
  ZDTSA=YDRIP%RDTSA*2._JPRB
  ZDTS62=YDRIP%RDTS62*4._JPRB
ELSE

  IF (YDML_DYN%YRDYNA%LTWOTL)  THEN
    CALL ABOR1 (' LARMES 1.2 ')
  ENDIF

  ZDTS22=YDRIP%RDTS22
  ZDTSA=YDRIP%RDTSA
  ZDTS62=YDRIP%RDTS62
ENDIF

LLSLHD=.FALSE.
LLSLHDQUAD=.FALSE.
LSMOOTH=YDML_DYN%YRDYN%LSVTSM.AND.(YDCPG_OPTS%NCONF==1.OR.YDCPG_OPTS%NCONF==302)
CALL LARMES_LARMES (LLO, LLSLHD, LLSLHDQUAD, LSMOOTH, YDA_KVSEPC, YDA_KVSEPL, YDCPG_BNDS&
&, YDCPG_SL1, YDCPG_SL2, YDCST, YDGEOMETRY, YDGEOMVARS, YDMASK_SL2, YDML_DYN, YDRIP&
&, YDSL, KL0, KLEV, KLH0, PCCO, PLEV, PLSCAW, PRSCAW, PSCO, PUF, PVF, PWF)


IF (LHOOK) CALL DR_HOOK ('LARMES', 1, ZHOOK_HANDLE)
ENDSUBROUTINE LARMES
