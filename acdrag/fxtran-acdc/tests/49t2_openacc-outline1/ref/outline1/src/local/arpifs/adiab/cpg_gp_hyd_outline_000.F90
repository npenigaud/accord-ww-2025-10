SUBROUTINE CPG_GP_HYD_OUTLINE_000 (YDCPG_BNDS, YDCPG_DYN0, YDCPG_OPTS, YDGEOMETRY&
&, YDMODEL, P_RPREF_T0, P_XYBDER_ALPHL_T0, P_XYBDER_ALPHM_T0, P_XYBDER_ALPHPLL_T0&
&, P_XYBDER_ALPHPLM_T0, P_XYBDER_LNPRL_T0, P_XYBDER_LNPRM_T0)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_TND_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN0
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (MODEL), INTENT (IN)::YDMODEL
REAL (KIND=JPRB), INTENT (INOUT)::P_RPREF_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_ALPHL_T0 (YDGEOMETRY&
&%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_ALPHM_T0 (YDGEOMETRY&
&%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_ALPHPLL_T0 &
&(YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_ALPHPLM_T0 &
&(YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_LNPRL_T0 (YDGEOMETRY&
&%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::P_XYBDER_LNPRM_T0 (YDGEOMETRY&
&%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
#include "gpgrxyb_expl.intfb.h"
#include "gphpre_expl.intfb.h"
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::Z_XYBDER_COEFAPL_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB)::Z_XYBDER_COEFA_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB)::Z_XYBDER_COEFD_T0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_OUTLINE_000', 0, ZHOOK_HANDLE)
YDCPG_DYN0%NHX (:,:)=0.0_JPRB
YDCPG_DYN0%GWFT (:,:)=0.0_JPRB
CALL GPHPRE_EXPL (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDCPG_OPTS%TOPPRES, YDMODEL%YRCST, YDGEOMETRY&
&%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDGEOMETRY&
&%YRVERT_GEOM%YRVAB, YDCPG_DYN0%PRE, PRESF=YDCPG_DYN0%PREF, PDELP=YDCPG_DYN0%XYB%DELP, PLNPR&
&=YDCPG_DYN0%XYB%LNPR, PRDELP=YDCPG_DYN0%XYB%RDELP, PALPH=YDCPG_DYN0%XYB%ALPH, PRTGR=YDCPG_DYN0&
&%XYB%RTGR, PRPRE=YDCPG_DYN0%XYB%RPRE, PRPP=YDCPG_DYN0%XYB%RPP)

IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      P_RPREF_T0 (JROF, JLEV)=1.0_JPRB/YDCPG_DYN0%PREF (JROF, JLEV)
    ENDDO

  ENDDO

ENDIF


IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
  CALL GPGRXYB_EXPL (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
  &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,.FALSE., YDGEOMETRY%YRVERT_GEOM%YRVAB, YDCPG_DYN0%PREL, YDCPG_DYN0&
  &%PREM, PDELP=YDCPG_DYN0%XYB%DELP, PLNPR=YDCPG_DYN0%XYB%LNPR, PRDELP=YDCPG_DYN0%XYB%RDELP, PALPH=YDCPG_DYN0&
  &%XYB%ALPH, PRTGR=YDCPG_DYN0%XYB%RTGR, PRPRE=YDCPG_DYN0%XYB%RPRE, PRPP=YDCPG_DYN0%XYB%RPP, PCOEFD_DER&
  &=Z_XYBDER_COEFD_T0, PLNPRL_DER=P_XYBDER_LNPRL_T0, PLNPRM_DER=P_XYBDER_LNPRM_T0, PCOEFA_DER=Z_XYBDER_COEFA_T0&
  &, PCOEFAPL_DER=Z_XYBDER_COEFAPL_T0, PALPHPLL_DER=P_XYBDER_ALPHPLL_T0, PALPHPLM_DER=P_XYBDER_ALPHPLM_T0&
  &, PALPHL_DER=P_XYBDER_ALPHL_T0, PALPHM_DER=P_XYBDER_ALPHM_T0)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_OUTLINE_000', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
