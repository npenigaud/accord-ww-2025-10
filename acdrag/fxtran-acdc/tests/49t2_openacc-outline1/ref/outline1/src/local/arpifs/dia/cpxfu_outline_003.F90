SUBROUTINE CPXFU_OUTLINE_003 (YDCPG_BNDS, YDMF_PHYS_OUT, YDXFU)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE YOMXFU,ONLY:TXFU
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (TXFU), INTENT (INOUT)::YDXFU
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPXFU_OUTLINE_003', 0, ZHOOK_HANDLE)

IF (YDXFU%YXDIAGH%LACTIVE) THEN

  IF (YDXFU%LRESET_GST) THEN
    YDXFU%XDIAGH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%XDIAGH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%XDIAGH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDMF_PHYS_OUT%DIAGH (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%XDIAGH (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
ENDIF


IF (YDXFU%YVISICLD%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI) THEN
    YDXFU%VISICLD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=20000.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%VISICLD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%VISICLD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%VISICLD (YDCPG_BNDS%KIDIA&
  &:YDCPG_BNDS%KFDIA), MAX (0.0_JPRB, YDXFU%VISICLD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YVISIHYD%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI) THEN
    YDXFU%VISIHYD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=20000.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%VISIHYD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%VISIHYD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%VISIHYD (YDCPG_BNDS%KIDIA&
  &:YDCPG_BNDS%KFDIA), MAX (0.0_JPRB, YDXFU%VISIHYD (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YCLWC%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI) THEN
    YDXFU%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDMF_PHYS_OUT%MXCLWC (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
  YDXFU%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDXFU&
  &%CLWC (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), 0.0_JPRB)
ENDIF


IF (YDXFU%YVISICLD2%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI2) THEN
    YDXFU%VISICLD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=20000.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%VISICLD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%VISICLD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%VISICLD (YDCPG_BNDS%KIDIA&
  &:YDCPG_BNDS%KFDIA), MAX (0.0_JPRB, YDXFU%VISICLD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YVISIHYD2%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI2) THEN
    YDXFU%VISIHYD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=20000.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%VISIHYD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%VISIHYD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%VISIHYD (YDCPG_BNDS%KIDIA&
  &:YDCPG_BNDS%KFDIA), MAX (0.0_JPRB, YDXFU%VISIHYD2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YCLWC2%LACTIVE) THEN

  IF (YDXFU%LRESET_VISI2) THEN
    YDXFU%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDMF_PHYS_OUT%MXCLWC (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
  YDXFU%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDXFU&
  &%CLWC2 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA), 0.0_JPRB)
ENDIF


IF (YDXFU%YTPWCLS%LACTIVE) THEN
  YDXFU%TPWCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMF_PHYS_OUT&
  &%TPWCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)
ENDIF


IF (YDXFU%YRHCLS%LACTIVE) THEN
  YDXFU%RHCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMF_PHYS_OUT&
  &%RHCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)
  YDXFU%RHCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (1.0_JPRB, MAX&
  & (0.0_JPRB, YDXFU%RHCLS (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YTN%LACTIVE) THEN

  IF (YDXFU%LRESET) THEN
    YDXFU%TN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=100000._JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%TN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%TN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%TCLS (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%TN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
ENDIF


IF (YDXFU%YTX%LACTIVE) THEN

  IF (YDXFU%LRESET) THEN
    YDXFU%TX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%TX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%TX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDMF_PHYS_OUT%TCLS (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%TX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
ENDIF


IF (YDXFU%YHUN%LACTIVE) THEN

  IF (YDXFU%LRESET) THEN
    YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=1.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MIN (YDMF_PHYS_OUT%RHCLS (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
  YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (0.0_JPRB, MIN&
  & (1.0_JPRB, YDXFU%HUN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF


IF (YDXFU%YHUX%LACTIVE) THEN

  IF (YDXFU%LRESET) THEN
    YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ELSEIF (YDXFU%LRESET) THEN
    YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0.0_JPRB
  ENDIF

  YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (YDMF_PHYS_OUT%RHCLS (YDCPG_BNDS&
  &%KIDIA:YDCPG_BNDS%KFDIA), YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA))
  YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=MAX (0.0_JPRB, MIN&
  & (1.0_JPRB, YDXFU%HUX (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)))
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPXFU_OUTLINE_003', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
