MODULE UTIL_TTHF_MOD

USE YOETHF, ONLY : TTHF

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TTHF
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TTHF
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TTHF
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TTHF
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TTHF
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TTHF
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TTHF
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TTHF (SELF, KLUN)

IMPLICIT NONE
TYPE (TTHF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%R2ES
WRITE (KLUN) SELF%R3LES
WRITE (KLUN) SELF%R3IES
WRITE (KLUN) SELF%R4LES
WRITE (KLUN) SELF%R4IES
WRITE (KLUN) SELF%R5LES
WRITE (KLUN) SELF%R5IES
WRITE (KLUN) SELF%RVTMP2
WRITE (KLUN) SELF%RHOH2O
WRITE (KLUN) SELF%R5ALVCP
WRITE (KLUN) SELF%R5ALSCP
WRITE (KLUN) SELF%RALVDCP
WRITE (KLUN) SELF%RALSDCP
WRITE (KLUN) SELF%RALFDCP
WRITE (KLUN) SELF%RTWAT
WRITE (KLUN) SELF%RTBER
WRITE (KLUN) SELF%RTBERCU
WRITE (KLUN) SELF%RTICE
WRITE (KLUN) SELF%RTICECU
WRITE (KLUN) SELF%RTWAT_RTICE_R
WRITE (KLUN) SELF%RTWAT_RTICECU_R
WRITE (KLUN) SELF%RKOOP1
WRITE (KLUN) SELF%RKOOP2
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TTHF (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TTHF), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) ZTMP0
SELF%R2ES = ZTMP0
READ (KLUN) ZTMP0
SELF%R3LES = ZTMP0
READ (KLUN) ZTMP0
SELF%R3IES = ZTMP0
READ (KLUN) ZTMP0
SELF%R4LES = ZTMP0
READ (KLUN) ZTMP0
SELF%R4IES = ZTMP0
READ (KLUN) ZTMP0
SELF%R5LES = ZTMP0
READ (KLUN) ZTMP0
SELF%R5IES = ZTMP0
READ (KLUN) ZTMP0
SELF%RVTMP2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RHOH2O = ZTMP0
READ (KLUN) ZTMP0
SELF%R5ALVCP = ZTMP0
READ (KLUN) ZTMP0
SELF%R5ALSCP = ZTMP0
READ (KLUN) ZTMP0
SELF%RALVDCP = ZTMP0
READ (KLUN) ZTMP0
SELF%RALSDCP = ZTMP0
READ (KLUN) ZTMP0
SELF%RALFDCP = ZTMP0
READ (KLUN) ZTMP0
SELF%RTWAT = ZTMP0
READ (KLUN) ZTMP0
SELF%RTBER = ZTMP0
READ (KLUN) ZTMP0
SELF%RTBERCU = ZTMP0
READ (KLUN) ZTMP0
SELF%RTICE = ZTMP0
READ (KLUN) ZTMP0
SELF%RTICECU = ZTMP0
READ (KLUN) ZTMP0
SELF%RTWAT_RTICE_R = ZTMP0
READ (KLUN) ZTMP0
SELF%RTWAT_RTICECU_R = ZTMP0
READ (KLUN) ZTMP0
SELF%RKOOP1 = ZTMP0
READ (KLUN) ZTMP0
SELF%RKOOP2 = ZTMP0
END SUBROUTINE

SUBROUTINE ACDC_COPY_TTHF (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTHF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TTHF (SELF)

IMPLICIT NONE
TYPE (TTHF), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TTHF (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TTHF), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R2ES), CDPATH//'%R2ES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R3LES), CDPATH//'%R3LES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R3IES), CDPATH//'%R3IES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R4LES), CDPATH//'%R4LES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R4IES), CDPATH//'%R4IES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R5LES), CDPATH//'%R5LES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R5IES), CDPATH//'%R5IES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RVTMP2), CDPATH//'%RVTMP2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RHOH2O), CDPATH//'%RHOH2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R5ALVCP), CDPATH//'%R5ALVCP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R5ALSCP), CDPATH//'%R5ALSCP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RALVDCP), CDPATH//'%RALVDCP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RALSDCP), CDPATH//'%RALSDCP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RALFDCP), CDPATH//'%RALFDCP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTWAT), CDPATH//'%RTWAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTBER), CDPATH//'%RTBER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTBERCU), CDPATH//'%RTBERCU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTICE), CDPATH//'%RTICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTICECU), CDPATH//'%RTICECU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTWAT_RTICE_R), CDPATH//'%RTWAT_RTICE_R'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTWAT_RTICECU_R), CDPATH//'%RTWAT_RTICECU_R'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RKOOP1), CDPATH//'%RKOOP1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RKOOP2), CDPATH//'%RKOOP2'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TTHF (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTHF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TTHF (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TTHF),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%R2ES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R2ES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R3LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R3LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R3IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R3IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R4LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R4LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R4IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R4IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R5LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R5IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RVTMP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVTMP2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RHOH2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RHOH2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R5ALVCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5ALVCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%R5ALSCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5ALSCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RALVDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALVDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RALSDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALSDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RALFDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALFDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTWAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTBER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTBER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTBERCU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTBERCU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTICECU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTICECU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTWAT_RTICE_R)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT_RTICE_R'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTWAT_RTICECU_R)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT_RTICECU_R'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RKOOP1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RKOOP1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RKOOP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RKOOP2'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
