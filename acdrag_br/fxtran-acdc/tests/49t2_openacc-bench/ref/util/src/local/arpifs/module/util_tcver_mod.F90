MODULE UTIL_TCVER_MOD

USE YOMCVER, ONLY : TCVER

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TCVER
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TCVER
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TCVER
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TCVER
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TCVER
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TCVER
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TCVER
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TCVER (SELF, KLUN)

IMPLICIT NONE
TYPE (TCVER), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%LAPRXPK
WRITE (KLUN) SELF%NDLNPR
WRITE (KLUN) SELF%RHYDR0
WRITE (KLUN) SELF%LREGETA
WRITE (KLUN) SELF%LVFE_REGETA
WRITE (KLUN) SELF%NVFE_TYPE
WRITE (KLUN) SELF%NVFE_ORDER
WRITE (KLUN) SELF%NVFE_INTERNALS
WRITE (KLUN) SELF%LVERTFE
WRITE (KLUN) SELF%LVFE_LAPL_BC
WRITE (KLUN) SELF%LVFE_GW
WRITE (KLUN) SELF%LVFE_GW_HALF
WRITE (KLUN) SELF%LVFE_GWMPA
WRITE (KLUN) SELF%LVFE_CHEB
WRITE (KLUN) SELF%LVFE_ECMWF
WRITE (KLUN) SELF%LVFE_NOBC
WRITE (KLUN) SELF%LVFE_VERBOSE
WRITE (KLUN) SELF%LVFE_NORMALIZE
WRITE (KLUN) SELF%LDYN_ANALYSIS_STABILITY
WRITE (KLUN) SELF%LPERCENTILS
WRITE (KLUN) SELF%LVFE_COMPATIBLE
WRITE (KLUN) SELF%LVFE_FD_MIX
WRITE (KLUN) SELF%LVFE_SILAPL
WRITE (KLUN) SELF%LVFD_COMPATIBLE
WRITE (KLUN) SELF%LREFINE_NHPRE_BBC
WRITE (KLUN) SELF%RVFE_ALPHA
WRITE (KLUN) SELF%RVFE_BETA
WRITE (KLUN) SELF%RVFE_KNOT_STRETCH
WRITE (KLUN) SELF%RFAC1
WRITE (KLUN) SELF%RFAC2
WRITE (KLUN) SELF%CVFE_ETAH
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TCVER (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TCVER), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) SELF%LAPRXPK
READ (KLUN) SELF%NDLNPR
READ (KLUN) ZTMP0
SELF%RHYDR0 = ZTMP0
READ (KLUN) SELF%LREGETA
READ (KLUN) SELF%LVFE_REGETA
READ (KLUN) SELF%NVFE_TYPE
READ (KLUN) SELF%NVFE_ORDER
READ (KLUN) SELF%NVFE_INTERNALS
READ (KLUN) SELF%LVERTFE
READ (KLUN) SELF%LVFE_LAPL_BC
READ (KLUN) SELF%LVFE_GW
READ (KLUN) SELF%LVFE_GW_HALF
READ (KLUN) SELF%LVFE_GWMPA
READ (KLUN) SELF%LVFE_CHEB
READ (KLUN) SELF%LVFE_ECMWF
READ (KLUN) SELF%LVFE_NOBC
READ (KLUN) SELF%LVFE_VERBOSE
READ (KLUN) SELF%LVFE_NORMALIZE
READ (KLUN) SELF%LDYN_ANALYSIS_STABILITY
READ (KLUN) SELF%LPERCENTILS
READ (KLUN) SELF%LVFE_COMPATIBLE
READ (KLUN) SELF%LVFE_FD_MIX
READ (KLUN) SELF%LVFE_SILAPL
READ (KLUN) SELF%LVFD_COMPATIBLE
READ (KLUN) SELF%LREFINE_NHPRE_BBC
READ (KLUN) ZTMP0
SELF%RVFE_ALPHA = ZTMP0
READ (KLUN) ZTMP0
SELF%RVFE_BETA = ZTMP0
READ (KLUN) ZTMP0
SELF%RVFE_KNOT_STRETCH = ZTMP0
READ (KLUN) ZTMP0
SELF%RFAC1 = ZTMP0
READ (KLUN) ZTMP0
SELF%RFAC2 = ZTMP0
READ (KLUN) SELF%CVFE_ETAH
END SUBROUTINE

SUBROUTINE ACDC_COPY_TCVER (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCVER), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TCVER (SELF)

IMPLICIT NONE
TYPE (TCVER), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TCVER (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TCVER), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAPRXPK), CDPATH//'%LAPRXPK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDLNPR), CDPATH//'%NDLNPR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RHYDR0), CDPATH//'%RHYDR0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LREGETA), CDPATH//'%LREGETA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_REGETA), CDPATH//'%LVFE_REGETA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVFE_TYPE), CDPATH//'%NVFE_TYPE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVFE_ORDER), CDPATH//'%NVFE_ORDER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVFE_INTERNALS), CDPATH//'%NVFE_INTERNALS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVERTFE), CDPATH//'%LVERTFE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_LAPL_BC), CDPATH//'%LVFE_LAPL_BC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_GW), CDPATH//'%LVFE_GW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_GW_HALF), CDPATH//'%LVFE_GW_HALF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_GWMPA), CDPATH//'%LVFE_GWMPA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_CHEB), CDPATH//'%LVFE_CHEB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_ECMWF), CDPATH//'%LVFE_ECMWF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_NOBC), CDPATH//'%LVFE_NOBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_VERBOSE), CDPATH//'%LVFE_VERBOSE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_NORMALIZE), CDPATH//'%LVFE_NORMALIZE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDYN_ANALYSIS_STABILITY), CDPATH//'%LDYN_ANALYSIS_STABILITY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LPERCENTILS), CDPATH//'%LPERCENTILS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_COMPATIBLE), CDPATH//'%LVFE_COMPATIBLE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_FD_MIX), CDPATH//'%LVFE_FD_MIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFE_SILAPL), CDPATH//'%LVFE_SILAPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVFD_COMPATIBLE), CDPATH//'%LVFD_COMPATIBLE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LREFINE_NHPRE_BBC), CDPATH//'%LREFINE_NHPRE_BBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RVFE_ALPHA), CDPATH//'%RVFE_ALPHA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RVFE_BETA), CDPATH//'%RVFE_BETA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RVFE_KNOT_STRETCH), CDPATH//'%RVFE_KNOT_STRETCH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RFAC1), CDPATH//'%RFAC1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RFAC2), CDPATH//'%RFAC2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVFE_ETAH), CDPATH//'%CVFE_ETAH'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TCVER (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCVER), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TCVER (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TCVER),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LAPRXPK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAPRXPK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDLNPR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDLNPR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RHYDR0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RHYDR0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LREGETA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LREGETA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_REGETA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_REGETA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVFE_TYPE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVFE_TYPE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVFE_ORDER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVFE_ORDER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVFE_INTERNALS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVFE_INTERNALS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVERTFE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVERTFE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_LAPL_BC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_LAPL_BC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_GW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_GW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_GW_HALF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_GW_HALF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_GWMPA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_GWMPA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_CHEB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_CHEB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_ECMWF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_ECMWF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_NOBC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_NOBC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_VERBOSE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_VERBOSE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_NORMALIZE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_NORMALIZE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDYN_ANALYSIS_STABILITY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDYN_ANALYSIS_STABILITY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LPERCENTILS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LPERCENTILS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_COMPATIBLE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_COMPATIBLE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_FD_MIX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_FD_MIX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFE_SILAPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFE_SILAPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVFD_COMPATIBLE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVFD_COMPATIBLE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LREFINE_NHPRE_BBC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LREFINE_NHPRE_BBC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RVFE_ALPHA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVFE_ALPHA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RVFE_BETA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVFE_BETA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RVFE_KNOT_STRETCH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVFE_KNOT_STRETCH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RFAC1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFAC1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RFAC2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFAC2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CVFE_ETAH) * LEN (SELF%CVFE_ETAH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CVFE_ETAH'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
