MODULE UTIL_TVDOZ_MOD

USE YOMVDOZ, ONLY : TVDOZ

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TVDOZ
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TVDOZ
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TVDOZ
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TVDOZ
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TVDOZ
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TVDOZ
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TVDOZ
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TVDOZ (SELF, KLUN)

IMPLICIT NONE
TYPE (TVDOZ), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%VDHJS
WRITE (KLUN) SELF%VDHJH
WRITE (KLUN) SELF%VDHNS
WRITE (KLUN) SELF%VDHNH
WRITE (KLUN) SELF%VDPJS
WRITE (KLUN) SELF%VDPJH
WRITE (KLUN) SELF%VDPNS
WRITE (KLUN) SELF%VDPNH
WRITE (KLUN) SELF%VDEJS
WRITE (KLUN) SELF%VDEJH
WRITE (KLUN) SELF%VDENS
WRITE (KLUN) SELF%VDENH
WRITE (KLUN) SELF%VDAJS
WRITE (KLUN) SELF%VDAJH
WRITE (KLUN) SELF%VDANS
WRITE (KLUN) SELF%VDANH
WRITE (KLUN) SELF%VDNJS
WRITE (KLUN) SELF%VDNJH
WRITE (KLUN) SELF%VDNNS
WRITE (KLUN) SELF%VDNNH
WRITE (KLUN) SELF%VOZNJ
WRITE (KLUN) SELF%VOZHS
WRITE (KLUN) SELF%LRDIFOZ
WRITE (KLUN) SELF%LRDEPOZ
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TVDOZ (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TVDOZ), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
ALLOCATE (ZTMP1(LBOUND(SELF%VDHJS,1):UBOUND(SELF%VDHJS,1)))
READ (KLUN) ZTMP1
SELF%VDHJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDHJH,1):UBOUND(SELF%VDHJH,1)))
READ (KLUN) ZTMP1
SELF%VDHJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDHNS,1):UBOUND(SELF%VDHNS,1)))
READ (KLUN) ZTMP1
SELF%VDHNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDHNH,1):UBOUND(SELF%VDHNH,1)))
READ (KLUN) ZTMP1
SELF%VDHNH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDPJS,1):UBOUND(SELF%VDPJS,1)))
READ (KLUN) ZTMP1
SELF%VDPJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDPJH,1):UBOUND(SELF%VDPJH,1)))
READ (KLUN) ZTMP1
SELF%VDPJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDPNS,1):UBOUND(SELF%VDPNS,1)))
READ (KLUN) ZTMP1
SELF%VDPNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDPNH,1):UBOUND(SELF%VDPNH,1)))
READ (KLUN) ZTMP1
SELF%VDPNH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDEJS,1):UBOUND(SELF%VDEJS,1)))
READ (KLUN) ZTMP1
SELF%VDEJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDEJH,1):UBOUND(SELF%VDEJH,1)))
READ (KLUN) ZTMP1
SELF%VDEJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDENS,1):UBOUND(SELF%VDENS,1)))
READ (KLUN) ZTMP1
SELF%VDENS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDENH,1):UBOUND(SELF%VDENH,1)))
READ (KLUN) ZTMP1
SELF%VDENH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDAJS,1):UBOUND(SELF%VDAJS,1)))
READ (KLUN) ZTMP1
SELF%VDAJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDAJH,1):UBOUND(SELF%VDAJH,1)))
READ (KLUN) ZTMP1
SELF%VDAJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDANS,1):UBOUND(SELF%VDANS,1)))
READ (KLUN) ZTMP1
SELF%VDANS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDANH,1):UBOUND(SELF%VDANH,1)))
READ (KLUN) ZTMP1
SELF%VDANH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDNJS,1):UBOUND(SELF%VDNJS,1)))
READ (KLUN) ZTMP1
SELF%VDNJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDNJH,1):UBOUND(SELF%VDNJH,1)))
READ (KLUN) ZTMP1
SELF%VDNJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDNNS,1):UBOUND(SELF%VDNNS,1)))
READ (KLUN) ZTMP1
SELF%VDNNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%VDNNH,1):UBOUND(SELF%VDNNH,1)))
READ (KLUN) ZTMP1
SELF%VDNNH = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
SELF%VOZNJ = ZTMP0
READ (KLUN) ZTMP0
SELF%VOZHS = ZTMP0
READ (KLUN) SELF%LRDIFOZ
READ (KLUN) SELF%LRDEPOZ
END SUBROUTINE

SUBROUTINE ACDC_COPY_TVDOZ (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVDOZ), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TVDOZ (SELF)

IMPLICIT NONE
TYPE (TVDOZ), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TVDOZ (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TVDOZ), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDHJS), CDPATH//'%VDHJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDHJH), CDPATH//'%VDHJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDHNS), CDPATH//'%VDHNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDHNH), CDPATH//'%VDHNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDPJS), CDPATH//'%VDPJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDPJH), CDPATH//'%VDPJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDPNS), CDPATH//'%VDPNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDPNH), CDPATH//'%VDPNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDEJS), CDPATH//'%VDEJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDEJH), CDPATH//'%VDEJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDENS), CDPATH//'%VDENS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDENH), CDPATH//'%VDENH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDAJS), CDPATH//'%VDAJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDAJH), CDPATH//'%VDAJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDANS), CDPATH//'%VDANS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDANH), CDPATH//'%VDANH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDNJS), CDPATH//'%VDNJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDNJH), CDPATH//'%VDNJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDNNS), CDPATH//'%VDNNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VDNNH), CDPATH//'%VDNNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VOZNJ), CDPATH//'%VOZNJ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VOZHS), CDPATH//'%VOZHS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRDIFOZ), CDPATH//'%LRDIFOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRDEPOZ), CDPATH//'%LRDEPOZ'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TVDOZ (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVDOZ), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TVDOZ (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TVDOZ),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%VDHJS) * SIZE (SELF%VDHJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDHJH) * SIZE (SELF%VDHJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDHNS) * SIZE (SELF%VDHNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDHNH) * SIZE (SELF%VDHNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDPJS) * SIZE (SELF%VDPJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDPJH) * SIZE (SELF%VDPJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDPNS) * SIZE (SELF%VDPNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDPNH) * SIZE (SELF%VDPNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDEJS) * SIZE (SELF%VDEJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDEJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDEJH) * SIZE (SELF%VDEJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDEJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDENS) * SIZE (SELF%VDENS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDENS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDENH) * SIZE (SELF%VDENH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDENH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDAJS) * SIZE (SELF%VDAJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDAJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDAJH) * SIZE (SELF%VDAJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDAJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDANS) * SIZE (SELF%VDANS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDANS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDANH) * SIZE (SELF%VDANH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDANH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDNJS) * SIZE (SELF%VDNJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDNJH) * SIZE (SELF%VDNJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDNNS) * SIZE (SELF%VDNNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VDNNH) * SIZE (SELF%VDNNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VOZNJ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VOZNJ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%VOZHS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VOZHS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRDIFOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDIFOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRDEPOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDEPOZ'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
