MODULE UTIL_TDPRECIPS_MOD

USE YOMDPRECIPS, ONLY : TDPRECIPS

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TDPRECIPS
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TDPRECIPS
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TDPRECIPS
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TDPRECIPS
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TDPRECIPS
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TDPRECIPS
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TDPRECIPS
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TDPRECIPS (SELF, KLUN)

IMPLICIT NONE
TYPE (TDPRECIPS), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN

WRITE (KLUN) SELF%HDPRECIPS
WRITE (KLUN) SELF%HDCLWC
WRITE (KLUN) SELF%RDHAIL1
WRITE (KLUN) SELF%RDHAIL2
WRITE (KLUN) SELF%RDSEUIL1
WRITE (KLUN) SELF%RDSEUIL2
WRITE (KLUN) SELF%RDSEUIL3
WRITE (KLUN) SELF%RDSEUIL4
WRITE (KLUN) SELF%RDSEUIL5
WRITE (KLUN) SELF%RDCLWC
WRITE (KLUN) SELF%RPRECSEUIL
WRITE (KLUN) SELF%RHTOP
WRITE (KLUN) SELF%RTPW
WRITE (KLUN) SELF%RAWARM
WRITE (KLUN) SELF%RAWARM2
WRITE (KLUN) SELF%RACOLD
WRITE (KLUN) SELF%RACOLD2
WRITE (KLUN) SELF%NDTPREC
WRITE (KLUN) SELF%NDTPREC2
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TDPRECIPS (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TDPRECIPS), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) ZTMP0
SELF%HDPRECIPS = ZTMP0
READ (KLUN) ZTMP0
SELF%HDCLWC = ZTMP0
READ (KLUN) ZTMP0
SELF%RDHAIL1 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDHAIL2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDSEUIL1 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDSEUIL2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDSEUIL3 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDSEUIL4 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDSEUIL5 = ZTMP0
READ (KLUN) ZTMP0
SELF%RDCLWC = ZTMP0
READ (KLUN) ZTMP0
SELF%RPRECSEUIL = ZTMP0
READ (KLUN) ZTMP0
SELF%RHTOP = ZTMP0
READ (KLUN) ZTMP0
SELF%RTPW = ZTMP0
READ (KLUN) ZTMP0
SELF%RAWARM = ZTMP0
READ (KLUN) ZTMP0
SELF%RAWARM2 = ZTMP0
READ (KLUN) ZTMP0
SELF%RACOLD = ZTMP0
READ (KLUN) ZTMP0
SELF%RACOLD2 = ZTMP0
READ (KLUN) SELF%NDTPREC
READ (KLUN) SELF%NDTPREC2
END SUBROUTINE

SUBROUTINE ACDC_COPY_TDPRECIPS (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TDPRECIPS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TDPRECIPS (SELF)

IMPLICIT NONE
TYPE (TDPRECIPS), TARGET :: SELF


END SUBROUTINE



SUBROUTINE ACDC_CRC64_TDPRECIPS (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TDPRECIPS), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HDPRECIPS), CDPATH//'%HDPRECIPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%HDCLWC), CDPATH//'%HDCLWC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDHAIL1), CDPATH//'%RDHAIL1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDHAIL2), CDPATH//'%RDHAIL2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSEUIL1), CDPATH//'%RDSEUIL1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSEUIL2), CDPATH//'%RDSEUIL2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSEUIL3), CDPATH//'%RDSEUIL3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSEUIL4), CDPATH//'%RDSEUIL4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSEUIL5), CDPATH//'%RDSEUIL5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDCLWC), CDPATH//'%RDCLWC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPRECSEUIL), CDPATH//'%RPRECSEUIL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RHTOP), CDPATH//'%RHTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTPW), CDPATH//'%RTPW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAWARM), CDPATH//'%RAWARM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAWARM2), CDPATH//'%RAWARM2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RACOLD), CDPATH//'%RACOLD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RACOLD2), CDPATH//'%RACOLD2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPREC), CDPATH//'%NDTPREC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPREC2), CDPATH//'%NDTPREC2'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TDPRECIPS (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TDPRECIPS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TDPRECIPS (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TDPRECIPS),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%HDPRECIPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HDPRECIPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%HDCLWC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HDCLWC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDHAIL1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDHAIL1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDHAIL2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDHAIL2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDSEUIL1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDSEUIL1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDSEUIL2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDSEUIL2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDSEUIL3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDSEUIL3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDSEUIL4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDSEUIL4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDSEUIL5)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDSEUIL5'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDCLWC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDCLWC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPRECSEUIL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPRECSEUIL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RHTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RHTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTPW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTPW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAWARM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAWARM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAWARM2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAWARM2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RACOLD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RACOLD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RACOLD2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RACOLD2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDTPREC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDTPREC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDTPREC2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDTPREC2'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
