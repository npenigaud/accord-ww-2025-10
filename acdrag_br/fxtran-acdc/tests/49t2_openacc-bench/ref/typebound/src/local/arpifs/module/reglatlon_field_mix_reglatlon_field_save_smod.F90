SUBMODULE (REGLATLON_FIELD_MIX) REGLATLON_FIELD_MIX_REGLATLON_FIELD_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_REGLATLON_FIELD (SELF, KLUN)

IMPLICIT NONE
CLASS (REGLATLON_FIELD), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LPFLD, LPLAT, LPLON, LPSIN
WRITE (KLUN) SELF%NLAT
WRITE (KLUN) SELF%NLON
WRITE (KLUN) SELF%DLAT
WRITE (KLUN) SELF%DLON
LPFLD = ASSOCIATED (SELF%PFLD)
WRITE (KLUN) LPFLD
IF (LPFLD) THEN
  WRITE (KLUN) LBOUND (SELF%PFLD)
  WRITE (KLUN) UBOUND (SELF%PFLD)
  WRITE (KLUN) SELF%PFLD
ENDIF
LPLAT = ASSOCIATED (SELF%PLAT)
WRITE (KLUN) LPLAT
IF (LPLAT) THEN
  WRITE (KLUN) LBOUND (SELF%PLAT)
  WRITE (KLUN) UBOUND (SELF%PLAT)
  WRITE (KLUN) SELF%PLAT
ENDIF
LPSIN = ASSOCIATED (SELF%PSIN)
WRITE (KLUN) LPSIN
IF (LPSIN) THEN
  WRITE (KLUN) LBOUND (SELF%PSIN)
  WRITE (KLUN) UBOUND (SELF%PSIN)
  WRITE (KLUN) SELF%PSIN
ENDIF
LPLON = ASSOCIATED (SELF%PLON)
WRITE (KLUN) LPLON
IF (LPLON) THEN
  WRITE (KLUN) LBOUND (SELF%PLON)
  WRITE (KLUN) UBOUND (SELF%PLON)
  WRITE (KLUN) SELF%PLON
ENDIF
END SUBROUTINE

END SUBMODULE
