SUBMODULE (YOMCHEM) YOMCHEM_TCHEM_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TCHEM (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TCHEM), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LTCO2DG, LTCOTOP
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) SELF%CHEM_SCHEME
READ (KLUN) SELF%LCHEM_DIAC
READ (KLUN) SELF%LCHEM_BASCOE_JON
READ (KLUN) SELF%LCHEM_BASCOE_HETCHEM
READ (KLUN) SELF%LCHEM_EXTENDJNO2
READ (KLUN) SELF%LMOZART_RSF_DUMMY
READ (KLUN) SELF%LCHEM_JOUT
READ (KLUN) SELF%LCHEM_LIGHT
READ (KLUN) ZTMP0
SELF%RCHEM_LINOX_SCALING = ZTMP0
READ (KLUN) SELF%LCHEM_ACNOX
READ (KLUN) SELF%KCHEM_NOXADV
READ (KLUN) SELF%KCHEM_WETDEP
READ (KLUN) SELF%KCHEM_DRYDEP
READ (KLUN) SELF%LCHEM_REVCHEM
READ (KLUN) SELF%LCHEM_STMA
READ (KLUN) SELF%LCHEM_ANAO3
ALLOCATE (ZTMP2(LBOUND(SELF%SMASSCOR,1):UBOUND(SELF%SMASSCOR,1), LBOUND(SELF%SMASSCOR,2):UBOUND(SELF%SMASSCOR,2)))
READ (KLUN) ZTMP2
SELF%SMASSCOR = ZTMP2
DEALLOCATE (ZTMP2)
READ (KLUN) SELF%LCHEM_0NOX
READ (KLUN) SELF%LCHEM_ANACH4
READ (KLUN) SELF%LCHEM_WEAK_CH4_RELAXATION
READ (KLUN) SELF%LCHEM_CONVSCAV
READ (KLUN) SELF%LCHEM_CSHAPE
READ (KLUN) SELF%LCHEM_CSHAPE98
READ (KLUN) SELF%LCHEM_WDFR
READ (KLUN) SELF%LCHEM_HTAP
READ (KLUN) SELF%KCHEM_YEARPI
READ (KLUN) ZTMP0
SELF%RCH4CONST = ZTMP0
READ (KLUN) SELF%KCHEM_SOLVE
READ (KLUN) SELF%LCHEM_O3RAD
READ (KLUN) SELF%LCHEM_TL
READ (KLUN) SELF%LCHEM_AEROI
READ (KLUN) SELF%IEXTR_FREE
READ (KLUN) SELF%NUCOCH1
READ (KLUN) SELF%NUCOCH2
READ (KLUN) SELF%NCHEM_LCOCOEF
READ (KLUN) SELF%CHEM_LCOVERS
READ (KLUN) SELF%LCHEM_LCOMESO
READ (KLUN) SELF%LCHEM_LCOCSTCLIM
READ (KLUN) ZTMP0
SELF%RCHEM_LCOTAUTOP = ZTMP0
READ (KLUN) ZTMP0
SELF%RCHEM_LCOCLIMTOP = ZTMP0
READ (KLUN) SELF%LCHEM_LCOLIMIT
READ (KLUN) ZTMP0
SELF%RCHEM_LCOCOEFA1 = ZTMP0
READ (KLUN) SELF%CSOLMET_ASIS
READ (KLUN) SELF%M_SOLITER_ASIS
READ (KLUN) ZTMP0
SELF%SOLCV_ASIS = ZTMP0
READ (KLUN) ZTMP0
SELF%RTOL_ASIS = ZTMP0
READ (KLUN) ZTMP0
SELF%ATOL_ASIS = ZTMP0
READ (KLUN) SELF%N_F_RTOL_ASIS
READ (KLUN) SELF%N_F_ATOL_ASIS
READ (KLUN) LTCO2DG
IF (LTCO2DG) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%TCO2DG (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%TCO2DG,1):UBOUND(SELF%TCO2DG,1), LBOUND(SELF%TCO2DG,2):UBOUND(SELF%TCO2DG,2)))
  READ (KLUN) ZTMP2
  SELF%TCO2DG = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LTCOTOP
IF (LTCOTOP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%TCOTOP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%TCOTOP,1):UBOUND(SELF%TCOTOP,1)))
  READ (KLUN) ZTMP1
  SELF%TCOTOP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) SELF%LCHEM_ARPCLIM
READ (KLUN) SELF%LCHEM_EMICH4
END SUBROUTINE

END SUBMODULE
