SUBMODULE (YOMMODERRMOD) YOMMODERRMOD_TMODERR_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TMODERR (SELF, KLUN)

IMPLICIT NONE
CLASS (TMODERR), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LFSTEPERR, LMSTEPERR, LTSTEPERR
WRITE (KLUN) SELF%LSCALERR
WRITE (KLUN) SELF%LTAPERERR
WRITE (KLUN) SELF%NTYPE_MODERR
WRITE (KLUN) SELF%NSTEP_MODERR
WRITE (KLUN) SELF%NORDER_MODERR
WRITE (KLUN) SELF%NPRTMODERR
WRITE (KLUN) SELF%TAPERERR_INI
WRITE (KLUN) SELF%TAPERERR_END
WRITE (KLUN) SELF%TSTEP_ERR
LMSTEPERR = ALLOCATED (SELF%MSTEPERR)
WRITE (KLUN) LMSTEPERR
IF (LMSTEPERR) THEN
  WRITE (KLUN) LBOUND (SELF%MSTEPERR)
  WRITE (KLUN) UBOUND (SELF%MSTEPERR)
  WRITE (KLUN) SELF%MSTEPERR
ENDIF
LTSTEPERR = ALLOCATED (SELF%TSTEPERR)
WRITE (KLUN) LTSTEPERR
IF (LTSTEPERR) THEN
  WRITE (KLUN) LBOUND (SELF%TSTEPERR)
  WRITE (KLUN) UBOUND (SELF%TSTEPERR)
  WRITE (KLUN) SELF%TSTEPERR
ENDIF
LFSTEPERR = ALLOCATED (SELF%FSTEPERR)
WRITE (KLUN) LFSTEPERR
IF (LFSTEPERR) THEN
  WRITE (KLUN) LBOUND (SELF%FSTEPERR)
  WRITE (KLUN) UBOUND (SELF%FSTEPERR)
  WRITE (KLUN) SELF%FSTEPERR
ENDIF
END SUBROUTINE

END SUBMODULE
