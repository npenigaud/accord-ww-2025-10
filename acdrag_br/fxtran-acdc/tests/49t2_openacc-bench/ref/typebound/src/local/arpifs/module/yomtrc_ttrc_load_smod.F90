SUBMODULE (YOMTRC) YOMTRC_TTRC_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_TTRC (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TTRC), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) LGRSURF
IF (LGRSURF) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GRSURF (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GRSURF,1):UBOUND(SELF%GRSURF,1), LBOUND(SELF%GRSURF,2):UBOUND(SELF%GRSURF,2)))
  READ (KLUN) ZTMP2
  SELF%GRSURF = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LGDEOTI
IF (LGDEOTI) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GDEOTI (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GDEOTI,1):UBOUND(SELF%GDEOTI,1), LBOUND(SELF%GDEOTI,2):UBOUND(SELF%GDEOTI,2), LBOUND(SELF%GDEOTI,3):UBOUND(SELF%GDEOTI,3)))
  READ (KLUN) ZTMP3
  SELF%GDEOTI = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGDEOTI2
IF (LGDEOTI2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GDEOTI2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GDEOTI2,1):UBOUND(SELF%GDEOTI2,1), LBOUND(SELF%GDEOTI2,2):UBOUND(SELF%GDEOTI2,2), LBOUND(SELF%GDEOTI2,3):UBOUND(SELF%GDEOTI2,3)))
  READ (KLUN) ZTMP3
  SELF%GDEOTI2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGUEOTI
IF (LGUEOTI) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GUEOTI (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GUEOTI,1):UBOUND(SELF%GUEOTI,1), LBOUND(SELF%GUEOTI,2):UBOUND(SELF%GUEOTI,2), LBOUND(SELF%GUEOTI,3):UBOUND(SELF%GUEOTI,3)))
  READ (KLUN) ZTMP3
  SELF%GUEOTI = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGUEOTI2
IF (LGUEOTI2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GUEOTI2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GUEOTI2,1):UBOUND(SELF%GUEOTI2,1), LBOUND(SELF%GUEOTI2,2):UBOUND(SELF%GUEOTI2,2), LBOUND(SELF%GUEOTI2,3):UBOUND(SELF%GUEOTI2,3)))
  READ (KLUN) ZTMP3
  SELF%GUEOTI2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGEOLT
IF (LGEOLT) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GEOLT (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GEOLT,1):UBOUND(SELF%GEOLT,1), LBOUND(SELF%GEOLT,2):UBOUND(SELF%GEOLT,2), LBOUND(SELF%GEOLT,3):UBOUND(SELF%GEOLT,3)))
  READ (KLUN) ZTMP3
  SELF%GEOLT = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGEOXT
IF (LGEOXT) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GEOXT (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GEOXT,1):UBOUND(SELF%GEOXT,1), LBOUND(SELF%GEOXT,2):UBOUND(SELF%GEOXT,2), LBOUND(SELF%GEOXT,3):UBOUND(SELF%GEOXT,3)))
  READ (KLUN) ZTMP3
  SELF%GEOXT = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGRPROX
IF (LGRPROX) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GRPROX (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GRPROX,1):UBOUND(SELF%GRPROX,1), LBOUND(SELF%GRPROX,2):UBOUND(SELF%GRPROX,2), LBOUND(SELF%GRPROX,3):UBOUND(SELF%GRPROX,3)))
  READ (KLUN) ZTMP3
  SELF%GRPROX = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGMIXP
IF (LGMIXP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GMIXP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GMIXP,1):UBOUND(SELF%GMIXP,1), LBOUND(SELF%GMIXP,2):UBOUND(SELF%GMIXP,2), LBOUND(SELF%GMIXP,3):UBOUND(SELF%GMIXP,3)))
  READ (KLUN) ZTMP3
  SELF%GMIXP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGFLUXC
IF (LGFLUXC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GFLUXC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GFLUXC,1):UBOUND(SELF%GFLUXC,1), LBOUND(SELF%GFLUXC,2):UBOUND(SELF%GFLUXC,2), LBOUND(SELF%GFLUXC,3):UBOUND(SELF%GFLUXC,3)))
  READ (KLUN) ZTMP3
  SELF%GFLUXC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGDEOSI
IF (LGDEOSI) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%GDEOSI (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%GDEOSI,1):UBOUND(SELF%GDEOSI,1), LBOUND(SELF%GDEOSI,2):UBOUND(SELF%GDEOSI,2), LBOUND(SELF%GDEOSI,3):UBOUND(SELF%GDEOSI,3), LBOUND(SELF%GDEOSI,4):UBOUND(SELF%GDEOSI,4)))
  READ (KLUN) ZTMP4
  SELF%GDEOSI = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LGUEOSI
IF (LGUEOSI) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%GUEOSI (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%GUEOSI,1):UBOUND(SELF%GUEOSI,1), LBOUND(SELF%GUEOSI,2):UBOUND(SELF%GUEOSI,2), LBOUND(SELF%GUEOSI,3):UBOUND(SELF%GUEOSI,3), LBOUND(SELF%GUEOSI,4):UBOUND(SELF%GUEOSI,4)))
  READ (KLUN) ZTMP4
  SELF%GUEOSI = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LGMU0
IF (LGMU0) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GMU0 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GMU0,1):UBOUND(SELF%GMU0,1), LBOUND(SELF%GMU0,2):UBOUND(SELF%GMU0,2), LBOUND(SELF%GMU0,3):UBOUND(SELF%GMU0,3)))
  READ (KLUN) ZTMP3
  SELF%GMU0 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGMU0_MIN
IF (LGMU0_MIN) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GMU0_MIN (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GMU0_MIN,1):UBOUND(SELF%GMU0_MIN,1), LBOUND(SELF%GMU0_MIN,2):UBOUND(SELF%GMU0_MIN,2)))
  READ (KLUN) ZTMP2
  SELF%GMU0_MIN = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LGMU0_MAX
IF (LGMU0_MAX) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GMU0_MAX (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GMU0_MAX,1):UBOUND(SELF%GMU0_MAX,1), LBOUND(SELF%GMU0_MAX,2):UBOUND(SELF%GMU0_MAX,2)))
  READ (KLUN) ZTMP2
  SELF%GMU0_MAX = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE

END SUBMODULE
