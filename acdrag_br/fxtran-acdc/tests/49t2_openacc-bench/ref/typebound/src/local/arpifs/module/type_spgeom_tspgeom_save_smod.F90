SUBMODULE (TYPE_SPGEOM) TYPE_SPGEOM_TSPGEOM_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TSPGEOM (SELF, KLUN)

IMPLICIT NONE
CLASS (TSPGEOM), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LGMR, LSCGMAP
LGMR = ALLOCATED (SELF%GMR)
WRITE (KLUN) LGMR
IF (LGMR) THEN
  WRITE (KLUN) LBOUND (SELF%GMR)
  WRITE (KLUN) UBOUND (SELF%GMR)
  WRITE (KLUN) SELF%GMR
ENDIF
LSCGMAP = ALLOCATED (SELF%SCGMAP)
WRITE (KLUN) LSCGMAP
IF (LSCGMAP) THEN
  WRITE (KLUN) LBOUND (SELF%SCGMAP)
  WRITE (KLUN) UBOUND (SELF%SCGMAP)
  WRITE (KLUN) SELF%SCGMAP
ENDIF
WRITE (KLUN) SELF%ESCGMAP
END SUBROUTINE

END SUBMODULE
