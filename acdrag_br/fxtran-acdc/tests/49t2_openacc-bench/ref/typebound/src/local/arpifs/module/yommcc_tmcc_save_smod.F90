SUBMODULE (YOMMCC) YOMMCC_TMCC_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TMCC (SELF, KLUN)

IMPLICIT NONE
CLASS (TMCC), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE
WRITE (KLUN) SELF%N923
WRITE (KLUN) SELF%NCLIMTOT
WRITE (KLUN) SELF%NCLIMR
WRITE (KLUN) SELF%NCLIGC
WRITE (KLUN) SELF%NCLIGC_COMPO
WRITE (KLUN) SELF%NYSDMP_COMPO
WRITE (KLUN) SELF%NCLIMR_COMPO
WRITE (KLUN) SELF%NCLIAER
WRITE (KLUN) SELF%NDIFC
WRITE (KLUN) SELF%NJDCR
WRITE (KLUN) SELF%NJDCR1
WRITE (KLUN) SELF%NDIFC_COMPO
WRITE (KLUN) SELF%NJDCR_COMPO
WRITE (KLUN) SELF%NJDCR1_COMPO
WRITE (KLUN) SELF%NP1
WRITE (KLUN) SELF%NP2
WRITE (KLUN) SELF%NPCO2_1
WRITE (KLUN) SELF%NPCO2_2
WRITE (KLUN) SELF%NPAER_1
WRITE (KLUN) SELF%NPAER_2
WRITE (KLUN) SELF%NPCOMPO_1
WRITE (KLUN) SELF%NPCOMPO_2
WRITE (KLUN) SELF%NUNITC
WRITE (KLUN) SELF%NUNITC1
WRITE (KLUN) SELF%NUNITCM
WRITE (KLUN) SELF%NOACOMM
WRITE (KLUN) SELF%NSSTICEOP
LCLIMRCO2 = ALLOCATED (SELF%CLIMRCO2)
WRITE (KLUN) LCLIMRCO2
IF (LCLIMRCO2) THEN
  WRITE (KLUN) LBOUND (SELF%CLIMRCO2)
  WRITE (KLUN) UBOUND (SELF%CLIMRCO2)
  WRITE (KLUN) SELF%CLIMRCO2
ENDIF
LCLIMRAER = ALLOCATED (SELF%CLIMRAER)
WRITE (KLUN) LCLIMRAER
IF (LCLIMRAER) THEN
  WRITE (KLUN) LBOUND (SELF%CLIMRAER)
  WRITE (KLUN) UBOUND (SELF%CLIMRAER)
  WRITE (KLUN) SELF%CLIMRAER
ENDIF
LCLIMRCOMPO = ALLOCATED (SELF%CLIMRCOMPO)
WRITE (KLUN) LCLIMRCOMPO
IF (LCLIMRCOMPO) THEN
  WRITE (KLUN) LBOUND (SELF%CLIMRCOMPO)
  WRITE (KLUN) UBOUND (SELF%CLIMRCOMPO)
  WRITE (KLUN) SELF%CLIMRCOMPO
ENDIF
LZLAKE = ALLOCATED (SELF%ZLAKE)
WRITE (KLUN) LZLAKE
IF (LZLAKE) THEN
  WRITE (KLUN) LBOUND (SELF%ZLAKE)
  WRITE (KLUN) UBOUND (SELF%ZLAKE)
  WRITE (KLUN) SELF%ZLAKE
ENDIF
LOCEANBC = ALLOCATED (SELF%OCEANBC)
WRITE (KLUN) LOCEANBC
IF (LOCEANBC) THEN
  WRITE (KLUN) LBOUND (SELF%OCEANBC)
  WRITE (KLUN) UBOUND (SELF%OCEANBC)
  WRITE (KLUN) SELF%OCEANBC
ENDIF
LCLIMR = ALLOCATED (SELF%CLIMR)
WRITE (KLUN) LCLIMR
IF (LCLIMR) THEN
  WRITE (KLUN) LBOUND (SELF%CLIMR)
  WRITE (KLUN) UBOUND (SELF%CLIMR)
  WRITE (KLUN) SELF%CLIMR
ENDIF
WRITE (KLUN) SELF%LFIRSTUPD
WRITE (KLUN) SELF%LCURR
WRITE (KLUN) SELF%LGELATO
WRITE (KLUN) SELF%LMCC01_MSE
WRITE (KLUN) SELF%LMCC01
WRITE (KLUN) SELF%LMCC02
WRITE (KLUN) SELF%LMCC03
WRITE (KLUN) SELF%LMCC04
WRITE (KLUN) SELF%LMCC05
WRITE (KLUN) SELF%LMCC06
WRITE (KLUN) SELF%LMCCEC
WRITE (KLUN) SELF%LMCCIEC
WRITE (KLUN) SELF%LMCCIEC_COMPO
WRITE (KLUN) SELF%LMCCICEIC
WRITE (KLUN) SELF%LMCCDYNSEAICE
WRITE (KLUN) SELF%LNEMOCOUP
WRITE (KLUN) SELF%LNEMOFLUXNC
WRITE (KLUN) SELF%LNEMOOUTGRB
WRITE (KLUN) SELF%LCOUPINFOUT
WRITE (KLUN) SELF%LNEMO1WAY
WRITE (KLUN) SELF%LNEMOIFSLOG
WRITE (KLUN) SELF%LNEMOSSTFREEZ
WRITE (KLUN) SELF%LNEMOGRIBFLDS
WRITE (KLUN) SELF%LNEMOGRIBMASK
WRITE (KLUN) SELF%L2DECV2NEMO
WRITE (KLUN) SELF%LMULTIYR
WRITE (KLUN) SELF%LMCC_COMPO
WRITE (KLUN) SELF%NFRCPL
WRITE (KLUN) SELF%LNEMOLIMGET
WRITE (KLUN) SELF%LNEMOLIMPUT
WRITE (KLUN) SELF%LNEMOLIMALB
WRITE (KLUN) SELF%LNEMOLIMTEMP
WRITE (KLUN) SELF%LNEMOLIMTLVL
WRITE (KLUN) SELF%LNEMOLIMTHK
WRITE (KLUN) SELF%LNEMOSICOUP
WRITE (KLUN) SELF%LNEMOATMFLDS
WRITE (KLUN) SELF%LNEMOOCEICEMIX
WRITE (KLUN) SELF%LNEMOQNSICEFILT
WRITE (KLUN) SELF%LNEMOACCUMFLUX
WRITE (KLUN) SELF%LNEMOGRIB3D
WRITE (KLUN) SELF%NNEMO3DLEVS
LRNEMOLVLS = ALLOCATED (SELF%RNEMOLVLS)
WRITE (KLUN) LRNEMOLVLS
IF (LRNEMOLVLS) THEN
  WRITE (KLUN) LBOUND (SELF%RNEMOLVLS)
  WRITE (KLUN) UBOUND (SELF%RNEMOLVLS)
  WRITE (KLUN) SELF%RNEMOLVLS
ENDIF
LRNEMOMASK = ALLOCATED (SELF%RNEMOMASK)
WRITE (KLUN) LRNEMOMASK
IF (LRNEMOMASK) THEN
  WRITE (KLUN) LBOUND (SELF%RNEMOMASK)
  WRITE (KLUN) UBOUND (SELF%RNEMOMASK)
  WRITE (KLUN) SELF%RNEMOMASK
ENDIF
WRITE (KLUN) SELF%LNEMOPARTCOUP
WRITE (KLUN) SELF%LNEMOPARTMASK
WRITE (KLUN) SELF%LNEMOPARTMASKFILE
WRITE (KLUN) SELF%RNPARTRAMPSTART
WRITE (KLUN) SELF%RNPARTRAMPLEN
WRITE (KLUN) SELF%RNPARTLAT
WRITE (KLUN) SELF%RNPARTLATSPREAD
LPARTSST0 = ALLOCATED (SELF%PARTSST0)
WRITE (KLUN) LPARTSST0
IF (LPARTSST0) THEN
  WRITE (KLUN) LBOUND (SELF%PARTSST0)
  WRITE (KLUN) UBOUND (SELF%PARTSST0)
  WRITE (KLUN) SELF%PARTSST0
ENDIF
LPARTMASK = ALLOCATED (SELF%PARTMASK)
WRITE (KLUN) LPARTMASK
IF (LPARTMASK) THEN
  WRITE (KLUN) LBOUND (SELF%PARTMASK)
  WRITE (KLUN) UBOUND (SELF%PARTMASK)
  WRITE (KLUN) SELF%PARTMASK
ENDIF
WRITE (KLUN) SELF%CDNPARTMASKFILE
LCPLNG_FLD = ALLOCATED (SELF%CPLNG_FLD)
WRITE (KLUN) LCPLNG_FLD
IF (LCPLNG_FLD) THEN
  WRITE (KLUN) LBOUND (SELF%CPLNG_FLD)
  WRITE (KLUN) UBOUND (SELF%CPLNG_FLD)
  DO J1 = LBOUND (SELF%CPLNG_FLD, 1), UBOUND (SELF%CPLNG_FLD, 1)
    CALL SELF%CPLNG_FLD (J1)%ACDC_SAVE (KLUN)
  ENDDO
ENDIF
WRITE (KLUN) SELF%CPLNG_ACTIVE
WRITE (KLUN) SELF%CPLNG_NUM_FIELDS
WRITE (KLUN) SELF%IP_A_SST
WRITE (KLUN) SELF%IP_A_ICE_FRAC
WRITE (KLUN) SELF%IP_A_CURR_U
WRITE (KLUN) SELF%IP_A_CURR_V
WRITE (KLUN) SELF%IP_A_TAUX_OCE
WRITE (KLUN) SELF%IP_A_TAUY_OCE
WRITE (KLUN) SELF%IP_A_TAUX_ICE
WRITE (KLUN) SELF%IP_A_TAUY_ICE
WRITE (KLUN) SELF%IP_A_QS_MIX
WRITE (KLUN) SELF%IP_A_QNS_MIX
WRITE (KLUN) SELF%IP_A_QS_OCE
WRITE (KLUN) SELF%IP_A_QNS_OCE
WRITE (KLUN) SELF%IP_A_QS_ICE
WRITE (KLUN) SELF%IP_A_QNS_ICE
WRITE (KLUN) SELF%IP_A_PRECIP_LIQUID
WRITE (KLUN) SELF%IP_A_PRECIP_SOLID
WRITE (KLUN) SELF%IP_A_EVAP_TOTAL
WRITE (KLUN) SELF%IP_A_EVAP_ICE
WRITE (KLUN) SELF%IP_A_DQNS_DT
WRITE (KLUN) SELF%IP_A_RUNOFF
WRITE (KLUN) SELF%IP_A_TOTAL_CC
WRITE (KLUN) SELF%IP_A_LOW_CC
WRITE (KLUN) SELF%IP_A_ICE_TEMP
WRITE (KLUN) SELF%IP_A_ICE_ALBEDO
WRITE (KLUN) SELF%IP_A_ICE_THICKNESS
WRITE (KLUN) SELF%IP_A_SNOW_THICKNESS
WRITE (KLUN) SELF%IP_A_ICE_TEMP_LVLS
WRITE (KLUN) SELF%IP_A_TAUX
WRITE (KLUN) SELF%IP_A_TAUY
WRITE (KLUN) SELF%IP_A_QS
WRITE (KLUN) SELF%IP_A_QNS
WRITE (KLUN) SELF%IP_A_WATER
WRITE (KLUN) SELF%IP_A_SST_ATM
WRITE (KLUN) SELF%IP_A_TSK_ATM
WRITE (KLUN) SELF%IP_A_IST_ATM
WRITE (KLUN) SELF%IP_A_2DECV_SKT
WRITE (KLUN) SELF%LCOUPSIM
END SUBROUTINE

END SUBMODULE
