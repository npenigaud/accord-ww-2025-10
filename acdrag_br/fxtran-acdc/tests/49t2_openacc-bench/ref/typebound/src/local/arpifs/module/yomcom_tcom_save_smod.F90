SUBMODULE (YOMCOM) YOMCOM_TCOM_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TCOM (SELF, KLUN)

IMPLICIT NONE
CLASS (TCOM), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LGTTLIN, LOMLDTH, LSSTMSK, LSSTPRE, LTRAFLX
WRITE (KLUN) SELF%NVCOM
LOMLDTH = ALLOCATED (SELF%OMLDTH)
WRITE (KLUN) LOMLDTH
IF (LOMLDTH) THEN
  WRITE (KLUN) LBOUND (SELF%OMLDTH)
  WRITE (KLUN) UBOUND (SELF%OMLDTH)
  WRITE (KLUN) SELF%OMLDTH
ENDIF
LGTTLIN = ALLOCATED (SELF%GTTLIN)
WRITE (KLUN) LGTTLIN
IF (LGTTLIN) THEN
  WRITE (KLUN) LBOUND (SELF%GTTLIN)
  WRITE (KLUN) UBOUND (SELF%GTTLIN)
  WRITE (KLUN) SELF%GTTLIN
ENDIF
LSSTPRE = ALLOCATED (SELF%SSTPRE)
WRITE (KLUN) LSSTPRE
IF (LSSTPRE) THEN
  WRITE (KLUN) LBOUND (SELF%SSTPRE)
  WRITE (KLUN) UBOUND (SELF%SSTPRE)
  WRITE (KLUN) SELF%SSTPRE
ENDIF
LSSTMSK = ALLOCATED (SELF%SSTMSK)
WRITE (KLUN) LSSTMSK
IF (LSSTMSK) THEN
  WRITE (KLUN) LBOUND (SELF%SSTMSK)
  WRITE (KLUN) UBOUND (SELF%SSTMSK)
  WRITE (KLUN) SELF%SSTMSK
ENDIF
WRITE (KLUN) SELF%LOMLDTH
LTRAFLX = ALLOCATED (SELF%TRAFLX)
WRITE (KLUN) LTRAFLX
IF (LTRAFLX) THEN
  WRITE (KLUN) LBOUND (SELF%TRAFLX)
  WRITE (KLUN) UBOUND (SELF%TRAFLX)
  WRITE (KLUN) SELF%TRAFLX
ENDIF
END SUBROUTINE

END SUBMODULE
