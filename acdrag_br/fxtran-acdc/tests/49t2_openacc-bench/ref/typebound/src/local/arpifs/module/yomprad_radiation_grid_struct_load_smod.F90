SUBMODULE (YOMPRAD) YOMPRAD_RADIATION_GRID_STRUCT_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_RADIATION_GRID_STRUCT (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (RADIATION_GRID_STRUCT), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LGECLO, LGELAM, LGELAT, LGEMU, LGESLO, LMYMS, LNASM0, LNFRSTLAT, LNLOENG, LNLSTLAT
LOGICAL :: LNONL, LNPTRFRSTLAT, LNRGRI, LNSTA, LRIPI, LRLATI, LRLATIG, LRMU, LRSQM2
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) SELF%NRESOL_ID
READ (KLUN) SELF%NGPTOT
READ (KLUN) SELF%NGPTOTG
READ (KLUN) SELF%NGPTOTMX
READ (KLUN) SELF%NSPEC2
READ (KLUN) SELF%NSMAX
READ (KLUN) SELF%NPTRFLOFF
READ (KLUN) SELF%NUMP
READ (KLUN) SELF%NDLON
READ (KLUN) SELF%NDGSAL
READ (KLUN) SELF%NDGENL
READ (KLUN) SELF%NDGSAH
READ (KLUN) SELF%NDGENH
READ (KLUN) SELF%NDGLG
READ (KLUN) SELF%NDGSAG
READ (KLUN) SELF%NDGENG
READ (KLUN) SELF%NDLSUR
READ (KLUN) SELF%NFRSTLOFF
READ (KLUN) SELF%NDSUR1
READ (KLUN) SELF%NDGSUR
READ (KLUN) SELF%MYFRSTACTLAT
READ (KLUN) SELF%MYLSTACTLAT
READ (KLUN) LNRGRI
IF (LNRGRI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NRGRI (IL1(1):IU1(1)))
  READ (KLUN) SELF%NRGRI
ENDIF
READ (KLUN) LNLOENG
IF (LNLOENG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NLOENG (IL1(1):IU1(1)))
  READ (KLUN) SELF%NLOENG
ENDIF
READ (KLUN) LNPTRFRSTLAT
IF (LNPTRFRSTLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NPTRFRSTLAT (IL1(1):IU1(1)))
  READ (KLUN) SELF%NPTRFRSTLAT
ENDIF
READ (KLUN) LNFRSTLAT
IF (LNFRSTLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NFRSTLAT (IL1(1):IU1(1)))
  READ (KLUN) SELF%NFRSTLAT
ENDIF
READ (KLUN) LNLSTLAT
IF (LNLSTLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NLSTLAT (IL1(1):IU1(1)))
  READ (KLUN) SELF%NLSTLAT
ENDIF
READ (KLUN) LMYMS
IF (LMYMS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MYMS (IL1(1):IU1(1)))
  READ (KLUN) SELF%MYMS
ENDIF
READ (KLUN) LNASM0
IF (LNASM0) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NASM0 (IL1(1):IU1(1)))
  READ (KLUN) SELF%NASM0
ENDIF
READ (KLUN) LNSTA
IF (LNSTA) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NSTA (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NSTA
ENDIF
READ (KLUN) LNONL
IF (LNONL) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NONL (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NONL
ENDIF
READ (KLUN) LGELAM
IF (LGELAM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%GELAM (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%GELAM,1):UBOUND(SELF%GELAM,1)))
  READ (KLUN) ZTMP1
  SELF%GELAM = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGELAT
IF (LGELAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%GELAT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%GELAT,1):UBOUND(SELF%GELAT,1)))
  READ (KLUN) ZTMP1
  SELF%GELAT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGECLO
IF (LGECLO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%GECLO (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%GECLO,1):UBOUND(SELF%GECLO,1)))
  READ (KLUN) ZTMP1
  SELF%GECLO = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGESLO
IF (LGESLO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%GESLO (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%GESLO,1):UBOUND(SELF%GESLO,1)))
  READ (KLUN) ZTMP1
  SELF%GESLO = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRMU
IF (LRMU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RMU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RMU,1):UBOUND(SELF%RMU,1)))
  READ (KLUN) ZTMP1
  SELF%RMU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRSQM2
IF (LRSQM2) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RSQM2 (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RSQM2,1):UBOUND(SELF%RSQM2,1)))
  READ (KLUN) ZTMP1
  SELF%RSQM2 = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRLATIG
IF (LRLATIG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RLATIG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RLATIG,1):UBOUND(SELF%RLATIG,1)))
  READ (KLUN) ZTMP1
  SELF%RLATIG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRLATI
IF (LRLATI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RLATI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RLATI,1):UBOUND(SELF%RLATI,1)))
  READ (KLUN) ZTMP1
  SELF%RLATI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGEMU
IF (LGEMU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%GEMU (IL1(1):IU1(1)))
  READ (KLUN) SELF%GEMU
ENDIF
READ (KLUN) LRIPI
IF (LRIPI) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RIPI (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RIPI
ENDIF
END SUBROUTINE

END SUBMODULE
