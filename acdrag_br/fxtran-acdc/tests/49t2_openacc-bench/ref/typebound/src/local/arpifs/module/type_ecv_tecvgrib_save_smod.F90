SUBMODULE (TYPE_ECV) TYPE_ECV_TECVGRIB_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_SAVE_TECVGRIB (SELF, KLUN)

IMPLICIT NONE
CLASS (TECVGRIB), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LMECVGRB_1D, LMECVGRB_2D, LMECVGRB_3D, LMECVGRB_ALL
LMECVGRB_1D = ALLOCATED (SELF%MECVGRB_1D)
WRITE (KLUN) LMECVGRB_1D
IF (LMECVGRB_1D) THEN
  WRITE (KLUN) LBOUND (SELF%MECVGRB_1D)
  WRITE (KLUN) UBOUND (SELF%MECVGRB_1D)
  WRITE (KLUN) SELF%MECVGRB_1D
ENDIF
LMECVGRB_2D = ALLOCATED (SELF%MECVGRB_2D)
WRITE (KLUN) LMECVGRB_2D
IF (LMECVGRB_2D) THEN
  WRITE (KLUN) LBOUND (SELF%MECVGRB_2D)
  WRITE (KLUN) UBOUND (SELF%MECVGRB_2D)
  WRITE (KLUN) SELF%MECVGRB_2D
ENDIF
LMECVGRB_3D = ALLOCATED (SELF%MECVGRB_3D)
WRITE (KLUN) LMECVGRB_3D
IF (LMECVGRB_3D) THEN
  WRITE (KLUN) LBOUND (SELF%MECVGRB_3D)
  WRITE (KLUN) UBOUND (SELF%MECVGRB_3D)
  WRITE (KLUN) SELF%MECVGRB_3D
ENDIF
LMECVGRB_ALL = ALLOCATED (SELF%MECVGRB_ALL)
WRITE (KLUN) LMECVGRB_ALL
IF (LMECVGRB_ALL) THEN
  WRITE (KLUN) LBOUND (SELF%MECVGRB_ALL)
  WRITE (KLUN) UBOUND (SELF%MECVGRB_ALL)
  WRITE (KLUN) SELF%MECVGRB_ALL
ENDIF
END SUBROUTINE

END SUBMODULE
