SUBMODULE (YOMVERT) YOMVERT_TVAB_SIZE_SMOD

IMPLICIT NONE

CONTAINS

MODULE FUNCTION ACDC_SIZE_TVAB (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TVAB),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LVAF, LVAH, LVALH, LVBF, LVBH, LVC, LVDELA, LVDELB
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LVALH = ALLOCATED (SELF%VALH)
IF (LVALH) THEN
  ISIZE = KIND (SELF%VALH) * SIZE (SELF%VALH)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VALH'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVBH = ALLOCATED (SELF%VBH)
IF (LVBH) THEN
  ISIZE = KIND (SELF%VBH) * SIZE (SELF%VBH)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VBH'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVAH = ALLOCATED (SELF%VAH)
IF (LVAH) THEN
  ISIZE = KIND (SELF%VAH) * SIZE (SELF%VAH)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VAH'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVC = ALLOCATED (SELF%VC)
IF (LVC) THEN
  ISIZE = KIND (SELF%VC) * SIZE (SELF%VC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVAF = ALLOCATED (SELF%VAF)
IF (LVAF) THEN
  ISIZE = KIND (SELF%VAF) * SIZE (SELF%VAF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VAF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVBF = ALLOCATED (SELF%VBF)
IF (LVBF) THEN
  ISIZE = KIND (SELF%VBF) * SIZE (SELF%VBF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VBF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVDELA = ALLOCATED (SELF%VDELA)
IF (LVDELA) THEN
  ISIZE = KIND (SELF%VDELA) * SIZE (SELF%VDELA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VDELA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LVDELB = ALLOCATED (SELF%VDELB)
IF (LVDELB) THEN
  ISIZE = KIND (SELF%VDELB) * SIZE (SELF%VDELB)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VDELB'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END SUBMODULE
