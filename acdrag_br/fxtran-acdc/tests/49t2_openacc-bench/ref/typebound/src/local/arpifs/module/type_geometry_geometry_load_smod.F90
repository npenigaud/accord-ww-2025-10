SUBMODULE (TYPE_GEOMETRY) TYPE_GEOMETRY_GEOMETRY_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_LOAD_GEOMETRY (SELF, KLUN)

IMPLICIT NONE
CLASS (GEOMETRY), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
READ (KLUN) SELF%LNHX_GEOM
CALL SELF%YRVERT_GEOM%ACDC_LOAD (KLUN)
CALL SELF%YRSTA%ACDC_LOAD (KLUN)
CALL SELF%YRLAP%ACDC_LOAD (KLUN)
CALL SELF%YRCSGLEG%ACDC_LOAD (KLUN)
CALL SELF%YRDIM%ACDC_LOAD (KLUN)
CALL SELF%YRDIMV%ACDC_LOAD (KLUN)
CALL SELF%YRMP%ACDC_LOAD (KLUN)
CALL SELF%YRGEM%ACDC_LOAD (KLUN)
NULLIFY (SELF%YRCSGEOM)
NULLIFY (SELF%YRGSGEOM)
READ (KLUN) SELF%AD_GEOM
NULLIFY (SELF%YRCSGEOMAD)
NULLIFY (SELF%YRGSGEOMAD)
CALL SELF%YROROG_B%ACDC_LOAD (KLUN)
CALL SELF%YSPGEOM%ACDC_LOAD (KLUN)
CALL SELF%YVABIO%ACDC_LOAD (KLUN)
CALL SELF%YREDIM%ACDC_LOAD (KLUN)
CALL SELF%YREGEO%ACDC_LOAD (KLUN)
CALL SELF%YREMP%ACDC_LOAD (KLUN)
CALL SELF%YRELAP%ACDC_LOAD (KLUN)
CALL SELF%YREGSL%ACDC_LOAD (KLUN)
READ (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  ALLOCATE (SELF%YRELBC_GEO)
  CALL SELF%YRELBC_GEO%ACDC_LOAD (KLUN)
ELSE
  NULLIFY (SELF%YRELBC_GEO)
ENDIF
END SUBROUTINE

END SUBMODULE
