SUBMODULE (YOMPRAD) YOMPRAD_RADIATION_GRID_STRUCT_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_COPY_RADIATION_GRID_STRUCT (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (RADIATION_GRID_STRUCT), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LGECLO, LGELAM, LGELAT, LGEMU, LGESLO, LMYMS, LNASM0, LNFRSTLAT, LNLOENG, LNLSTLAT
LOGICAL :: LNONL, LNPTRFRSTLAT, LNRGRI, LNSTA, LRIPI, LRLATI, LRLATIG, LRMU, LRSQM2
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LNRGRI = ALLOCATED (SELF%NRGRI)
IF (LNRGRI) THEN
  !$ACC ENTER DATA CREATE (SELF%NRGRI)
  !$ACC UPDATE DEVICE (SELF%NRGRI)
  !$ACC ENTER DATA ATTACH (SELF%NRGRI)
ENDIF

LNLOENG = ALLOCATED (SELF%NLOENG)
IF (LNLOENG) THEN
  !$ACC ENTER DATA CREATE (SELF%NLOENG)
  !$ACC UPDATE DEVICE (SELF%NLOENG)
  !$ACC ENTER DATA ATTACH (SELF%NLOENG)
ENDIF

LNPTRFRSTLAT = ALLOCATED (SELF%NPTRFRSTLAT)
IF (LNPTRFRSTLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%NPTRFRSTLAT)
  !$ACC UPDATE DEVICE (SELF%NPTRFRSTLAT)
  !$ACC ENTER DATA ATTACH (SELF%NPTRFRSTLAT)
ENDIF

LNFRSTLAT = ALLOCATED (SELF%NFRSTLAT)
IF (LNFRSTLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%NFRSTLAT)
  !$ACC UPDATE DEVICE (SELF%NFRSTLAT)
  !$ACC ENTER DATA ATTACH (SELF%NFRSTLAT)
ENDIF

LNLSTLAT = ALLOCATED (SELF%NLSTLAT)
IF (LNLSTLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%NLSTLAT)
  !$ACC UPDATE DEVICE (SELF%NLSTLAT)
  !$ACC ENTER DATA ATTACH (SELF%NLSTLAT)
ENDIF

LMYMS = ALLOCATED (SELF%MYMS)
IF (LMYMS) THEN
  !$ACC ENTER DATA CREATE (SELF%MYMS)
  !$ACC UPDATE DEVICE (SELF%MYMS)
  !$ACC ENTER DATA ATTACH (SELF%MYMS)
ENDIF

LNASM0 = ALLOCATED (SELF%NASM0)
IF (LNASM0) THEN
  !$ACC ENTER DATA CREATE (SELF%NASM0)
  !$ACC UPDATE DEVICE (SELF%NASM0)
  !$ACC ENTER DATA ATTACH (SELF%NASM0)
ENDIF

LNSTA = ALLOCATED (SELF%NSTA)
IF (LNSTA) THEN
  !$ACC ENTER DATA CREATE (SELF%NSTA)
  !$ACC UPDATE DEVICE (SELF%NSTA)
  !$ACC ENTER DATA ATTACH (SELF%NSTA)
ENDIF

LNONL = ALLOCATED (SELF%NONL)
IF (LNONL) THEN
  !$ACC ENTER DATA CREATE (SELF%NONL)
  !$ACC UPDATE DEVICE (SELF%NONL)
  !$ACC ENTER DATA ATTACH (SELF%NONL)
ENDIF

LGELAM = ALLOCATED (SELF%GELAM)
IF (LGELAM) THEN
  !$ACC ENTER DATA CREATE (SELF%GELAM)
  !$ACC UPDATE DEVICE (SELF%GELAM)
  !$ACC ENTER DATA ATTACH (SELF%GELAM)
ENDIF

LGELAT = ALLOCATED (SELF%GELAT)
IF (LGELAT) THEN
  !$ACC ENTER DATA CREATE (SELF%GELAT)
  !$ACC UPDATE DEVICE (SELF%GELAT)
  !$ACC ENTER DATA ATTACH (SELF%GELAT)
ENDIF

LGECLO = ALLOCATED (SELF%GECLO)
IF (LGECLO) THEN
  !$ACC ENTER DATA CREATE (SELF%GECLO)
  !$ACC UPDATE DEVICE (SELF%GECLO)
  !$ACC ENTER DATA ATTACH (SELF%GECLO)
ENDIF

LGESLO = ALLOCATED (SELF%GESLO)
IF (LGESLO) THEN
  !$ACC ENTER DATA CREATE (SELF%GESLO)
  !$ACC UPDATE DEVICE (SELF%GESLO)
  !$ACC ENTER DATA ATTACH (SELF%GESLO)
ENDIF

LRMU = ALLOCATED (SELF%RMU)
IF (LRMU) THEN
  !$ACC ENTER DATA CREATE (SELF%RMU)
  !$ACC UPDATE DEVICE (SELF%RMU)
  !$ACC ENTER DATA ATTACH (SELF%RMU)
ENDIF

LRSQM2 = ALLOCATED (SELF%RSQM2)
IF (LRSQM2) THEN
  !$ACC ENTER DATA CREATE (SELF%RSQM2)
  !$ACC UPDATE DEVICE (SELF%RSQM2)
  !$ACC ENTER DATA ATTACH (SELF%RSQM2)
ENDIF

LRLATIG = ALLOCATED (SELF%RLATIG)
IF (LRLATIG) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATIG)
  !$ACC UPDATE DEVICE (SELF%RLATIG)
  !$ACC ENTER DATA ATTACH (SELF%RLATIG)
ENDIF

LRLATI = ALLOCATED (SELF%RLATI)
IF (LRLATI) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATI)
  !$ACC UPDATE DEVICE (SELF%RLATI)
  !$ACC ENTER DATA ATTACH (SELF%RLATI)
ENDIF

LGEMU = ALLOCATED (SELF%GEMU)
IF (LGEMU) THEN
  !$ACC ENTER DATA CREATE (SELF%GEMU)
  !$ACC UPDATE DEVICE (SELF%GEMU)
  !$ACC ENTER DATA ATTACH (SELF%GEMU)
ENDIF

LRIPI = ALLOCATED (SELF%RIPI)
IF (LRIPI) THEN
  !$ACC ENTER DATA CREATE (SELF%RIPI)
  !$ACC UPDATE DEVICE (SELF%RIPI)
  !$ACC ENTER DATA ATTACH (SELF%RIPI)
ENDIF

END SUBROUTINE

END SUBMODULE
