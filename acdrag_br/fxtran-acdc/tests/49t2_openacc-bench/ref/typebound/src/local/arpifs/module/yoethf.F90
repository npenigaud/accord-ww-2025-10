! (C) Copyright 1988- ECMWF.
!
! This software is licensed under the terms of the Apache Licence Version 2.0
! which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
!
! In applying this licence, ECMWF does not waive the privileges and immunities
! granted to it by virtue of its status as an intergovernmental organisation
! nor does it submit to any jurisdiction.

MODULE YOETHF

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*     *YOETHF* DERIVED CONSTANTS SPECIFIC TO ECMWF THERMODYNAMICS
!     ------------------------------------------------------------------

REAL(KIND=JPRB) :: R2ES
REAL(KIND=JPRB) :: R3LES
REAL(KIND=JPRB) :: R3IES
REAL(KIND=JPRB) :: R4LES
REAL(KIND=JPRB) :: R4IES
REAL(KIND=JPRB) :: R5LES
REAL(KIND=JPRB) :: R5IES
REAL(KIND=JPRB) :: RVTMP2
REAL(KIND=JPRB) :: RHOH2O
REAL(KIND=JPRB) :: R5ALVCP
REAL(KIND=JPRB) :: R5ALSCP
REAL(KIND=JPRB) :: RALVDCP
REAL(KIND=JPRB) :: RALSDCP
REAL(KIND=JPRB) :: RALFDCP
REAL(KIND=JPRB) :: RTWAT
REAL(KIND=JPRB) :: RTBER
REAL(KIND=JPRB) :: RTBERCU
REAL(KIND=JPRB) :: RTICE
REAL(KIND=JPRB) :: RTICECU
REAL(KIND=JPRB) :: RTWAT_RTICE_R
REAL(KIND=JPRB) :: RTWAT_RTICECU_R
REAL(KIND=JPRB) :: RKOOP1
REAL(KIND=JPRB) :: RKOOP2

TYPE TTHF
  REAL(KIND=JPRB) :: R2ES
  REAL(KIND=JPRB) :: R3LES
  REAL(KIND=JPRB) :: R3IES
  REAL(KIND=JPRB) :: R4LES
  REAL(KIND=JPRB) :: R4IES
  REAL(KIND=JPRB) :: R5LES
  REAL(KIND=JPRB) :: R5IES
  REAL(KIND=JPRB) :: RVTMP2
  REAL(KIND=JPRB) :: RHOH2O
  REAL(KIND=JPRB) :: R5ALVCP
  REAL(KIND=JPRB) :: R5ALSCP
  REAL(KIND=JPRB) :: RALVDCP
  REAL(KIND=JPRB) :: RALSDCP
  REAL(KIND=JPRB) :: RALFDCP
  REAL(KIND=JPRB) :: RTWAT
  REAL(KIND=JPRB) :: RTBER
  REAL(KIND=JPRB) :: RTBERCU
  REAL(KIND=JPRB) :: RTICE
  REAL(KIND=JPRB) :: RTICECU
  REAL(KIND=JPRB) :: RTWAT_RTICE_R
  REAL(KIND=JPRB) :: RTWAT_RTICECU_R
  REAL(KIND=JPRB) :: RKOOP1
  REAL(KIND=JPRB) :: RKOOP2
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_TTHF
PROCEDURE :: ACDC_CRC64 => ACDC_CRC64_TTHF
PROCEDURE :: ACDC_HOST => ACDC_HOST_TTHF
PROCEDURE :: ACDC_LOAD => ACDC_LOAD_TTHF
PROCEDURE :: ACDC_SAVE => ACDC_SAVE_TTHF
PROCEDURE :: ACDC_SIZE => ACDC_SIZE_TTHF
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_TTHF
END TYPE TTHF

!     J.-J. MORCRETTE                   91/07/14  ADAPTED TO I.F.S.

!      NAME     TYPE      PURPOSE
!      ----     ----      -------

!     *R__ES*   REAL      *CONSTANTS USED FOR COMPUTATION OF SATURATION
!                         MIXING RATIO OVER LIQUID WATER(*R_LES*) OR
!                         ICE(*R_IES*).
!     *RVTMP2*  REAL      *RVTMP2=RCPV/RCPD-1.
!     *RHOH2O*  REAL      *DENSITY OF LIQUID WATER.   (RATM/100.)
!     *R5ALVCP* REAL      *R5LES*RLVTT/RCPD
!     *R5ALSCP* REAL      *R5IES*RLSTT/RCPD
!     *RALVDCP* REAL      *RLVTT/RCPD
!     *RALSDCP* REAL      *RLSTT/RCPD
!     *RALFDCP* REAL      *RLMLT/RCPD
!     *RTWAT*   REAL      *RTWAT=RTT
!     *RTBER*   REAL      *RTBER=RTT-0.05
!     *RTBERCU  REAL      *RTBERCU=RTT-5.0
!     *RTICE*   REAL      *RTICE=RTT-0.1
!     *RTICECU* REAL      *RTICECU=RTT-23.0
!     *RKOOP?   REAL      *CONSTANTS TO DESCRIBE KOOP FORM FOR NUCLEATION
!     *RTWAT_RTICE_R*   REAL      *RTWAT_RTICE_R=1./(RTWAT-RTICE)
!     *RTWAT_RTICECU_R* REAL      *RTWAT_RTICECU_R=1./(RTWAT-RTICECU)

!       ----------------------------------------------------------------

TYPE(TTHF), POINTER :: YRTHF => NULL ()

INTERFACE

MODULE SUBROUTINE ACDC_COPY_TTHF (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTHF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_CRC64_TTHF (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
CLASS (TTHF), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_TTHF (SELF)

IMPLICIT NONE
CLASS (TTHF), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_LOAD_TTHF (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
CLASS (TTHF), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE ACDC_SAVE_TTHF (SELF, KLUN)

IMPLICIT NONE
CLASS (TTHF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION ACDC_SIZE_TTHF (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TTHF),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE ACDC_WIPE_TTHF (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTHF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

TYPE (TTHF) FUNCTION TTHF_INIT () RESULT (YDTHF)

YDTHF%R2ES            = R2ES
YDTHF%R3LES           = R3LES
YDTHF%R3IES           = R3IES
YDTHF%R4LES           = R4LES
YDTHF%R4IES           = R4IES
YDTHF%R5LES           = R5LES
YDTHF%R5IES           = R5IES
YDTHF%RVTMP2          = RVTMP2
YDTHF%RHOH2O          = RHOH2O
YDTHF%R5ALVCP         = R5ALVCP
YDTHF%R5ALSCP         = R5ALSCP
YDTHF%RALVDCP         = RALVDCP
YDTHF%RALSDCP         = RALSDCP
YDTHF%RALFDCP         = RALFDCP
YDTHF%RTWAT           = RTWAT
YDTHF%RTBER           = RTBER
YDTHF%RTBERCU         = RTBERCU
YDTHF%RTICE           = RTICE
YDTHF%RTICECU         = RTICECU
YDTHF%RTWAT_RTICE_R   = RTWAT_RTICE_R
YDTHF%RTWAT_RTICECU_R = RTWAT_RTICECU_R
YDTHF%RKOOP1          = RKOOP1
YDTHF%RKOOP2          = RKOOP2

END FUNCTION TTHF_INIT


END MODULE YOETHF
