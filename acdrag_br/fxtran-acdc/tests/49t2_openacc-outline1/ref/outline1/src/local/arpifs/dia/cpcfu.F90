SUBROUTINE CPCFU (YDCST, YDCFU, YDRIP, YDCPG_OPTS, YDCPG_BNDS, YDMF_PHYS_OUT, YDCPG_MISC&
&, YDCPG_DYN0, YDVARS, YDMF_PHYS_SURF, PSTRCU, PSTRCV, PSTRDU, PSTRDV, PSTRTU, PSTRTV)
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMRIP,ONLY:TRIP
USE YOMCFU,ONLY:TCFU
USE YOMCST,ONLY:TCST
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_MISC_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE TYPE_FLUXES,ONLY:FLUXES_DESCRIPTOR

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (TCFU), INTENT (INOUT)::YDCFU
TYPE (TRIP), INTENT (IN)::YDRIP
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (CPG_MISC_TYPE), INTENT (IN)::YDCPG_MISC
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (FIELD_VARIABLES), INTENT (IN)::YDVARS
TYPE (MF_PHYS_SURF_TYPE), INTENT (IN)::YDMF_PHYS_SURF
REAL (KIND=JPRB), INTENT (IN)::PSTRCU (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTRCV (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTRDU (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTRDV (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTRTU (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTRTV (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)





INTEGER (KIND=JPIM)::JLEV

INTEGER (KIND=JPIM)::ITIME
LOGICAL::LLNORESET
LOGICAL::LLRESET
LOGICAL::LLFRRC
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "cpcfu_outline_000.intfb.h"
#include "cpcfu_outline_005.intfb.h"
#include "cpcfu_outline_004.intfb.h"
#include "cpcfu_outline_003.intfb.h"
#include "cpcfu_outline_002.intfb.h"
#include "cpcfu_outline_001.intfb.h"
IF (LHOOK) CALL DR_HOOK ('CPCFU', 0, ZHOOK_HANDLE)



IF (.NOT.YDCPG_OPTS%LFSTEP.OR.YDCFU%LREACFU) THEN
  LLRESET=.FALSE.
ELSE
  LLRESET=.TRUE.
ENDIF


IF (YDCFU%YFDUTP%LACTIVE) THEN
  CALL CPCFU_OUTLINE_000 (LLRESET, JLEV, YDCFU, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS_OUT, YDRIP)
ENDIF

CALL CPCFU_OUTLINE_001 (LLRESET, YDCFU, YDCPG_BNDS, YDCPG_MISC, YDCPG_OPTS&
&, YDMF_PHYS_OUT, YDRIP, PSTRCU, PSTRCV, PSTRDU, PSTRDV, PSTRTU, PSTRTV)
CALL CPCFU_OUTLINE_002 (LLNORESET, LLRESET, ITIME, YDCFU, YDCPG_BNDS, YDCPG_DYN0&
&, YDCPG_MISC, YDCPG_OPTS, YDMF_PHYS_OUT, YDMF_PHYS_SURF, YDRIP)

IF (YDCFU%NFRRC/=0) THEN
  LLFRRC=MOD (YDCPG_OPTS%NSTEP, YDCFU%NFRRC)==0
ELSE
  LLFRRC=.FALSE.
ENDIF

CALL CPCFU_OUTLINE_003 (LLFRRC, LLNORESET, LLRESET, ITIME, YDCFU, YDCPG_BNDS, YDMF_PHYS_OUT, YDRIP)

IF (YDCFU%YFCL%LACTIVE) THEN
  CALL CPCFU_OUTLINE_004 (LLNORESET, LLRESET, ITIME, YDCFU, YDCPG_BNDS, YDMF_PHYS_OUT, YDRIP)
ENDIF

CALL CPCFU_OUTLINE_005 (LLRESET, YDCFU, YDCPG_BNDS, YDCPG_DYN0&
&, YDCPG_MISC, YDCPG_OPTS, YDCST, YDRIP, YDVARS)

IF (LHOOK) CALL DR_HOOK ('CPCFU', 1, ZHOOK_HANDLE)





ENDSUBROUTINE CPCFU
