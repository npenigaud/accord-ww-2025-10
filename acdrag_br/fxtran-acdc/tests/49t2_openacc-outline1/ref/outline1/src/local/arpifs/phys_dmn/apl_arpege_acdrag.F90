SUBROUTINE APL_ARPEGE_ACDRAG (YDCPG_BNDS, YDCPG_MISC, YDCPG_OPTS, YDMF_PHYS&
&, YDMF_PHYS_BASE_STATE, YDMF_PHYS_SURF, YDMODEL, YDVARS, PCHROV, PDQSTS,&
& PFLU_EMIS, PFLU_NEIJ, PGWDCS, PMSC_QW, PNBVNO, PNEBS, PQLIS, PQV)
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_DYN_TYPE, CPG_GPAR_TYPE, CPG_PHY_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
REAL (KIND=JPRB), INTENT (INOUT)::PCHROV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PDQSTS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFLU_EMIS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PFLU_NEIJ (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PGWDCS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PMSC_QW (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PNBVNO (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PNEBS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PQLIS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PQV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
#include "acdnshf.intfb.h"
#include "acdrag.intfb.h"
#include "acpluis.intfb.h"
REAL (KIND=JPRB)::ZTRAJGWD (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ACDRAG', 0, ZHOOK_HANDLE)

IF (YDMODEL%YRML_AOC%YRMCC%LMCC03) THEN
  CALL ACDNSHF (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1&
  &, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS&
  &%KFLEVG, PFLU_EMIS, YDMF_PHYS_SURF%GSD_VF%PLSM, PFLU_NEIJ, PQV, YDCPG_MISC%QS, YDMF_PHYS_BASE_STATE&
  &%YGSP_RR%T, PCHROV, PDQSTS, YDMF_PHYS%OUT%DRNSHF)
ENDIF

CALL ACDRAG (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS&
&%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD&
&, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF, YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%DELP, PNBVNO, YDMF_PHYS_BASE_STATE&
&%YCPG_PHY%XYB%RDELP, YDMF_PHYS_BASE_STATE%U, YDMF_PHYS_BASE_STATE%V, YDVARS%GEOMETRY%RCORI%T0&
&, YDMF_PHYS_SURF%GSD_VF%PGETRL, PGWDCS, YDMF_PHYS_SURF%GSD_VF%PVRLAN, YDMF_PHYS_SURF%GSD_VF&
&%PVRLDI, YDMF_PHYS%OUT%STRDU, YDMF_PHYS%OUT%STRDV, ZTRAJGWD)

IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRAS) THEN
  CALL ACPLUIS (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
  &, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF, YDMF_PHYS_BASE_STATE&
  &%YCPG_PHY%XYB%DELP, PNEBS, PQV, PQLIS, PMSC_QW, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%R, YDMF_PHYS_BASE_STATE&
  &%T, YDMF_PHYS%OUT%FCSQL, YDMF_PHYS%OUT%FCSQN, YDMF_PHYS%OUT%FPLSL, YDMF_PHYS%OUT%FPLSN, YDMF_PHYS%OUT&
  &%FPEVPSL, YDMF_PHYS%OUT%FPEVPSN, YDMF_PHYS%OUT%FPFPSL, YDMF_PHYS%OUT%FPFPSN)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ACDRAG', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
