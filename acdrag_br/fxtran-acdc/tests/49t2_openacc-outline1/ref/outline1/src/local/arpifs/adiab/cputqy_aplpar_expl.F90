SUBROUTINE CPUTQY_APLPAR_EXPL (YDCST, YDCPG_BNDS, YDCPG_OPTS, YDDYNA, YDMF_PHYS_NEXT_STATE&
&, YDMF_PHYS_BASE_STATE, YDVARS, YDPHY, PDT, PTENDH, PTENDU, PTENDV, PTENDU_ZDEC, PTENDV_ZDEC&
&, PTENDD, PTENDEFB1, PTENDEFB2, PTENDEFB3, PTENDG, PTENDICONV, PTENDI, PTENDLCONV, PTENDL&
&, PTENDQ, PTENDRCONV, PTENDR, PTENDSCONV, PTENDS, PTENDTKE, PFDIS)
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMCST,ONLY:TCST
USE YOMPHY,ONLY:TPHY
USE YOMDYNA,ONLY:TDYNA
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_NEXT_STATE_TYPE_MOD,ONLY:MF_PHYS_NEXT_STATE_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (MF_PHYS_NEXT_STATE_TYPE), INTENT (INOUT)::YDMF_PHYS_NEXT_STATE
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (TPHY), INTENT (IN)::YDPHY
REAL (KIND=JPRB), INTENT (IN)::PDT
REAL (KIND=JPRB), INTENT (IN)::PTENDH (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDU (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDU_ZDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDV_ZDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDD (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDEFB1 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDEFB2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDEFB3 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDG (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDICONV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDI (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDLCONV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDL (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDRCONV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDR (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDSCONV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDTKE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PFDIS (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
#include "cputqy0.intfb.h"
#include "cputqy_aplpar_expl_pfdis.intfb.h"
#include "cputqy_aplpar_expl_zdec.intfb.h"
#include "cputqy_aplpar_expl_ztdcp.intfb.h"
#include "acctnd0.intfb.h"
INTEGER (KIND=JPIM)::JGFL
INTEGER (KIND=JPIM)::IPGFL



REAL (KIND=JPRB)::ZRRG
REAL (KIND=JPRB)::ZRDT
REAL (KIND=JPRB)::ZFLAG

REAL (KIND=JPRB)::ZDTT1 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZTDCP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRRGDELP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
LOGICAL::LLTKE
LOGICAL::LLPREC
IF (LHOOK) CALL DR_HOOK ('CPUTQY_APLPAR_EXPL', 0, ZHOOK_HANDLE)

LLPREC=YDPHY%LPROCLD.OR.YDPHY%L3MT.OR.YDPHY%LSTRAPRO
LLTKE=YDPHY%LECT

IF (PDT<=0.0_JPRB) THEN
  ZFLAG=0.0_JPRB
  ZRDT=0.0_JPRB
ELSE
  ZFLAG=1.0_JPRB
  ZRDT=1.0_JPRB/PDT
ENDIF

ZRRG=1.0_JPRB/YDCST%RG
CALL CPUTQY_APLPAR_EXPL_ZTDCP (YDCPG_OPTS, ZTDCP)
CALL ACCTND0 (YDCST, YDVARS%L%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%L%RCP, ZTDCP, PTENDL)
CALL ACCTND0 (YDCST, YDVARS%I%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%I%RCP, ZTDCP, PTENDI)
CALL ACCTND0 (YDCST, YDVARS%S%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%S%RCP, ZTDCP, PTENDS)
CALL ACCTND0 (YDCST, YDVARS%R%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%R%RCP, ZTDCP, PTENDR)
CALL ACCTND0 (YDCST, YDVARS%LCONV%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%LCONV%RCP, ZTDCP, PTENDLCONV)
CALL ACCTND0 (YDCST, YDVARS%ICONV%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%ICONV%RCP, ZTDCP, PTENDICONV)
CALL ACCTND0 (YDCST, YDVARS%RCONV%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%RCONV%RCP, ZTDCP, PTENDRCONV)
CALL ACCTND0 (YDCST, YDVARS%SCONV%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%SCONV%RCP, ZTDCP, PTENDSCONV)
CALL ACCTND0 (YDCST, YDVARS%Q%LT1, YDCPG_OPTS, YDCPG_BNDS, YDVARS%Q%RCP, ZTDCP, PTENDQ)
CALL CPUTQY_APLPAR_EXPL_ZDEC (PDT, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS_BASE_STATE, YDPHY, ZFLAG&
&, ZRRG, PTENDH, PTENDTKE, PTENDU_ZDEC, PTENDV_ZDEC, ZDEC, ZDTT1, ZRRGDELP, ZTDCP)
CALL CPUTQY_APLPAR_EXPL_PFDIS (YDCPG_BNDS, YDCPG_OPTS, YDPHY, PFDIS, PTENDTKE, ZDEC, ZRRGDELP)
CALL CPUTQY0 (.TRUE., YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%U, PDT, YDMF_PHYS_NEXT_STATE%U%P, PTENDU)
CALL CPUTQY0 (.TRUE., YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%V, PDT, YDMF_PHYS_NEXT_STATE%V%P, PTENDV)
CALL CPUTQY0 (.TRUE., YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%T, 1._JPRB, YDMF_PHYS_NEXT_STATE%T%P, ZDTT1)
CALL CPUTQY0 (YDDYNA%LNHDYN, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%SVD, PDT, YDMF_PHYS_NEXT_STATE%SVD%P, PTENDD)
CALL CPUTQY0 (YDVARS%L%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%L, PDT, YDMF_PHYS_NEXT_STATE%L%P, PTENDL)
CALL CPUTQY0 (YDVARS%I%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%I, PDT, YDMF_PHYS_NEXT_STATE%I%P, PTENDI)
CALL CPUTQY0 (YDVARS%S%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%S, PDT, YDMF_PHYS_NEXT_STATE%S%P, PTENDS)
CALL CPUTQY0 (YDVARS%R%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%R, PDT, YDMF_PHYS_NEXT_STATE%R%P, PTENDR)
CALL CPUTQY0 (YDVARS%G%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%G, PDT, YDMF_PHYS_NEXT_STATE%G%P, PTENDG)
CALL CPUTQY0 (YDVARS%TKE%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%TKE, PDT, YDMF_PHYS_NEXT_STATE%TKE%P, PTENDTKE)
CALL CPUTQY0 (YDVARS%EFB1%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%EFB1, PDT, YDMF_PHYS_NEXT_STATE%EFB1%P, PTENDEFB1)
CALL CPUTQY0 (YDVARS%EFB2%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%EFB2, PDT, YDMF_PHYS_NEXT_STATE%EFB2%P, PTENDEFB2)
CALL CPUTQY0 (YDVARS%EFB3%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%EFB3, PDT, YDMF_PHYS_NEXT_STATE%EFB3%P, PTENDEFB3)
CALL CPUTQY0 (YDVARS%LCONV%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%LCONV, PDT, YDMF_PHYS_NEXT_STATE%LCONV%P, PTENDLCONV)
CALL CPUTQY0 (YDVARS%ICONV%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%ICONV, PDT, YDMF_PHYS_NEXT_STATE%ICONV%P, PTENDICONV)
CALL CPUTQY0 (YDVARS%RCONV%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%RCONV, PDT, YDMF_PHYS_NEXT_STATE%RCONV%P, PTENDRCONV)
CALL CPUTQY0 (YDVARS%SCONV%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS%YRVARS_DIMS&
&%SCONV, PDT, YDMF_PHYS_NEXT_STATE%SCONV%P, PTENDSCONV)
CALL CPUTQY0 (YDVARS%Q%LT1, YDCPG_BNDS, YDCPG_OPTS, YDCPG_OPTS&
&%YRVARS_DIMS%Q, PDT, YDMF_PHYS_NEXT_STATE%Q%P, PTENDQ)

IF (LHOOK) CALL DR_HOOK ('CPUTQY_APLPAR_EXPL', 1, ZHOOK_HANDLE)
ENDSUBROUTINE CPUTQY_APLPAR_EXPL
